import"./styles.js";function Br(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var jt={exports:{}},ui;function ca(){if(ui)return jt.exports;ui=1;var i=typeof Reflect=="object"?Reflect:null,e=i&&typeof i.apply=="function"?i.apply:function(w,b,T){return Function.prototype.apply.call(w,b,T)},t;i&&typeof i.ownKeys=="function"?t=i.ownKeys:Object.getOwnPropertySymbols?t=function(w){return Object.getOwnPropertyNames(w).concat(Object.getOwnPropertySymbols(w))}:t=function(w){return Object.getOwnPropertyNames(w)};function r(c){console&&console.warn&&console.warn(c)}var n=Number.isNaN||function(w){return w!==w};function a(){a.init.call(this)}jt.exports=a,jt.exports.once=C,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var o=10;function s(c){if(typeof c!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof c)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(c){if(typeof c!="number"||c<0||n(c))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+c+".");o=c}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(w){if(typeof w!="number"||w<0||n(w))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+w+".");return this._maxListeners=w,this};function u(c){return c._maxListeners===void 0?a.defaultMaxListeners:c._maxListeners}a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(w){for(var b=[],T=1;T<arguments.length;T++)b.push(arguments[T]);var O=w==="error",L=this._events;if(L!==void 0)O=O&&L.error===void 0;else if(!O)return!1;if(O){var k;if(b.length>0&&(k=b[0]),k instanceof Error)throw k;var B=new Error("Unhandled error."+(k?" ("+k.message+")":""));throw B.context=k,B}var P=L[w];if(P===void 0)return!1;if(typeof P=="function")e(P,this,b);else for(var g=P.length,K=v(P,g),T=0;T<g;++T)e(K[T],this,b);return!0};function d(c,w,b,T){var O,L,k;if(s(b),L=c._events,L===void 0?(L=c._events=Object.create(null),c._eventsCount=0):(L.newListener!==void 0&&(c.emit("newListener",w,b.listener?b.listener:b),L=c._events),k=L[w]),k===void 0)k=L[w]=b,++c._eventsCount;else if(typeof k=="function"?k=L[w]=T?[b,k]:[k,b]:T?k.unshift(b):k.push(b),O=u(c),O>0&&k.length>O&&!k.warned){k.warned=!0;var B=new Error("Possible EventEmitter memory leak detected. "+k.length+" "+String(w)+" listeners added. Use emitter.setMaxListeners() to increase limit");B.name="MaxListenersExceededWarning",B.emitter=c,B.type=w,B.count=k.length,r(B)}return c}a.prototype.addListener=function(w,b){return d(this,w,b,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(w,b){return d(this,w,b,!0)};function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(c,w,b){var T={fired:!1,wrapFn:void 0,target:c,type:w,listener:b},O=h.bind(T);return O.listener=b,T.wrapFn=O,O}a.prototype.once=function(w,b){return s(b),this.on(w,l(this,w,b)),this},a.prototype.prependOnceListener=function(w,b){return s(b),this.prependListener(w,l(this,w,b)),this},a.prototype.removeListener=function(w,b){var T,O,L,k,B;if(s(b),O=this._events,O===void 0)return this;if(T=O[w],T===void 0)return this;if(T===b||T.listener===b)--this._eventsCount===0?this._events=Object.create(null):(delete O[w],O.removeListener&&this.emit("removeListener",w,T.listener||b));else if(typeof T!="function"){for(L=-1,k=T.length-1;k>=0;k--)if(T[k]===b||T[k].listener===b){B=T[k].listener,L=k;break}if(L<0)return this;L===0?T.shift():m(T,L),T.length===1&&(O[w]=T[0]),O.removeListener!==void 0&&this.emit("removeListener",w,B||b)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(w){var b,T,O;if(T=this._events,T===void 0)return this;if(T.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):T[w]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete T[w]),this;if(arguments.length===0){var L=Object.keys(T),k;for(O=0;O<L.length;++O)k=L[O],k!=="removeListener"&&this.removeAllListeners(k);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(b=T[w],typeof b=="function")this.removeListener(w,b);else if(b!==void 0)for(O=b.length-1;O>=0;O--)this.removeListener(w,b[O]);return this};function f(c,w,b){var T=c._events;if(T===void 0)return[];var O=T[w];return O===void 0?[]:typeof O=="function"?b?[O.listener||O]:[O]:b?E(O):v(O,O.length)}a.prototype.listeners=function(w){return f(this,w,!0)},a.prototype.rawListeners=function(w){return f(this,w,!1)},a.listenerCount=function(c,w){return typeof c.listenerCount=="function"?c.listenerCount(w):p.call(c,w)},a.prototype.listenerCount=p;function p(c){var w=this._events;if(w!==void 0){var b=w[c];if(typeof b=="function")return 1;if(b!==void 0)return b.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function v(c,w){for(var b=new Array(w),T=0;T<w;++T)b[T]=c[T];return b}function m(c,w){for(;w+1<c.length;w++)c[w]=c[w+1];c.pop()}function E(c){for(var w=new Array(c.length),b=0;b<w.length;++b)w[b]=c[b].listener||c[b];return w}function C(c,w){return new Promise(function(b,T){function O(k){c.removeListener(w,L),T(k)}function L(){typeof c.removeListener=="function"&&c.removeListener("error",O),b([].slice.call(arguments))}A(c,w,L,{once:!0}),w!=="error"&&_(c,O,{once:!0})})}function _(c,w,b){typeof c.on=="function"&&A(c,"error",w,b)}function A(c,w,b,T){if(typeof c.on=="function")T.once?c.once(w,b):c.on(w,b);else if(typeof c.addEventListener=="function")c.addEventListener(w,function O(L){T.once&&c.removeEventListener(w,O),b(L)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof c)}return jt.exports}var hn=ca();function la(){const i=arguments[0];for(let e=1,t=arguments.length;e<t;e++)if(arguments[e])for(const r in arguments[e])i[r]=arguments[e][r];return i}let se=la;typeof Object.assign=="function"&&(se=Object.assign);function Le(i,e,t,r){const n=i._nodes.get(e);let a=null;return n&&(r==="mixed"?a=n.out&&n.out[t]||n.undirected&&n.undirected[t]:r==="directed"?a=n.out&&n.out[t]:a=n.undirected&&n.undirected[t]),a}function ce(i){return typeof i=="object"&&i!==null}function cn(i){let e;for(e in i)return!1;return!0}function De(i,e,t){Object.defineProperty(i,e,{enumerable:!1,configurable:!1,writable:!0,value:t})}function Pe(i,e,t){const r={enumerable:!0,configurable:!0};typeof t=="function"?r.get=t:(r.value=t,r.writable=!1),Object.defineProperty(i,e,r)}function di(i){return!(!ce(i)||i.attributes&&!Array.isArray(i.attributes))}function fa(){let i=Math.floor(Math.random()*256)&255;return()=>i++}function Xe(){const i=arguments;let e=null,t=-1;return{[Symbol.iterator](){return this},next(){let r=null;do{if(e===null){if(t++,t>=i.length)return{done:!0};e=i[t][Symbol.iterator]()}if(r=e.next(),r.done){e=null;continue}break}while(!0);return r}}}function Et(){return{[Symbol.iterator](){return this},next(){return{done:!0}}}}class Hr extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}class F extends Hr{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,F.prototype.constructor)}}class G extends Hr{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,G.prototype.constructor)}}class H extends Hr{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,H.prototype.constructor)}}function ln(i,e){this.key=i,this.attributes=e,this.clear()}ln.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function fn(i,e){this.key=i,this.attributes=e,this.clear()}fn.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function pn(i,e){this.key=i,this.attributes=e,this.clear()}pn.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function _t(i,e,t,r,n){this.key=e,this.attributes=n,this.undirected=i,this.source=t,this.target=r}_t.prototype.attach=function(){let i="out",e="in";this.undirected&&(i=e="undirected");const t=this.source.key,r=this.target.key;this.source[i][r]=this,!(this.undirected&&t===r)&&(this.target[e][t]=this)};_t.prototype.attachMulti=function(){let i="out",e="in";const t=this.source.key,r=this.target.key;this.undirected&&(i=e="undirected");const n=this.source[i],a=n[r];if(typeof a>"u"){n[r]=this,this.undirected&&t===r||(this.target[e][t]=this);return}a.previous=this,this.next=a,n[r]=this,this.target[e][t]=this};_t.prototype.detach=function(){const i=this.source.key,e=this.target.key;let t="out",r="in";this.undirected&&(t=r="undirected"),delete this.source[t][e],delete this.target[r][i]};_t.prototype.detachMulti=function(){const i=this.source.key,e=this.target.key;let t="out",r="in";this.undirected&&(t=r="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[t][e],delete this.target[r][i]):(this.next.previous=void 0,this.source[t][e]=this.next,this.target[r][i]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const gn=0,vn=1,pa=2,mn=3;function Je(i,e,t,r,n,a,o){let s,u,d,h;if(r=""+r,t===gn){if(s=i._nodes.get(r),!s)throw new G(`Graph.${e}: could not find the "${r}" node in the graph.`);d=n,h=a}else if(t===mn){if(n=""+n,u=i._edges.get(n),!u)throw new G(`Graph.${e}: could not find the "${n}" edge in the graph.`);const l=u.source.key,f=u.target.key;if(r===l)s=u.target;else if(r===f)s=u.source;else throw new G(`Graph.${e}: the "${r}" node is not attached to the "${n}" edge (${l}, ${f}).`);d=a,h=o}else{if(u=i._edges.get(r),!u)throw new G(`Graph.${e}: could not find the "${r}" edge in the graph.`);t===vn?s=u.source:s=u.target,d=n,h=a}return[s,d,h]}function ga(i,e,t){i.prototype[e]=function(r,n,a){const[o,s]=Je(this,e,t,r,n,a);return o.attributes[s]}}function va(i,e,t){i.prototype[e]=function(r,n){const[a]=Je(this,e,t,r,n);return a.attributes}}function ma(i,e,t){i.prototype[e]=function(r,n,a){const[o,s]=Je(this,e,t,r,n,a);return o.attributes.hasOwnProperty(s)}}function ya(i,e,t){i.prototype[e]=function(r,n,a,o){const[s,u,d]=Je(this,e,t,r,n,a,o);return s.attributes[u]=d,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:u}),this}}function ba(i,e,t){i.prototype[e]=function(r,n,a,o){const[s,u,d]=Je(this,e,t,r,n,a,o);if(typeof d!="function")throw new F(`Graph.${e}: updater should be a function.`);const h=s.attributes,l=d(h[u]);return h[u]=l,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:u}),this}}function wa(i,e,t){i.prototype[e]=function(r,n,a){const[o,s]=Je(this,e,t,r,n,a);return delete o.attributes[s],this.emit("nodeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:s}),this}}function Ea(i,e,t){i.prototype[e]=function(r,n,a){const[o,s]=Je(this,e,t,r,n,a);if(!ce(s))throw new F(`Graph.${e}: provided attributes are not a plain object.`);return o.attributes=s,this.emit("nodeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function _a(i,e,t){i.prototype[e]=function(r,n,a){const[o,s]=Je(this,e,t,r,n,a);if(!ce(s))throw new F(`Graph.${e}: provided attributes are not a plain object.`);return se(o.attributes,s),this.emit("nodeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:s}),this}}function Ta(i,e,t){i.prototype[e]=function(r,n,a){const[o,s]=Je(this,e,t,r,n,a);if(typeof s!="function")throw new F(`Graph.${e}: provided updater is not a function.`);return o.attributes=s(o.attributes),this.emit("nodeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const Aa=[{name:i=>`get${i}Attribute`,attacher:ga},{name:i=>`get${i}Attributes`,attacher:va},{name:i=>`has${i}Attribute`,attacher:ma},{name:i=>`set${i}Attribute`,attacher:ya},{name:i=>`update${i}Attribute`,attacher:ba},{name:i=>`remove${i}Attribute`,attacher:wa},{name:i=>`replace${i}Attributes`,attacher:Ea},{name:i=>`merge${i}Attributes`,attacher:_a},{name:i=>`update${i}Attributes`,attacher:Ta}];function Ra(i){Aa.forEach(function({name:e,attacher:t}){t(i,e("Node"),gn),t(i,e("Source"),vn),t(i,e("Target"),pa),t(i,e("Opposite"),mn)})}function Sa(i,e,t){i.prototype[e]=function(r,n){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new H(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new H(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,s=""+n;if(n=arguments[2],a=Le(this,o,s,t),!a)throw new G(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(t!=="mixed")throw new H(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new G(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return a.attributes[n]}}function Ca(i,e,t){i.prototype[e]=function(r){let n;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new H(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new H(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,o=""+arguments[1];if(n=Le(this,a,o,t),!n)throw new G(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(t!=="mixed")throw new H(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,n=this._edges.get(r),!n)throw new G(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return n.attributes}}function xa(i,e,t){i.prototype[e]=function(r,n){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new H(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new H(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,s=""+n;if(n=arguments[2],a=Le(this,o,s,t),!a)throw new G(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(t!=="mixed")throw new H(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new G(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return a.attributes.hasOwnProperty(n)}}function Da(i,e,t){i.prototype[e]=function(r,n,a){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new H(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new H(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,u=""+n;if(n=arguments[2],a=arguments[3],o=Le(this,s,u,t),!o)throw new G(`Graph.${e}: could not find an edge for the given path ("${s}" - "${u}").`)}else{if(t!=="mixed")throw new H(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new G(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return o.attributes[n]=a,this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:n}),this}}function La(i,e,t){i.prototype[e]=function(r,n,a){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new H(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new H(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,u=""+n;if(n=arguments[2],a=arguments[3],o=Le(this,s,u,t),!o)throw new G(`Graph.${e}: could not find an edge for the given path ("${s}" - "${u}").`)}else{if(t!=="mixed")throw new H(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new G(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(typeof a!="function")throw new F(`Graph.${e}: updater should be a function.`);return o.attributes[n]=a(o.attributes[n]),this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:n}),this}}function ka(i,e,t){i.prototype[e]=function(r,n){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new H(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new H(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,s=""+n;if(n=arguments[2],a=Le(this,o,s,t),!a)throw new G(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(t!=="mixed")throw new H(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new G(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return delete a.attributes[n],this.emit("edgeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:n}),this}}function Ga(i,e,t){i.prototype[e]=function(r,n){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new H(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new H(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,s=""+n;if(n=arguments[2],a=Le(this,o,s,t),!a)throw new G(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(t!=="mixed")throw new H(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new G(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(!ce(n))throw new F(`Graph.${e}: provided attributes are not a plain object.`);return a.attributes=n,this.emit("edgeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function Oa(i,e,t){i.prototype[e]=function(r,n){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new H(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new H(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,s=""+n;if(n=arguments[2],a=Le(this,o,s,t),!a)throw new G(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(t!=="mixed")throw new H(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new G(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(!ce(n))throw new F(`Graph.${e}: provided attributes are not a plain object.`);return se(a.attributes,n),this.emit("edgeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:n}),this}}function Pa(i,e,t){i.prototype[e]=function(r,n){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new H(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new H(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,s=""+n;if(n=arguments[2],a=Le(this,o,s,t),!a)throw new G(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(t!=="mixed")throw new H(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new G(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(typeof n!="function")throw new F(`Graph.${e}: provided updater is not a function.`);return a.attributes=n(a.attributes),this.emit("edgeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const Fa=[{name:i=>`get${i}Attribute`,attacher:Sa},{name:i=>`get${i}Attributes`,attacher:Ca},{name:i=>`has${i}Attribute`,attacher:xa},{name:i=>`set${i}Attribute`,attacher:Da},{name:i=>`update${i}Attribute`,attacher:La},{name:i=>`remove${i}Attribute`,attacher:ka},{name:i=>`replace${i}Attributes`,attacher:Ga},{name:i=>`merge${i}Attributes`,attacher:Oa},{name:i=>`update${i}Attributes`,attacher:Pa}];function Na(i){Fa.forEach(function({name:e,attacher:t}){t(i,e("Edge"),"mixed"),t(i,e("DirectedEdge"),"directed"),t(i,e("UndirectedEdge"),"undirected")})}const Ia=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function $a(i,e,t,r){let n=!1;for(const a in e){if(a===r)continue;const o=e[a];if(n=t(o.key,o.attributes,o.source.key,o.target.key,o.source.attributes,o.target.attributes,o.undirected),i&&n)return o.key}}function za(i,e,t,r){let n,a,o,s=!1;for(const u in e)if(u!==r){n=e[u];do{if(a=n.source,o=n.target,s=t(n.key,n.attributes,a.key,o.key,a.attributes,o.attributes,n.undirected),i&&s)return n.key;n=n.next}while(n!==void 0)}}function lr(i,e){const t=Object.keys(i),r=t.length;let n,a=0;return{[Symbol.iterator](){return this},next(){do if(n)n=n.next;else{if(a>=r)return{done:!0};const o=t[a++];if(o===e){n=void 0;continue}n=i[o]}while(!n);return{done:!1,value:{edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected}}}}}function Ua(i,e,t,r){const n=e[t];if(!n)return;const a=n.source,o=n.target;if(r(n.key,n.attributes,a.key,o.key,a.attributes,o.attributes,n.undirected)&&i)return n.key}function Ma(i,e,t,r){let n=e[t];if(!n)return;let a=!1;do{if(a=r(n.key,n.attributes,n.source.key,n.target.key,n.source.attributes,n.target.attributes,n.undirected),i&&a)return n.key;n=n.next}while(n!==void 0)}function fr(i,e){let t=i[e];if(t.next!==void 0)return{[Symbol.iterator](){return this},next(){if(!t)return{done:!0};const n={edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected};return t=t.next,{done:!1,value:n}}};let r=!1;return{[Symbol.iterator](){return this},next(){return r===!0?{done:!0}:(r=!0,{done:!1,value:{edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected}})}}}function Ba(i,e){if(i.size===0)return[];if(e==="mixed"||e===i.type)return Array.from(i._edges.keys());const t=e==="undirected"?i.undirectedSize:i.directedSize,r=new Array(t),n=e==="undirected",a=i._edges.values();let o=0,s,u;for(;s=a.next(),s.done!==!0;)u=s.value,u.undirected===n&&(r[o++]=u.key);return r}function yn(i,e,t,r){if(e.size===0)return;const n=t!=="mixed"&&t!==e.type,a=t==="undirected";let o,s,u=!1;const d=e._edges.values();for(;o=d.next(),o.done!==!0;){if(s=o.value,n&&s.undirected!==a)continue;const{key:h,attributes:l,source:f,target:p}=s;if(u=r(h,l,f.key,p.key,f.attributes,p.attributes,s.undirected),i&&u)return h}}function Ha(i,e){if(i.size===0)return Et();const t=e!=="mixed"&&e!==i.type,r=e==="undirected",n=i._edges.values();return{[Symbol.iterator](){return this},next(){let a,o;for(;;){if(a=n.next(),a.done)return a;if(o=a.value,!(t&&o.undirected!==r))break}return{value:{edge:o.key,attributes:o.attributes,source:o.source.key,target:o.target.key,sourceAttributes:o.source.attributes,targetAttributes:o.target.attributes,undirected:o.undirected},done:!1}}}}function Wr(i,e,t,r,n,a){const o=e?za:$a;let s;if(t!=="undirected"&&(r!=="out"&&(s=o(i,n.in,a),i&&s)||r!=="in"&&(s=o(i,n.out,a,r?void 0:n.key),i&&s))||t!=="directed"&&(s=o(i,n.undirected,a),i&&s))return s}function Wa(i,e,t,r){const n=[];return Wr(!1,i,e,t,r,function(a){n.push(a)}),n}function ja(i,e,t){let r=Et();return i!=="undirected"&&(e!=="out"&&typeof t.in<"u"&&(r=Xe(r,lr(t.in))),e!=="in"&&typeof t.out<"u"&&(r=Xe(r,lr(t.out,e?void 0:t.key)))),i!=="directed"&&typeof t.undirected<"u"&&(r=Xe(r,lr(t.undirected))),r}function jr(i,e,t,r,n,a,o){const s=t?Ma:Ua;let u;if(e!=="undirected"&&(typeof n.in<"u"&&r!=="out"&&(u=s(i,n.in,a,o),i&&u)||typeof n.out<"u"&&r!=="in"&&(r||n.key!==a)&&(u=s(i,n.out,a,o),i&&u))||e!=="directed"&&typeof n.undirected<"u"&&(u=s(i,n.undirected,a,o),i&&u))return u}function Va(i,e,t,r,n){const a=[];return jr(!1,i,e,t,r,n,function(o){a.push(o)}),a}function qa(i,e,t,r){let n=Et();return i!=="undirected"&&(typeof t.in<"u"&&e!=="out"&&r in t.in&&(n=Xe(n,fr(t.in,r))),typeof t.out<"u"&&e!=="in"&&r in t.out&&(e||t.key!==r)&&(n=Xe(n,fr(t.out,r)))),i!=="directed"&&typeof t.undirected<"u"&&r in t.undirected&&(n=Xe(n,fr(t.undirected,r))),n}function Ka(i,e){const{name:t,type:r,direction:n}=e;i.prototype[t]=function(a,o){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];if(!arguments.length)return Ba(this,r);if(arguments.length===1){a=""+a;const s=this._nodes.get(a);if(typeof s>"u")throw new G(`Graph.${t}: could not find the "${a}" node in the graph.`);return Wa(this.multi,r==="mixed"?this.type:r,n,s)}if(arguments.length===2){a=""+a,o=""+o;const s=this._nodes.get(a);if(!s)throw new G(`Graph.${t}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(o))throw new G(`Graph.${t}:  could not find the "${o}" target node in the graph.`);return Va(r,this.multi,n,s,o)}throw new F(`Graph.${t}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Ya(i,e){const{name:t,type:r,direction:n}=e,a="forEach"+t[0].toUpperCase()+t.slice(1,-1);i.prototype[a]=function(d,h,l){if(!(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)){if(arguments.length===1)return l=d,yn(!1,this,r,l);if(arguments.length===2){d=""+d,l=h;const f=this._nodes.get(d);if(typeof f>"u")throw new G(`Graph.${a}: could not find the "${d}" node in the graph.`);return Wr(!1,this.multi,r==="mixed"?this.type:r,n,f,l)}if(arguments.length===3){d=""+d,h=""+h;const f=this._nodes.get(d);if(!f)throw new G(`Graph.${a}:  could not find the "${d}" source node in the graph.`);if(!this._nodes.has(h))throw new G(`Graph.${a}:  could not find the "${h}" target node in the graph.`);return jr(!1,r,this.multi,n,f,h,l)}throw new F(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const o="map"+t[0].toUpperCase()+t.slice(1);i.prototype[o]=function(){const d=Array.prototype.slice.call(arguments),h=d.pop();let l;if(d.length===0){let f=0;r!=="directed"&&(f+=this.undirectedSize),r!=="undirected"&&(f+=this.directedSize),l=new Array(f);let p=0;d.push((v,m,E,C,_,A,c)=>{l[p++]=h(v,m,E,C,_,A,c)})}else l=[],d.push((f,p,v,m,E,C,_)=>{l.push(h(f,p,v,m,E,C,_))});return this[a].apply(this,d),l};const s="filter"+t[0].toUpperCase()+t.slice(1);i.prototype[s]=function(){const d=Array.prototype.slice.call(arguments),h=d.pop(),l=[];return d.push((f,p,v,m,E,C,_)=>{h(f,p,v,m,E,C,_)&&l.push(f)}),this[a].apply(this,d),l};const u="reduce"+t[0].toUpperCase()+t.slice(1);i.prototype[u]=function(){let d=Array.prototype.slice.call(arguments);if(d.length<2||d.length>4)throw new F(`Graph.${u}: invalid number of arguments (expecting 2, 3 or 4 and got ${d.length}).`);if(typeof d[d.length-1]=="function"&&typeof d[d.length-2]!="function")throw new F(`Graph.${u}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let h,l;d.length===2?(h=d[0],l=d[1],d=[]):d.length===3?(h=d[1],l=d[2],d=[d[0]]):d.length===4&&(h=d[2],l=d[3],d=[d[0],d[1]]);let f=l;return d.push((p,v,m,E,C,_,A)=>{f=h(f,p,v,m,E,C,_,A)}),this[a].apply(this,d),f}}function Xa(i,e){const{name:t,type:r,direction:n}=e,a="find"+t[0].toUpperCase()+t.slice(1,-1);i.prototype[a]=function(u,d,h){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return!1;if(arguments.length===1)return h=u,yn(!0,this,r,h);if(arguments.length===2){u=""+u,h=d;const l=this._nodes.get(u);if(typeof l>"u")throw new G(`Graph.${a}: could not find the "${u}" node in the graph.`);return Wr(!0,this.multi,r==="mixed"?this.type:r,n,l,h)}if(arguments.length===3){u=""+u,d=""+d;const l=this._nodes.get(u);if(!l)throw new G(`Graph.${a}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(d))throw new G(`Graph.${a}:  could not find the "${d}" target node in the graph.`);return jr(!0,r,this.multi,n,l,d,h)}throw new F(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const o="some"+t[0].toUpperCase()+t.slice(1,-1);i.prototype[o]=function(){const u=Array.prototype.slice.call(arguments),d=u.pop();return u.push((l,f,p,v,m,E,C)=>d(l,f,p,v,m,E,C)),!!this[a].apply(this,u)};const s="every"+t[0].toUpperCase()+t.slice(1,-1);i.prototype[s]=function(){const u=Array.prototype.slice.call(arguments),d=u.pop();return u.push((l,f,p,v,m,E,C)=>!d(l,f,p,v,m,E,C)),!this[a].apply(this,u)}}function Za(i,e){const{name:t,type:r,direction:n}=e,a=t.slice(0,-1)+"Entries";i.prototype[a]=function(o,s){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return Et();if(!arguments.length)return Ha(this,r);if(arguments.length===1){o=""+o;const u=this._nodes.get(o);if(!u)throw new G(`Graph.${a}: could not find the "${o}" node in the graph.`);return ja(r,n,u)}if(arguments.length===2){o=""+o,s=""+s;const u=this._nodes.get(o);if(!u)throw new G(`Graph.${a}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(s))throw new G(`Graph.${a}:  could not find the "${s}" target node in the graph.`);return qa(r,n,u,s)}throw new F(`Graph.${a}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Ja(i){Ia.forEach(e=>{Ka(i,e),Ya(i,e),Xa(i,e),Za(i,e)})}const Qa=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function or(){this.A=null,this.B=null}or.prototype.wrap=function(i){this.A===null?this.A=i:this.B===null&&(this.B=i)};or.prototype.has=function(i){return this.A!==null&&i in this.A||this.B!==null&&i in this.B};function Rt(i,e,t,r,n){for(const a in r){const o=r[a],s=o.source,u=o.target,d=s===t?u:s;if(e&&e.has(d.key))continue;const h=n(d.key,d.attributes);if(i&&h)return d.key}}function Vr(i,e,t,r,n){if(e!=="mixed"){if(e==="undirected")return Rt(i,null,r,r.undirected,n);if(typeof t=="string")return Rt(i,null,r,r[t],n)}const a=new or;let o;if(e!=="undirected"){if(t!=="out"){if(o=Rt(i,null,r,r.in,n),i&&o)return o;a.wrap(r.in)}if(t!=="in"){if(o=Rt(i,a,r,r.out,n),i&&o)return o;a.wrap(r.out)}}if(e!=="directed"&&(o=Rt(i,a,r,r.undirected,n),i&&o))return o}function eo(i,e,t){if(i!=="mixed"){if(i==="undirected")return Object.keys(t.undirected);if(typeof e=="string")return Object.keys(t[e])}const r=[];return Vr(!1,i,e,t,function(n){r.push(n)}),r}function St(i,e,t){const r=Object.keys(t),n=r.length;let a=0;return{[Symbol.iterator](){return this},next(){let o=null;do{if(a>=n)return i&&i.wrap(t),{done:!0};const s=t[r[a++]],u=s.source,d=s.target;if(o=u===e?d:u,i&&i.has(o.key)){o=null;continue}}while(o===null);return{done:!1,value:{neighbor:o.key,attributes:o.attributes}}}}}function to(i,e,t){if(i!=="mixed"){if(i==="undirected")return St(null,t,t.undirected);if(typeof e=="string")return St(null,t,t[e])}let r=Et();const n=new or;return i!=="undirected"&&(e!=="out"&&(r=Xe(r,St(n,t,t.in))),e!=="in"&&(r=Xe(r,St(n,t,t.out)))),i!=="directed"&&(r=Xe(r,St(n,t,t.undirected))),r}function ro(i,e){const{name:t,type:r,direction:n}=e;i.prototype[t]=function(a){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];a=""+a;const o=this._nodes.get(a);if(typeof o>"u")throw new G(`Graph.${t}: could not find the "${a}" node in the graph.`);return eo(r==="mixed"?this.type:r,n,o)}}function io(i,e){const{name:t,type:r,direction:n}=e,a="forEach"+t[0].toUpperCase()+t.slice(1,-1);i.prototype[a]=function(d,h){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;d=""+d;const l=this._nodes.get(d);if(typeof l>"u")throw new G(`Graph.${a}: could not find the "${d}" node in the graph.`);Vr(!1,r==="mixed"?this.type:r,n,l,h)};const o="map"+t[0].toUpperCase()+t.slice(1);i.prototype[o]=function(d,h){const l=[];return this[a](d,(f,p)=>{l.push(h(f,p))}),l};const s="filter"+t[0].toUpperCase()+t.slice(1);i.prototype[s]=function(d,h){const l=[];return this[a](d,(f,p)=>{h(f,p)&&l.push(f)}),l};const u="reduce"+t[0].toUpperCase()+t.slice(1);i.prototype[u]=function(d,h,l){if(arguments.length<3)throw new F(`Graph.${u}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let f=l;return this[a](d,(p,v)=>{f=h(f,p,v)}),f}}function no(i,e){const{name:t,type:r,direction:n}=e,a=t[0].toUpperCase()+t.slice(1,-1),o="find"+a;i.prototype[o]=function(d,h){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;d=""+d;const l=this._nodes.get(d);if(typeof l>"u")throw new G(`Graph.${o}: could not find the "${d}" node in the graph.`);return Vr(!0,r==="mixed"?this.type:r,n,l,h)};const s="some"+a;i.prototype[s]=function(d,h){return!!this[o](d,h)};const u="every"+a;i.prototype[u]=function(d,h){return!this[o](d,(f,p)=>!h(f,p))}}function ao(i,e){const{name:t,type:r,direction:n}=e,a=t.slice(0,-1)+"Entries";i.prototype[a]=function(o){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return Et();o=""+o;const s=this._nodes.get(o);if(typeof s>"u")throw new G(`Graph.${a}: could not find the "${o}" node in the graph.`);return to(r==="mixed"?this.type:r,n,s)}}function oo(i){Qa.forEach(e=>{ro(i,e),io(i,e),no(i,e),ao(i,e)})}function Vt(i,e,t,r,n){const a=r._nodes.values(),o=r.type;let s,u,d,h,l,f;for(;s=a.next(),s.done!==!0;){let p=!1;if(u=s.value,o!=="undirected"){h=u.out;for(d in h){l=h[d];do f=l.target,p=!0,n(u.key,f.key,u.attributes,f.attributes,l.key,l.attributes,l.undirected),l=l.next;while(l)}}if(o!=="directed"){h=u.undirected;for(d in h)if(!(e&&u.key>d)){l=h[d];do f=l.target,f.key!==d&&(f=l.source),p=!0,n(u.key,f.key,u.attributes,f.attributes,l.key,l.attributes,l.undirected),l=l.next;while(l)}}t&&!p&&n(u.key,null,u.attributes,null,null,null,null)}}function so(i,e){const t={key:i};return cn(e.attributes)||(t.attributes=se({},e.attributes)),t}function uo(i,e,t){const r={key:e,source:t.source.key,target:t.target.key};return cn(t.attributes)||(r.attributes=se({},t.attributes)),i==="mixed"&&t.undirected&&(r.undirected=!0),r}function ho(i){if(!ce(i))throw new F('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in i))throw new F("Graph.import: serialized node is missing its key.");if("attributes"in i&&(!ce(i.attributes)||i.attributes===null))throw new F("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function co(i){if(!ce(i))throw new F('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in i))throw new F("Graph.import: serialized edge is missing its source.");if(!("target"in i))throw new F("Graph.import: serialized edge is missing its target.");if("attributes"in i&&(!ce(i.attributes)||i.attributes===null))throw new F("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in i&&typeof i.undirected!="boolean")throw new F("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const lo=fa(),fo=new Set(["directed","undirected","mixed"]),hi=new Set(["domain","_events","_eventsCount","_maxListeners"]),po=[{name:i=>`${i}Edge`,generateKey:!0},{name:i=>`${i}DirectedEdge`,generateKey:!0,type:"directed"},{name:i=>`${i}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:i=>`${i}EdgeWithKey`},{name:i=>`${i}DirectedEdgeWithKey`,type:"directed"},{name:i=>`${i}UndirectedEdgeWithKey`,type:"undirected"}],go={allowSelfLoops:!0,multi:!1,type:"mixed"};function vo(i,e,t){if(t&&!ce(t))throw new F(`Graph.addNode: invalid attributes. Expecting an object but got "${t}"`);if(e=""+e,t=t||{},i._nodes.has(e))throw new H(`Graph.addNode: the "${e}" node already exist in the graph.`);const r=new i.NodeDataClass(e,t);return i._nodes.set(e,r),i.emit("nodeAdded",{key:e,attributes:t}),r}function ci(i,e,t){const r=new i.NodeDataClass(e,t);return i._nodes.set(e,r),i.emit("nodeAdded",{key:e,attributes:t}),r}function bn(i,e,t,r,n,a,o,s){if(!r&&i.type==="undirected")throw new H(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(r&&i.type==="directed")throw new H(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(s&&!ce(s))throw new F(`Graph.${e}: invalid attributes. Expecting an object but got "${s}"`);if(a=""+a,o=""+o,s=s||{},!i.allowSelfLoops&&a===o)throw new H(`Graph.${e}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const u=i._nodes.get(a),d=i._nodes.get(o);if(!u)throw new G(`Graph.${e}: source node "${a}" not found.`);if(!d)throw new G(`Graph.${e}: target node "${o}" not found.`);const h={key:null,undirected:r,source:a,target:o,attributes:s};if(t)n=i._edgeKeyGenerator();else if(n=""+n,i._edges.has(n))throw new H(`Graph.${e}: the "${n}" edge already exists in the graph.`);if(!i.multi&&(r?typeof u.undirected[o]<"u":typeof u.out[o]<"u"))throw new H(`Graph.${e}: an edge linking "${a}" to "${o}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const l=new _t(r,n,u,d,s);i._edges.set(n,l);const f=a===o;return r?(u.undirectedDegree++,d.undirectedDegree++,f&&(u.undirectedLoops++,i._undirectedSelfLoopCount++)):(u.outDegree++,d.inDegree++,f&&(u.directedLoops++,i._directedSelfLoopCount++)),i.multi?l.attachMulti():l.attach(),r?i._undirectedSize++:i._directedSize++,h.key=n,i.emit("edgeAdded",h),n}function mo(i,e,t,r,n,a,o,s,u){if(!r&&i.type==="undirected")throw new H(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(r&&i.type==="directed")throw new H(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(s){if(u){if(typeof s!="function")throw new F(`Graph.${e}: invalid updater function. Expecting a function but got "${s}"`)}else if(!ce(s))throw new F(`Graph.${e}: invalid attributes. Expecting an object but got "${s}"`)}a=""+a,o=""+o;let d;if(u&&(d=s,s=void 0),!i.allowSelfLoops&&a===o)throw new H(`Graph.${e}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let h=i._nodes.get(a),l=i._nodes.get(o),f,p;if(!t&&(f=i._edges.get(n),f)){if((f.source.key!==a||f.target.key!==o)&&(!r||f.source.key!==o||f.target.key!==a))throw new H(`Graph.${e}: inconsistency detected when attempting to merge the "${n}" edge with "${a}" source & "${o}" target vs. ("${f.source.key}", "${f.target.key}").`);p=f}if(!p&&!i.multi&&h&&(p=r?h.undirected[o]:h.out[o]),p){const _=[p.key,!1,!1,!1];if(u?!d:!s)return _;if(u){const A=p.attributes;p.attributes=d(A),i.emit("edgeAttributesUpdated",{type:"replace",key:p.key,attributes:p.attributes})}else se(p.attributes,s),i.emit("edgeAttributesUpdated",{type:"merge",key:p.key,attributes:p.attributes,data:s});return _}s=s||{},u&&d&&(s=d(s));const v={key:null,undirected:r,source:a,target:o,attributes:s};if(t)n=i._edgeKeyGenerator();else if(n=""+n,i._edges.has(n))throw new H(`Graph.${e}: the "${n}" edge already exists in the graph.`);let m=!1,E=!1;h||(h=ci(i,a,{}),m=!0,a===o&&(l=h,E=!0)),l||(l=ci(i,o,{}),E=!0),f=new _t(r,n,h,l,s),i._edges.set(n,f);const C=a===o;return r?(h.undirectedDegree++,l.undirectedDegree++,C&&(h.undirectedLoops++,i._undirectedSelfLoopCount++)):(h.outDegree++,l.inDegree++,C&&(h.directedLoops++,i._directedSelfLoopCount++)),i.multi?f.attachMulti():f.attach(),r?i._undirectedSize++:i._directedSize++,v.key=n,i.emit("edgeAdded",v),[n,!0,m,E]}function ct(i,e){i._edges.delete(e.key);const{source:t,target:r,attributes:n}=e,a=e.undirected,o=t===r;a?(t.undirectedDegree--,r.undirectedDegree--,o&&(t.undirectedLoops--,i._undirectedSelfLoopCount--)):(t.outDegree--,r.inDegree--,o&&(t.directedLoops--,i._directedSelfLoopCount--)),i.multi?e.detachMulti():e.detach(),a?i._undirectedSize--:i._directedSize--,i.emit("edgeDropped",{key:e.key,attributes:n,source:t.key,target:r.key,undirected:a})}class ie extends hn.EventEmitter{constructor(e){if(super(),e=se({},go,e),typeof e.multi!="boolean")throw new F(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!fo.has(e.type))throw new F(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new F(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const t=e.type==="mixed"?ln:e.type==="directed"?fn:pn;De(this,"NodeDataClass",t);const r="geid_"+lo()+"_";let n=0;const a=()=>{let o;do o=r+n++;while(this._edges.has(o));return o};De(this,"_attributes",{}),De(this,"_nodes",new Map),De(this,"_edges",new Map),De(this,"_directedSize",0),De(this,"_undirectedSize",0),De(this,"_directedSelfLoopCount",0),De(this,"_undirectedSelfLoopCount",0),De(this,"_edgeKeyGenerator",a),De(this,"_options",e),hi.forEach(o=>De(this,o,this[o])),Pe(this,"order",()=>this._nodes.size),Pe(this,"size",()=>this._edges.size),Pe(this,"directedSize",()=>this._directedSize),Pe(this,"undirectedSize",()=>this._undirectedSize),Pe(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),Pe(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),Pe(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),Pe(this,"multi",this._options.multi),Pe(this,"type",this._options.type),Pe(this,"allowSelfLoops",this._options.allowSelfLoops),Pe(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,t){if(this.type==="undirected")return!1;if(arguments.length===1){const r=""+e,n=this._edges.get(r);return!!n&&!n.undirected}else if(arguments.length===2){e=""+e,t=""+t;const r=this._nodes.get(e);return r?r.out.hasOwnProperty(t):!1}throw new F(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,t){if(this.type==="directed")return!1;if(arguments.length===1){const r=""+e,n=this._edges.get(r);return!!n&&n.undirected}else if(arguments.length===2){e=""+e,t=""+t;const r=this._nodes.get(e);return r?r.undirected.hasOwnProperty(t):!1}throw new F(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,t){if(arguments.length===1){const r=""+e;return this._edges.has(r)}else if(arguments.length===2){e=""+e,t=""+t;const r=this._nodes.get(e);return r?typeof r.out<"u"&&r.out.hasOwnProperty(t)||typeof r.undirected<"u"&&r.undirected.hasOwnProperty(t):!1}throw new F(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,t){if(this.type==="undirected")return;if(e=""+e,t=""+t,this.multi)throw new H("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const r=this._nodes.get(e);if(!r)throw new G(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new G(`Graph.directedEdge: could not find the "${t}" target node in the graph.`);const n=r.out&&r.out[t]||void 0;if(n)return n.key}undirectedEdge(e,t){if(this.type==="directed")return;if(e=""+e,t=""+t,this.multi)throw new H("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const r=this._nodes.get(e);if(!r)throw new G(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new G(`Graph.undirectedEdge: could not find the "${t}" target node in the graph.`);const n=r.undirected&&r.undirected[t]||void 0;if(n)return n.key}edge(e,t){if(this.multi)throw new H("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new G(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new G(`Graph.edge: could not find the "${t}" target node in the graph.`);const n=r.out&&r.out[t]||r.undirected&&r.undirected[t]||void 0;if(n)return n.key}areDirectedNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new G(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in r.in||t in r.out}areOutNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new G(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in r.out}areInNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new G(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in r.in}areUndirectedNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new G(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:t in r.undirected}areNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new G(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(t in r.in||t in r.out)||this.type!=="directed"&&t in r.undirected}areInboundNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new G(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in r.in||this.type!=="directed"&&t in r.undirected}areOutboundNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new G(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in r.out||this.type!=="directed"&&t in r.undirected}inDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree}outDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree}directedDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree}undirectedDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree}inboundDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=t.undirectedDegree),this.type!=="undirected"&&(r+=t.inDegree),r}outboundDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=t.undirectedDegree),this.type!=="undirected"&&(r+=t.outDegree),r}degree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.degree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=t.undirectedDegree),this.type!=="undirected"&&(r+=t.inDegree+t.outDegree),r}inDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree-t.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree-t.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree-t.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree-t.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,n=0;return this.type!=="directed"&&(r+=t.undirectedDegree,n+=t.undirectedLoops*2),this.type!=="undirected"&&(r+=t.inDegree,n+=t.directedLoops),r-n}outboundDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,n=0;return this.type!=="directed"&&(r+=t.undirectedDegree,n+=t.undirectedLoops*2),this.type!=="undirected"&&(r+=t.outDegree,n+=t.directedLoops),r-n}degreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,n=0;return this.type!=="directed"&&(r+=t.undirectedDegree,n+=t.undirectedLoops*2),this.type!=="undirected"&&(r+=t.inDegree+t.outDegree,n+=t.directedLoops*2),r-n}source(e){e=""+e;const t=this._edges.get(e);if(!t)throw new G(`Graph.source: could not find the "${e}" edge in the graph.`);return t.source.key}target(e){e=""+e;const t=this._edges.get(e);if(!t)throw new G(`Graph.target: could not find the "${e}" edge in the graph.`);return t.target.key}extremities(e){e=""+e;const t=this._edges.get(e);if(!t)throw new G(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[t.source.key,t.target.key]}opposite(e,t){e=""+e,t=""+t;const r=this._edges.get(t);if(!r)throw new G(`Graph.opposite: could not find the "${t}" edge in the graph.`);const n=r.source.key,a=r.target.key;if(e===n)return a;if(e===a)return n;throw new G(`Graph.opposite: the "${e}" node is not attached to the "${t}" edge (${n}, ${a}).`)}hasExtremity(e,t){e=""+e,t=""+t;const r=this._edges.get(e);if(!r)throw new G(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return r.source.key===t||r.target.key===t}isUndirected(e){e=""+e;const t=this._edges.get(e);if(!t)throw new G(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return t.undirected}isDirected(e){e=""+e;const t=this._edges.get(e);if(!t)throw new G(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!t.undirected}isSelfLoop(e){e=""+e;const t=this._edges.get(e);if(!t)throw new G(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return t.source===t.target}addNode(e,t){return vo(this,e,t).key}mergeNode(e,t){if(t&&!ce(t))throw new F(`Graph.mergeNode: invalid attributes. Expecting an object but got "${t}"`);e=""+e,t=t||{};let r=this._nodes.get(e);return r?(t&&(se(r.attributes,t),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:r.attributes,data:t})),[e,!1]):(r=new this.NodeDataClass(e,t),this._nodes.set(e,r),this.emit("nodeAdded",{key:e,attributes:t}),[e,!0])}updateNode(e,t){if(t&&typeof t!="function")throw new F(`Graph.updateNode: invalid updater function. Expecting a function but got "${t}"`);e=""+e;let r=this._nodes.get(e);if(r){if(t){const a=r.attributes;r.attributes=t(a),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:r.attributes})}return[e,!1]}const n=t?t({}):{};return r=new this.NodeDataClass(e,n),this._nodes.set(e,r),this.emit("nodeAdded",{key:e,attributes:n}),[e,!0]}dropNode(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new G(`Graph.dropNode: could not find the "${e}" node in the graph.`);let r;if(this.type!=="undirected"){for(const n in t.out){r=t.out[n];do ct(this,r),r=r.next;while(r)}for(const n in t.in){r=t.in[n];do ct(this,r),r=r.next;while(r)}}if(this.type!=="directed")for(const n in t.undirected){r=t.undirected[n];do ct(this,r),r=r.next;while(r)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:t.attributes})}dropEdge(e){let t;if(arguments.length>1){const r=""+arguments[0],n=""+arguments[1];if(t=Le(this,r,n,this.type),!t)throw new G(`Graph.dropEdge: could not find the "${r}" -> "${n}" edge in the graph.`)}else if(e=""+e,t=this._edges.get(e),!t)throw new G(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return ct(this,t),this}dropDirectedEdge(e,t){if(arguments.length<2)throw new H("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new H("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,t=""+t;const r=Le(this,e,t,"directed");if(!r)throw new G(`Graph.dropDirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return ct(this,r),this}dropUndirectedEdge(e,t){if(arguments.length<2)throw new H("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new H("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const r=Le(this,e,t,"undirected");if(!r)throw new G(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return ct(this,r),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let t;for(;t=e.next(),t.done!==!0;)t.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,t){return this._attributes[e]=t,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,t){if(typeof t!="function")throw new F("Graph.updateAttribute: updater should be a function.");const r=this._attributes[e];return this._attributes[e]=t(r),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!ce(e))throw new F("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!ce(e))throw new F("Graph.mergeAttributes: provided attributes are not a plain object.");return se(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new F("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,t){if(typeof e!="function")throw new F("Graph.updateEachNodeAttributes: expecting an updater function.");if(t&&!di(t))throw new F("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._nodes.values();let n,a;for(;n=r.next(),n.done!==!0;)a=n.value,a.attributes=e(a.key,a.attributes);this.emit("eachNodeAttributesUpdated",{hints:t||null})}updateEachEdgeAttributes(e,t){if(typeof e!="function")throw new F("Graph.updateEachEdgeAttributes: expecting an updater function.");if(t&&!di(t))throw new F("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._edges.values();let n,a,o,s;for(;n=r.next(),n.done!==!0;)a=n.value,o=a.source,s=a.target,a.attributes=e(a.key,a.attributes,o.key,s.key,o.attributes,s.attributes,a.undirected);this.emit("eachEdgeAttributesUpdated",{hints:t||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new F("Graph.forEachAdjacencyEntry: expecting a callback.");Vt(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new F("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");Vt(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new F("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");Vt(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new F("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");Vt(!1,!0,!0,this,e)}nodes(){return Array.from(this._nodes.keys())}forEachNode(e){if(typeof e!="function")throw new F("Graph.forEachNode: expecting a callback.");const t=this._nodes.values();let r,n;for(;r=t.next(),r.done!==!0;)n=r.value,e(n.key,n.attributes)}findNode(e){if(typeof e!="function")throw new F("Graph.findNode: expecting a callback.");const t=this._nodes.values();let r,n;for(;r=t.next(),r.done!==!0;)if(n=r.value,e(n.key,n.attributes))return n.key}mapNodes(e){if(typeof e!="function")throw new F("Graph.mapNode: expecting a callback.");const t=this._nodes.values();let r,n;const a=new Array(this.order);let o=0;for(;r=t.next(),r.done!==!0;)n=r.value,a[o++]=e(n.key,n.attributes);return a}someNode(e){if(typeof e!="function")throw new F("Graph.someNode: expecting a callback.");const t=this._nodes.values();let r,n;for(;r=t.next(),r.done!==!0;)if(n=r.value,e(n.key,n.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new F("Graph.everyNode: expecting a callback.");const t=this._nodes.values();let r,n;for(;r=t.next(),r.done!==!0;)if(n=r.value,!e(n.key,n.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new F("Graph.filterNodes: expecting a callback.");const t=this._nodes.values();let r,n;const a=[];for(;r=t.next(),r.done!==!0;)n=r.value,e(n.key,n.attributes)&&a.push(n.key);return a}reduceNodes(e,t){if(typeof e!="function")throw new F("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new F("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let r=t;const n=this._nodes.values();let a,o;for(;a=n.next(),a.done!==!0;)o=a.value,r=e(r,o.key,o.attributes);return r}nodeEntries(){const e=this._nodes.values();return{[Symbol.iterator](){return this},next(){const t=e.next();if(t.done)return t;const r=t.value;return{value:{node:r.key,attributes:r.attributes},done:!1}}}}export(){const e=new Array(this._nodes.size);let t=0;this._nodes.forEach((n,a)=>{e[t++]=so(a,n)});const r=new Array(this._edges.size);return t=0,this._edges.forEach((n,a)=>{r[t++]=uo(this.type,a,n)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:r}}import(e,t=!1){if(e instanceof ie)return e.forEachNode((u,d)=>{t?this.mergeNode(u,d):this.addNode(u,d)}),e.forEachEdge((u,d,h,l,f,p,v)=>{t?v?this.mergeUndirectedEdgeWithKey(u,h,l,d):this.mergeDirectedEdgeWithKey(u,h,l,d):v?this.addUndirectedEdgeWithKey(u,h,l,d):this.addDirectedEdgeWithKey(u,h,l,d)}),this;if(!ce(e))throw new F("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!ce(e.attributes))throw new F("Graph.import: invalid attributes. Expecting a plain object.");t?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let r,n,a,o,s;if(e.nodes){if(a=e.nodes,!Array.isArray(a))throw new F("Graph.import: invalid nodes. Expecting an array.");for(r=0,n=a.length;r<n;r++){o=a[r],ho(o);const{key:u,attributes:d}=o;t?this.mergeNode(u,d):this.addNode(u,d)}}if(e.edges){let u=!1;if(this.type==="undirected"&&(u=!0),a=e.edges,!Array.isArray(a))throw new F("Graph.import: invalid edges. Expecting an array.");for(r=0,n=a.length;r<n;r++){s=a[r],co(s);const{source:d,target:h,attributes:l,undirected:f=u}=s;let p;"key"in s?(p=t?f?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:f?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,p.call(this,s.key,d,h,l)):(p=t?f?this.mergeUndirectedEdge:this.mergeDirectedEdge:f?this.addUndirectedEdge:this.addDirectedEdge,p.call(this,d,h,l))}}return this}nullCopy(e){const t=new ie(se({},this._options,e));return t.replaceAttributes(se({},this.getAttributes())),t}emptyCopy(e){const t=this.nullCopy(e);return this._nodes.forEach((r,n)=>{const a=se({},r.attributes);r=new t.NodeDataClass(n,a),t._nodes.set(n,r)}),t}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new H(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new H("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new H("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const t=this.emptyCopy(e),r=this._edges.values();let n,a;for(;n=r.next(),n.done!==!0;)a=n.value,bn(t,"copy",!1,a.undirected,a.key,a.source.key,a.target.key,se({},a.attributes));return t}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((a,o)=>{e[o]=a.attributes});const t={},r={};this._edges.forEach((a,o)=>{const s=a.undirected?"--":"->";let u="",d=a.source.key,h=a.target.key,l;a.undirected&&d>h&&(l=d,d=h,h=l);const f=`(${d})${s}(${h})`;o.startsWith("geid_")?this.multi&&(typeof r[f]>"u"?r[f]=0:r[f]++,u+=`${r[f]}. `):u+=`[${o}]: `,u+=f,t[u]=a.attributes});const n={};for(const a in this)this.hasOwnProperty(a)&&!hi.has(a)&&typeof this[a]!="function"&&typeof a!="symbol"&&(n[a]=this[a]);return n.attributes=this._attributes,n.nodes=e,n.edges=t,De(n,"constructor",this.constructor),n}}typeof Symbol<"u"&&(ie.prototype[Symbol.for("nodejs.util.inspect.custom")]=ie.prototype.inspect);po.forEach(i=>{["add","merge","update"].forEach(e=>{const t=i.name(e),r=e==="add"?bn:mo;i.generateKey?ie.prototype[t]=function(n,a,o){return r(this,t,!0,(i.type||this.type)==="undirected",null,n,a,o,e==="update")}:ie.prototype[t]=function(n,a,o,s){return r(this,t,!1,(i.type||this.type)==="undirected",n,a,o,s,e==="update")}})});Ra(ie);Na(ie);Ja(ie);oo(ie);class qr extends ie{constructor(e){const t=se({type:"directed"},e);if("multi"in t&&t.multi!==!1)throw new F("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="directed")throw new F('DirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class wn extends ie{constructor(e){const t=se({type:"undirected"},e);if("multi"in t&&t.multi!==!1)throw new F("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="undirected")throw new F('UndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class En extends ie{constructor(e){const t=se({multi:!0},e);if("multi"in t&&t.multi!==!0)throw new F("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(t)}}class _n extends ie{constructor(e){const t=se({type:"directed",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new F("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="directed")throw new F('MultiDirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class Tn extends ie{constructor(e){const t=se({type:"undirected",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new F("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="undirected")throw new F('MultiUndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}function Tt(i){i.from=function(e,t){const r=se({},e.options,t),n=new i(r);return n.import(e),n}}Tt(ie);Tt(qr);Tt(wn);Tt(En);Tt(_n);Tt(Tn);ie.Graph=ie;ie.DirectedGraph=qr;ie.UndirectedGraph=wn;ie.MultiGraph=En;ie.MultiDirectedGraph=_n;ie.MultiUndirectedGraph=Tn;ie.InvalidArgumentsGraphError=F;ie.NotFoundGraphError=G;ie.UsageGraphError=H;var pr,li;function Kr(){return li||(li=1,pr=function(e){return e!==null&&typeof e=="object"&&typeof e.addUndirectedEdgeWithKey=="function"&&typeof e.dropNode=="function"&&typeof e.multi=="boolean"}),pr}var Ct={},fi;function yo(){if(fi)return Ct;fi=1;function i(r){return typeof r!="number"||isNaN(r)?1:r}function e(r,n){var a={},o=function(d){return typeof d>"u"?n:d};typeof n=="function"&&(o=n);var s=function(d){return o(d[r])},u=function(){return o(void 0)};return typeof r=="string"?(a.fromAttributes=s,a.fromGraph=function(d,h){return s(d.getNodeAttributes(h))},a.fromEntry=function(d,h){return s(h)}):typeof r=="function"?(a.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},a.fromGraph=function(d,h){return o(r(h,d.getNodeAttributes(h)))},a.fromEntry=function(d,h){return o(r(d,h))}):(a.fromAttributes=u,a.fromGraph=u,a.fromEntry=u),a}function t(r,n){var a={},o=function(d){return typeof d>"u"?n:d};typeof n=="function"&&(o=n);var s=function(d){return o(d[r])},u=function(){return o(void 0)};return typeof r=="string"?(a.fromAttributes=s,a.fromGraph=function(d,h){return s(d.getEdgeAttributes(h))},a.fromEntry=function(d,h){return s(h)},a.fromPartialEntry=a.fromEntry,a.fromMinimalEntry=a.fromEntry):typeof r=="function"?(a.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},a.fromGraph=function(d,h){var l=d.extremities(h);return o(r(h,d.getEdgeAttributes(h),l[0],l[1],d.getNodeAttributes(l[0]),d.getNodeAttributes(l[1]),d.isUndirected(h)))},a.fromEntry=function(d,h,l,f,p,v,m){return o(r(d,h,l,f,p,v,m))},a.fromPartialEntry=function(d,h,l,f){return o(r(d,h,l,f))},a.fromMinimalEntry=function(d,h){return o(r(d,h))}):(a.fromAttributes=u,a.fromGraph=u,a.fromEntry=u,a.fromMinimalEntry=u),a}return Ct.createNodeValueGetter=e,Ct.createEdgeValueGetter=t,Ct.createEdgeWeightGetter=function(r){return t(r,i)},Ct}var gr,pi;function bo(){if(pi)return gr;pi=1;var i=0,e=1,t=2,r=3,n=4,a=5,o=6,s=7,u=8,d=9,h=0,l=1,f=2,p=0,v=1,m=2,E=3,C=4,_=5,A=6,c=7,w=8,b=3,T=10,O=3,L=9,k=10;return gr=function(P,g,K){var J,x,y,U,W,Q,ne,X,N,ue,ee=g.length,Ee=K.length,ye=P.adjustSizes,pe=P.barnesHutTheta*P.barnesHutTheta,ge,Y,q,V,re,M,z,R=[];for(y=0;y<ee;y+=T)g[y+n]=g[y+t],g[y+a]=g[y+r],g[y+t]=0,g[y+r]=0;if(P.outboundAttractionDistribution){for(ge=0,y=0;y<ee;y+=T)ge+=g[y+o];ge/=ee/T}if(P.barnesHutOptimize){var ve=1/0,me=-1/0,be=1/0,oe=-1/0,ae,de,he;for(y=0;y<ee;y+=T)ve=Math.min(ve,g[y+i]),me=Math.max(me,g[y+i]),be=Math.min(be,g[y+e]),oe=Math.max(oe,g[y+e]);var Ae=me-ve,Be=oe-be;for(Ae>Be?(be-=(Ae-Be)/2,oe=be+Ae):(ve-=(Be-Ae)/2,me=ve+Be),R[0+p]=-1,R[0+v]=(ve+me)/2,R[0+m]=(be+oe)/2,R[0+E]=Math.max(me-ve,oe-be),R[0+C]=-1,R[0+_]=-1,R[0+A]=0,R[0+c]=0,R[0+w]=0,J=1,y=0;y<ee;y+=T)for(x=0,he=b;;)if(R[x+_]>=0){g[y+i]<R[x+v]?g[y+e]<R[x+m]?ae=R[x+_]:ae=R[x+_]+L:g[y+e]<R[x+m]?ae=R[x+_]+L*2:ae=R[x+_]+L*3,R[x+c]=(R[x+c]*R[x+A]+g[y+i]*g[y+o])/(R[x+A]+g[y+o]),R[x+w]=(R[x+w]*R[x+A]+g[y+e]*g[y+o])/(R[x+A]+g[y+o]),R[x+A]+=g[y+o],x=ae;continue}else if(R[x+p]<0){R[x+p]=y;break}else{if(R[x+_]=J*L,X=R[x+E]/2,N=R[x+_],R[N+p]=-1,R[N+v]=R[x+v]-X,R[N+m]=R[x+m]-X,R[N+E]=X,R[N+C]=N+L,R[N+_]=-1,R[N+A]=0,R[N+c]=0,R[N+w]=0,N+=L,R[N+p]=-1,R[N+v]=R[x+v]-X,R[N+m]=R[x+m]+X,R[N+E]=X,R[N+C]=N+L,R[N+_]=-1,R[N+A]=0,R[N+c]=0,R[N+w]=0,N+=L,R[N+p]=-1,R[N+v]=R[x+v]+X,R[N+m]=R[x+m]-X,R[N+E]=X,R[N+C]=N+L,R[N+_]=-1,R[N+A]=0,R[N+c]=0,R[N+w]=0,N+=L,R[N+p]=-1,R[N+v]=R[x+v]+X,R[N+m]=R[x+m]+X,R[N+E]=X,R[N+C]=R[x+C],R[N+_]=-1,R[N+A]=0,R[N+c]=0,R[N+w]=0,J+=4,g[R[x+p]+i]<R[x+v]?g[R[x+p]+e]<R[x+m]?ae=R[x+_]:ae=R[x+_]+L:g[R[x+p]+e]<R[x+m]?ae=R[x+_]+L*2:ae=R[x+_]+L*3,R[x+A]=g[R[x+p]+o],R[x+c]=g[R[x+p]+i],R[x+w]=g[R[x+p]+e],R[ae+p]=R[x+p],R[x+p]=-1,g[y+i]<R[x+v]?g[y+e]<R[x+m]?de=R[x+_]:de=R[x+_]+L:g[y+e]<R[x+m]?de=R[x+_]+L*2:de=R[x+_]+L*3,ae===de)if(he--){x=ae;continue}else{he=b;break}R[de+p]=y;break}}if(P.barnesHutOptimize)for(Y=P.scalingRatio,y=0;y<ee;y+=T)for(x=0;;)if(R[x+_]>=0)if(M=Math.pow(g[y+i]-R[x+c],2)+Math.pow(g[y+e]-R[x+w],2),ue=R[x+E],4*ue*ue/M<pe){if(q=g[y+i]-R[x+c],V=g[y+e]-R[x+w],ye===!0?M>0?(z=Y*g[y+o]*R[x+A]/M,g[y+t]+=q*z,g[y+r]+=V*z):M<0&&(z=-Y*g[y+o]*R[x+A]/Math.sqrt(M),g[y+t]+=q*z,g[y+r]+=V*z):M>0&&(z=Y*g[y+o]*R[x+A]/M,g[y+t]+=q*z,g[y+r]+=V*z),x=R[x+C],x<0)break;continue}else{x=R[x+_];continue}else{if(Q=R[x+p],Q>=0&&Q!==y&&(q=g[y+i]-g[Q+i],V=g[y+e]-g[Q+e],M=q*q+V*V,ye===!0?M>0?(z=Y*g[y+o]*g[Q+o]/M,g[y+t]+=q*z,g[y+r]+=V*z):M<0&&(z=-Y*g[y+o]*g[Q+o]/Math.sqrt(M),g[y+t]+=q*z,g[y+r]+=V*z):M>0&&(z=Y*g[y+o]*g[Q+o]/M,g[y+t]+=q*z,g[y+r]+=V*z)),x=R[x+C],x<0)break;continue}else for(Y=P.scalingRatio,U=0;U<ee;U+=T)for(W=0;W<U;W+=T)q=g[U+i]-g[W+i],V=g[U+e]-g[W+e],ye===!0?(M=Math.sqrt(q*q+V*V)-g[U+u]-g[W+u],M>0?(z=Y*g[U+o]*g[W+o]/M/M,g[U+t]+=q*z,g[U+r]+=V*z,g[W+t]-=q*z,g[W+r]-=V*z):M<0&&(z=100*Y*g[U+o]*g[W+o],g[U+t]+=q*z,g[U+r]+=V*z,g[W+t]-=q*z,g[W+r]-=V*z)):(M=Math.sqrt(q*q+V*V),M>0&&(z=Y*g[U+o]*g[W+o]/M/M,g[U+t]+=q*z,g[U+r]+=V*z,g[W+t]-=q*z,g[W+r]-=V*z));for(N=P.gravity/P.scalingRatio,Y=P.scalingRatio,y=0;y<ee;y+=T)z=0,q=g[y+i],V=g[y+e],M=Math.sqrt(Math.pow(q,2)+Math.pow(V,2)),P.strongGravityMode?M>0&&(z=Y*g[y+o]*N):M>0&&(z=Y*g[y+o]*N/M),g[y+t]-=q*z,g[y+r]-=V*z;for(Y=1*(P.outboundAttractionDistribution?ge:1),ne=0;ne<Ee;ne+=O)U=K[ne+h],W=K[ne+l],X=K[ne+f],re=Math.pow(X,P.edgeWeightInfluence),q=g[U+i]-g[W+i],V=g[U+e]-g[W+e],ye===!0?(M=Math.sqrt(q*q+V*V)-g[U+u]-g[W+u],P.linLogMode?P.outboundAttractionDistribution?M>0&&(z=-Y*re*Math.log(1+M)/M/g[U+o]):M>0&&(z=-Y*re*Math.log(1+M)/M):P.outboundAttractionDistribution?M>0&&(z=-Y*re/g[U+o]):M>0&&(z=-Y*re)):(M=Math.sqrt(Math.pow(q,2)+Math.pow(V,2)),P.linLogMode?P.outboundAttractionDistribution?M>0&&(z=-Y*re*Math.log(1+M)/M/g[U+o]):M>0&&(z=-Y*re*Math.log(1+M)/M):P.outboundAttractionDistribution?(M=1,z=-Y*re/g[U+o]):(M=1,z=-Y*re)),M>0&&(g[U+t]+=q*z,g[U+r]+=V*z,g[W+t]-=q*z,g[W+r]-=V*z);var He,$e,We,je,st,ut;if(ye===!0)for(y=0;y<ee;y+=T)g[y+d]!==1&&(He=Math.sqrt(Math.pow(g[y+t],2)+Math.pow(g[y+r],2)),He>k&&(g[y+t]=g[y+t]*k/He,g[y+r]=g[y+r]*k/He),$e=g[y+o]*Math.sqrt((g[y+n]-g[y+t])*(g[y+n]-g[y+t])+(g[y+a]-g[y+r])*(g[y+a]-g[y+r])),We=Math.sqrt((g[y+n]+g[y+t])*(g[y+n]+g[y+t])+(g[y+a]+g[y+r])*(g[y+a]+g[y+r]))/2,je=.1*Math.log(1+We)/(1+Math.sqrt($e)),st=g[y+i]+g[y+t]*(je/P.slowDown),g[y+i]=st,ut=g[y+e]+g[y+r]*(je/P.slowDown),g[y+e]=ut);else for(y=0;y<ee;y+=T)g[y+d]!==1&&($e=g[y+o]*Math.sqrt((g[y+n]-g[y+t])*(g[y+n]-g[y+t])+(g[y+a]-g[y+r])*(g[y+a]-g[y+r])),We=Math.sqrt((g[y+n]+g[y+t])*(g[y+n]+g[y+t])+(g[y+a]+g[y+r])*(g[y+a]+g[y+r]))/2,je=g[y+s]*Math.log(1+We)/(1+Math.sqrt($e)),g[y+s]=Math.min(1,Math.sqrt(je*(Math.pow(g[y+t],2)+Math.pow(g[y+r],2))/(1+Math.sqrt($e)))),st=g[y+i]+g[y+t]*(je/P.slowDown),g[y+i]=st,ut=g[y+e]+g[y+r]*(je/P.slowDown),g[y+e]=ut);return{}},gr}var Ve={},gi;function wo(){if(gi)return Ve;gi=1;var i=10,e=3;return Ve.assign=function(t){t=t||{};var r=Array.prototype.slice.call(arguments).slice(1),n,a,o;for(n=0,o=r.length;n<o;n++)if(r[n])for(a in r[n])t[a]=r[n][a];return t},Ve.validateSettings=function(t){return"linLogMode"in t&&typeof t.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in t&&typeof t.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in t&&typeof t.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in t&&typeof t.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in t&&!(typeof t.scalingRatio=="number"&&t.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in t&&typeof t.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in t&&!(typeof t.gravity=="number"&&t.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in t&&!(typeof t.slowDown=="number"||t.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in t&&typeof t.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in t&&!(typeof t.barnesHutTheta=="number"&&t.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null},Ve.graphToByteArrays=function(t,r){var n=t.order,a=t.size,o={},s,u=new Float32Array(n*i),d=new Float32Array(a*e);return s=0,t.forEachNode(function(h,l){o[h]=s,u[s]=l.x,u[s+1]=l.y,u[s+2]=0,u[s+3]=0,u[s+4]=0,u[s+5]=0,u[s+6]=1,u[s+7]=1,u[s+8]=l.size||1,u[s+9]=l.fixed?1:0,s+=i}),s=0,t.forEachEdge(function(h,l,f,p,v,m,E){var C=o[f],_=o[p],A=r(h,l,f,p,v,m,E);u[C+6]+=A,u[_+6]+=A,d[s]=C,d[s+1]=_,d[s+2]=A,s+=e}),{nodes:u,edges:d}},Ve.assignLayoutChanges=function(t,r,n){var a=0;t.updateEachNodeAttributes(function(o,s){return s.x=r[a],s.y=r[a+1],a+=i,n?n(o,s):s})},Ve.readGraphPositions=function(t,r){var n=0;t.forEachNode(function(a,o){r[n]=o.x,r[n+1]=o.y,n+=i})},Ve.collectLayoutChanges=function(t,r,n){for(var a=t.nodes(),o={},s=0,u=0,d=r.length;s<d;s+=i){if(n){var h=Object.assign({},t.getNodeAttributes(a[u]));h.x=r[s],h.y=r[s+1],h=n(a[u],h),o[a[u]]={x:h.x,y:h.y}}else o[a[u]]={x:r[s],y:r[s+1]};u++}return o},Ve.createWorker=function(r){var n=window.URL||window.webkitURL,a=r.toString(),o=n.createObjectURL(new Blob(["("+a+").call(this);"],{type:"text/javascript"})),s=new Worker(o);return n.revokeObjectURL(o),s},Ve}var vr,vi;function Eo(){return vi||(vi=1,vr={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5}),vr}var mr,mi;function _o(){if(mi)return mr;mi=1;var i=Kr(),e=yo().createEdgeWeightGetter,t=bo(),r=wo(),n=Eo();function a(u,d,h){if(!i(d))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof h=="number"&&(h={iterations:h});var l=h.iterations;if(typeof l!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(l<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var f=e("getEdgeWeight"in h?h.getEdgeWeight:"weight").fromEntry,p=typeof h.outputReducer=="function"?h.outputReducer:null,v=r.assign({},n,h.settings),m=r.validateSettings(v);if(m)throw new Error("graphology-layout-forceatlas2: "+m.message);var E=r.graphToByteArrays(d,f),C;for(C=0;C<l;C++)t(v,E.nodes,E.edges);if(u){r.assignLayoutChanges(d,E.nodes,p);return}return r.collectLayoutChanges(d,E.nodes)}function o(u){var d=typeof u=="number"?u:u.order;return{barnesHutOptimize:d>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(d)}}var s=a.bind(null,!1);return s.assign=a.bind(null,!0),s.inferSettings=o,mr=s,mr}var To=_o();const Ao=Br(To);var yr,yi;function Ro(){if(yi)return yr;yi=1;var i=0,e=1,t=2,r=3;function n(o,s){return o+"§"+s}function a(){return .01*(.5-Math.random())}return yr=function(s,u){var d=s.margin,h=s.ratio,l=s.expansion,f=s.gridSize,p=s.speed,v,m,E,C,_,A,c=!0,w=u.length,b=w/r|0,T=new Float32Array(b),O=new Float32Array(b),L=1/0,k=1/0,B=-1/0,P=-1/0;for(v=0;v<w;v+=r)E=u[v+i],C=u[v+e],A=u[v+t]*h+d,L=Math.min(L,E-A),B=Math.max(B,E+A),k=Math.min(k,C-A),P=Math.max(P,C+A);var g=B-L,K=P-k,J=(L+B)/2,x=(k+P)/2;L=J-l*g/2,B=J+l*g/2,k=x-l*K/2,P=x+l*K/2;var y=new Array(f*f),U=y.length,W;for(W=0;W<U;W++)y[W]=[];var Q,ne,X,N,ue,ee,Ee,ye,pe,ge;for(v=0;v<w;v+=r)for(E=u[v+i],C=u[v+e],A=u[v+t]*h+d,Q=E-A,ne=E+A,X=C-A,N=C+A,ue=Math.floor(f*(Q-L)/(B-L)),ee=Math.floor(f*(ne-L)/(B-L)),Ee=Math.floor(f*(X-k)/(P-k)),ye=Math.floor(f*(N-k)/(P-k)),pe=ue;pe<=ee;pe++)for(ge=Ee;ge<=ye;ge++)y[pe*f+ge].push(v);var Y,q=new Set,V,re,M,z,R,ve,me,be,oe,ae,de,he,Ae;for(W=0;W<U;W++)for(Y=y[W],v=0,_=Y.length;v<_;v++)for(V=Y[v],M=u[V+i],R=u[V+e],me=u[V+t],m=v+1;m<_;m++)re=Y[m],oe=n(V,re),!(U>1&&q.has(oe))&&(U>1&&q.add(oe),z=u[re+i],ve=u[re+e],be=u[re+t],ae=z-M,de=ve-R,he=Math.sqrt(ae*ae+de*de),Ae=he<me*h+d+(be*h+d),Ae&&(c=!1,re=re/r|0,he>0?(T[re]+=ae/he*(1+me),O[re]+=de/he*(1+me)):(T[re]+=g*a(),O[re]+=K*a())));for(v=0,m=0;v<w;v+=r,m++)u[v+i]+=T[m]*.1*p,u[v+e]+=O[m]*.1*p;return{converged:c}},yr}var rt={},bi;function So(){if(bi)return rt;bi=1;var i=3;return rt.validateSettings=function(e){return"gridSize"in e&&typeof e.gridSize!="number"||e.gridSize<=0?{message:"the `gridSize` setting should be a positive number."}:"margin"in e&&typeof e.margin!="number"||e.margin<0?{message:"the `margin` setting should be 0 or a positive number."}:"expansion"in e&&typeof e.expansion!="number"||e.expansion<=0?{message:"the `expansion` setting should be a positive number."}:"ratio"in e&&typeof e.ratio!="number"||e.ratio<=0?{message:"the `ratio` setting should be a positive number."}:"speed"in e&&typeof e.speed!="number"||e.speed<=0?{message:"the `speed` setting should be a positive number."}:null},rt.graphToByteArray=function(e,t){var r=e.order,n=new Float32Array(r*i),a=0;return e.forEachNode(function(o,s){typeof t=="function"&&(s=t(o,s)),n[a]=s.x,n[a+1]=s.y,n[a+2]=s.size||1,a+=i}),n},rt.assignLayoutChanges=function(e,t,r){var n=0;e.forEachNode(function(a){var o={x:t[n],y:t[n+1]};typeof r=="function"&&(o=r(a,o)),e.mergeNodeAttributes(a,o),n+=i})},rt.collectLayoutChanges=function(e,t,r){var n={},a=0;return e.forEachNode(function(o){var s={x:t[a],y:t[a+1]};typeof r=="function"&&(s=r(o,s)),n[o]=s,a+=i}),n},rt.createWorker=function(t){var r=window.URL||window.webkitURL,n=t.toString(),a=r.createObjectURL(new Blob(["("+n+").call(this);"],{type:"text/javascript"})),o=new Worker(a);return r.revokeObjectURL(a),o},rt}var br,wi;function Co(){return wi||(wi=1,br={gridSize:20,margin:5,expansion:1.1,ratio:1,speed:3}),br}var wr,Ei;function xo(){if(Ei)return wr;Ei=1;var i=Kr(),e=Ro(),t=So(),r=Co(),n=500;function a(s,u,d){if(!i(u))throw new Error("graphology-layout-noverlap: the given graph is not a valid graphology instance.");typeof d=="number"?d={maxIterations:d}:d=d||{};var h=d.maxIterations||n;if(typeof h!="number"||h<=0)throw new Error("graphology-layout-force: you should provide a positive number of maximum iterations.");var l=Object.assign({},r,d.settings),f=t.validateSettings(l);if(f)throw new Error("graphology-layout-noverlap: "+f.message);var p=t.graphToByteArray(u,d.inputReducer),v=!1,m;for(m=0;m<h&&!v;m++)v=e(l,p).converged;if(s){t.assignLayoutChanges(u,p,d.outputReducer);return}return t.collectLayoutChanges(u,p,d.outputReducer)}var o=a.bind(null,!1);return o.assign=a.bind(null,!0),wr=o,wr}var Do=xo();const _i=Br(Do);function Lo(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function Ot(i){var e=Lo(i,"string");return typeof e=="symbol"?e:e+""}function le(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Ti(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,Ot(r.key),r)}}function fe(i,e,t){return e&&Ti(i.prototype,e),t&&Ti(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function gt(i){return gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gt(i)}function An(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(An=function(){return!!i})()}function ko(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Go(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ko(i)}function Se(i,e,t){return e=gt(e),Go(i,An()?Reflect.construct(e,t||[],gt(i).constructor):e.apply(i,t))}function Or(i,e){return Or=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Or(i,e)}function Ce(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Or(i,e)}function Oo(i){if(Array.isArray(i))return i}function Po(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var r,n,a,o,s=[],u=!0,d=!1;try{if(a=(t=t.call(i)).next,e===0){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=a.call(t)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(h){d=!0,n=h}finally{try{if(!u&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(d)throw n}}return s}}function Pr(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,r=Array(e);t<e;t++)r[t]=i[t];return r}function Rn(i,e){if(i){if(typeof i=="string")return Pr(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Pr(i,e):void 0}}function Fo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vt(i,e){return Oo(i)||Po(i,e)||Rn(i,e)||Fo()}var Er={black:"#000000",silver:"#C0C0C0",gray:"#808080",grey:"#808080",white:"#FFFFFF",maroon:"#800000",red:"#FF0000",purple:"#800080",fuchsia:"#FF00FF",green:"#008000",lime:"#00FF00",olive:"#808000",yellow:"#FFFF00",navy:"#000080",blue:"#0000FF",teal:"#008080",aqua:"#00FFFF",darkblue:"#00008B",mediumblue:"#0000CD",darkgreen:"#006400",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",springgreen:"#00FF7F",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",rebeccapurple:"#663399",mediumaquamarine:"#66CDAA",dimgray:"#696969",dimgrey:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",slategrey:"#708090",lightslategray:"#778899",lightslategrey:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370DB",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",palevioletred:"#DB7093",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",lightyellow:"#FFFFE0",ivory:"#FFFFF0"},Sn=new Int8Array(4),_r=new Int32Array(Sn.buffer,0,1),No=new Float32Array(Sn.buffer,0,1),Io=/^\s*rgba?\s*\(/,$o=/^\s*rgba?\s*\(\s*([0-9]*)\s*,\s*([0-9]*)\s*,\s*([0-9]*)(?:\s*,\s*(.*)?)?\)\s*$/;function zo(i){var e=0,t=0,r=0,n=1;if(i[0]==="#")i.length===4?(e=parseInt(i.charAt(1)+i.charAt(1),16),t=parseInt(i.charAt(2)+i.charAt(2),16),r=parseInt(i.charAt(3)+i.charAt(3),16)):(e=parseInt(i.charAt(1)+i.charAt(2),16),t=parseInt(i.charAt(3)+i.charAt(4),16),r=parseInt(i.charAt(5)+i.charAt(6),16)),i.length===9&&(n=parseInt(i.charAt(7)+i.charAt(8),16)/255);else if(Io.test(i)){var a=i.match($o);a&&(e=+a[1],t=+a[2],r=+a[3],a[4]&&(n=+a[4]))}return{r:e,g:t,b:r,a:n}}var ft={};for(var qt in Er)ft[qt]=At(Er[qt]),ft[Er[qt]]=ft[qt];function Cn(i,e,t,r,n){return _r[0]=r<<24|t<<16|e<<8|i,_r[0]=_r[0]&4278190079,No[0]}function At(i){if(i=i.toLowerCase(),typeof ft[i]<"u")return ft[i];var e=zo(i),t=e.r,r=e.g,n=e.b,a=e.a;a=a*255|0;var o=Cn(t,r,n,a);return ft[i]=o,o}var Tr={};function xn(i){if(typeof Tr[i]<"u")return Tr[i];var e=(i&16711680)>>>16,t=(i&65280)>>>8,r=i&255,n=255,a=Cn(e,t,r,n);return Tr[i]=a,a}function Ai(i,e,t,r){return t+(e<<8)+(i<<16)}function Ri(i,e,t,r,n,a){var o=Math.floor(t/a*n),s=Math.floor(i.drawingBufferHeight/a-r/a*n),u=new Uint8Array(4);i.bindFramebuffer(i.FRAMEBUFFER,e),i.readPixels(o,s,1,1,i.RGBA,i.UNSIGNED_BYTE,u);var d=vt(u,4),h=d[0],l=d[1],f=d[2],p=d[3];return[h,l,f,p]}function D(i,e,t){return(e=Ot(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Si(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,r)}return t}function I(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Si(Object(t),!0).forEach(function(r){D(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Si(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}function Uo(i,e){for(;!{}.hasOwnProperty.call(i,e)&&(i=gt(i))!==null;);return i}function Fr(){return Fr=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(i,e,t){var r=Uo(i,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?i:t):n.value}},Fr.apply(null,arguments)}function Dn(i,e,t,r){var n=Fr(gt(i.prototype),e,t);return typeof n=="function"?function(a){return n.apply(t,a)}:n}function Mo(i){return i.normalized?1:i.size}function Ar(i){var e=0;return i.forEach(function(t){return e+=Mo(t)}),e}function Ln(i,e,t){var r=i==="VERTEX"?e.VERTEX_SHADER:e.FRAGMENT_SHADER,n=e.createShader(r);if(n===null)throw new Error("loadShader: error while creating the shader");e.shaderSource(n,t),e.compileShader(n);var a=e.getShaderParameter(n,e.COMPILE_STATUS);if(!a){var o=e.getShaderInfoLog(n);throw e.deleteShader(n),new Error(`loadShader: error while compiling the shader:
`.concat(o,`
`).concat(t))}return n}function Bo(i,e){return Ln("VERTEX",i,e)}function Ho(i,e){return Ln("FRAGMENT",i,e)}function Wo(i,e){var t=i.createProgram();if(t===null)throw new Error("loadProgram: error while creating the program.");var r,n;for(r=0,n=e.length;r<n;r++)i.attachShader(t,e[r]);i.linkProgram(t);var a=i.getProgramParameter(t,i.LINK_STATUS);if(!a)throw i.deleteProgram(t),new Error("loadProgram: error while linking the program.");return t}function Ci(i){var e=i.gl,t=i.buffer,r=i.program,n=i.vertexShader,a=i.fragmentShader;e.deleteShader(n),e.deleteShader(a),e.deleteProgram(r),e.deleteBuffer(t)}var xi=`#define PICKING_MODE
`,jo=D(D(D(D(D(D(D(D({},WebGL2RenderingContext.BOOL,1),WebGL2RenderingContext.BYTE,1),WebGL2RenderingContext.UNSIGNED_BYTE,1),WebGL2RenderingContext.SHORT,2),WebGL2RenderingContext.UNSIGNED_SHORT,2),WebGL2RenderingContext.INT,4),WebGL2RenderingContext.UNSIGNED_INT,4),WebGL2RenderingContext.FLOAT,4),kn=function(){function i(e,t,r){le(this,i),D(this,"array",new Float32Array),D(this,"constantArray",new Float32Array),D(this,"capacity",0),D(this,"verticesCount",0);var n=this.getDefinition();if(this.VERTICES=n.VERTICES,this.VERTEX_SHADER_SOURCE=n.VERTEX_SHADER_SOURCE,this.FRAGMENT_SHADER_SOURCE=n.FRAGMENT_SHADER_SOURCE,this.UNIFORMS=n.UNIFORMS,this.ATTRIBUTES=n.ATTRIBUTES,this.METHOD=n.METHOD,this.CONSTANT_ATTRIBUTES="CONSTANT_ATTRIBUTES"in n?n.CONSTANT_ATTRIBUTES:[],this.CONSTANT_DATA="CONSTANT_DATA"in n?n.CONSTANT_DATA:[],this.isInstanced="CONSTANT_ATTRIBUTES"in n,this.ATTRIBUTES_ITEMS_COUNT=Ar(this.ATTRIBUTES),this.STRIDE=this.VERTICES*this.ATTRIBUTES_ITEMS_COUNT,this.renderer=r,this.normalProgram=this.getProgramInfo("normal",e,n.VERTEX_SHADER_SOURCE,n.FRAGMENT_SHADER_SOURCE,null),this.pickProgram=t?this.getProgramInfo("pick",e,xi+n.VERTEX_SHADER_SOURCE,xi+n.FRAGMENT_SHADER_SOURCE,t):null,this.isInstanced){var a=Ar(this.CONSTANT_ATTRIBUTES);if(this.CONSTANT_DATA.length!==this.VERTICES)throw new Error("Program: error while getting constant data (expected ".concat(this.VERTICES," items, received ").concat(this.CONSTANT_DATA.length," instead)"));this.constantArray=new Float32Array(this.CONSTANT_DATA.length*a);for(var o=0;o<this.CONSTANT_DATA.length;o++){var s=this.CONSTANT_DATA[o];if(s.length!==a)throw new Error("Program: error while getting constant data (one vector has ".concat(s.length," items instead of ").concat(a,")"));for(var u=0;u<s.length;u++)this.constantArray[o*a+u]=s[u]}this.STRIDE=this.ATTRIBUTES_ITEMS_COUNT}}return fe(i,[{key:"kill",value:function(){Ci(this.normalProgram),this.pickProgram&&(Ci(this.pickProgram),this.pickProgram=null)}},{key:"getProgramInfo",value:function(t,r,n,a,o){var s=this.getDefinition(),u=r.createBuffer();if(u===null)throw new Error("Program: error while creating the WebGL buffer.");var d=Bo(r,n),h=Ho(r,a),l=Wo(r,[d,h]),f={};s.UNIFORMS.forEach(function(m){var E=r.getUniformLocation(l,m);E&&(f[m]=E)});var p={};s.ATTRIBUTES.forEach(function(m){p[m.name]=r.getAttribLocation(l,m.name)});var v;if("CONSTANT_ATTRIBUTES"in s&&(s.CONSTANT_ATTRIBUTES.forEach(function(m){p[m.name]=r.getAttribLocation(l,m.name)}),v=r.createBuffer(),v===null))throw new Error("Program: error while creating the WebGL constant buffer.");return{name:t,program:l,gl:r,frameBuffer:o,buffer:u,constantBuffer:v||{},uniformLocations:f,attributeLocations:p,isPicking:t==="pick",vertexShader:d,fragmentShader:h}}},{key:"bindProgram",value:function(t){var r=this,n=0,a=t.gl,o=t.buffer;this.isInstanced?(a.bindBuffer(a.ARRAY_BUFFER,t.constantBuffer),n=0,this.CONSTANT_ATTRIBUTES.forEach(function(s){return n+=r.bindAttribute(s,t,n,!1)}),a.bufferData(a.ARRAY_BUFFER,this.constantArray,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,t.buffer),n=0,this.ATTRIBUTES.forEach(function(s){return n+=r.bindAttribute(s,t,n,!0)}),a.bufferData(a.ARRAY_BUFFER,this.array,a.DYNAMIC_DRAW)):(a.bindBuffer(a.ARRAY_BUFFER,o),n=0,this.ATTRIBUTES.forEach(function(s){return n+=r.bindAttribute(s,t,n)}),a.bufferData(a.ARRAY_BUFFER,this.array,a.DYNAMIC_DRAW)),a.bindBuffer(a.ARRAY_BUFFER,null)}},{key:"unbindProgram",value:function(t){var r=this;this.isInstanced?(this.CONSTANT_ATTRIBUTES.forEach(function(n){return r.unbindAttribute(n,t,!1)}),this.ATTRIBUTES.forEach(function(n){return r.unbindAttribute(n,t,!0)})):this.ATTRIBUTES.forEach(function(n){return r.unbindAttribute(n,t)})}},{key:"bindAttribute",value:function(t,r,n,a){var o=jo[t.type];if(typeof o!="number")throw new Error('Program.bind: yet unsupported attribute type "'.concat(t.type,'"'));var s=r.attributeLocations[t.name],u=r.gl;if(s!==-1){u.enableVertexAttribArray(s);var d=this.isInstanced?(a?this.ATTRIBUTES_ITEMS_COUNT:Ar(this.CONSTANT_ATTRIBUTES))*Float32Array.BYTES_PER_ELEMENT:this.ATTRIBUTES_ITEMS_COUNT*Float32Array.BYTES_PER_ELEMENT;if(u.vertexAttribPointer(s,t.size,t.type,t.normalized||!1,d,n),this.isInstanced&&a)if(u instanceof WebGL2RenderingContext)u.vertexAttribDivisor(s,1);else{var h=u.getExtension("ANGLE_instanced_arrays");h&&h.vertexAttribDivisorANGLE(s,1)}}return t.size*o}},{key:"unbindAttribute",value:function(t,r,n){var a=r.attributeLocations[t.name],o=r.gl;if(a!==-1&&(o.disableVertexAttribArray(a),this.isInstanced&&n))if(o instanceof WebGL2RenderingContext)o.vertexAttribDivisor(a,0);else{var s=o.getExtension("ANGLE_instanced_arrays");s&&s.vertexAttribDivisorANGLE(a,0)}}},{key:"reallocate",value:function(t){t!==this.capacity&&(this.capacity=t,this.verticesCount=this.VERTICES*t,this.array=new Float32Array(this.isInstanced?this.capacity*this.ATTRIBUTES_ITEMS_COUNT:this.verticesCount*this.ATTRIBUTES_ITEMS_COUNT))}},{key:"hasNothingToRender",value:function(){return this.verticesCount===0}},{key:"renderProgram",value:function(t,r){var n=r.gl,a=r.program;n.enable(n.BLEND),n.useProgram(a),this.setUniforms(t,r),this.drawWebGL(this.METHOD,r)}},{key:"render",value:function(t){this.hasNothingToRender()||(this.pickProgram&&(this.pickProgram.gl.viewport(0,0,t.width*t.pixelRatio/t.downSizingRatio,t.height*t.pixelRatio/t.downSizingRatio),this.bindProgram(this.pickProgram),this.renderProgram(I(I({},t),{},{pixelRatio:t.pixelRatio/t.downSizingRatio}),this.pickProgram),this.unbindProgram(this.pickProgram)),this.normalProgram.gl.viewport(0,0,t.width*t.pixelRatio,t.height*t.pixelRatio),this.bindProgram(this.normalProgram),this.renderProgram(t,this.normalProgram),this.unbindProgram(this.normalProgram))}},{key:"drawWebGL",value:function(t,r){var n=r.gl,a=r.frameBuffer;if(n.bindFramebuffer(n.FRAMEBUFFER,a),!this.isInstanced)n.drawArrays(t,0,this.verticesCount);else if(n instanceof WebGL2RenderingContext)n.drawArraysInstanced(t,0,this.VERTICES,this.capacity);else{var o=n.getExtension("ANGLE_instanced_arrays");o&&o.drawArraysInstancedANGLE(t,0,this.VERTICES,this.capacity)}}}])}(),Vo=function(i){function e(){return le(this,e),Se(this,e,arguments)}return Ce(e,i),fe(e,[{key:"kill",value:function(){Dn(e,"kill",this)([])}},{key:"process",value:function(r,n,a){var o=n*this.STRIDE;if(a.hidden){for(var s=o+this.STRIDE;o<s;o++)this.array[o]=0;return}return this.processVisibleItem(xn(r),o,a)}}])}(kn),sr=function(i){function e(){var t;le(this,e);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t=Se(this,e,[].concat(n)),D(t,"drawLabel",void 0),t}return Ce(e,i),fe(e,[{key:"kill",value:function(){Dn(e,"kill",this)([])}},{key:"process",value:function(r,n,a,o,s){var u=n*this.STRIDE;if(s.hidden||a.hidden||o.hidden){for(var d=u+this.STRIDE;u<d;u++)this.array[u]=0;return}return this.processVisibleItem(xn(r),u,a,o,s)}}])}(kn);function Gn(i,e){return function(){function t(r,n,a){le(this,t),D(this,"drawLabel",e),this.programs=i.map(function(o){return new o(r,n,a)})}return fe(t,[{key:"reallocate",value:function(n){this.programs.forEach(function(a){return a.reallocate(n)})}},{key:"process",value:function(n,a,o,s,u){this.programs.forEach(function(d){return d.process(n,a,o,s,u)})}},{key:"render",value:function(n){this.programs.forEach(function(a){return a.render(n)})}},{key:"kill",value:function(){this.programs.forEach(function(n){return n.kill()})}}])}()}function qo(i,e,t,r,n){var a=n.edgeLabelSize,o=n.edgeLabelFont,s=n.edgeLabelWeight,u=n.edgeLabelColor.attribute?e[n.edgeLabelColor.attribute]||n.edgeLabelColor.color||"#000":n.edgeLabelColor.color,d=e.label;if(d){i.fillStyle=u,i.font="".concat(s," ").concat(a,"px ").concat(o);var h=t.size,l=r.size,f=t.x,p=t.y,v=r.x,m=r.y,E=(f+v)/2,C=(p+m)/2,_=v-f,A=m-p,c=Math.sqrt(_*_+A*A);if(!(c<h+l)){f+=_*h/c,p+=A*h/c,v-=_*l/c,m-=A*l/c,E=(f+v)/2,C=(p+m)/2,_=v-f,A=m-p,c=Math.sqrt(_*_+A*A);var w=i.measureText(d).width;if(w>c){var b="…";for(d=d+b,w=i.measureText(d).width;w>c&&d.length>1;)d=d.slice(0,-2)+b,w=i.measureText(d).width;if(d.length<4)return}var T;_>0?A>0?T=Math.acos(_/c):T=Math.asin(A/c):A>0?T=Math.acos(_/c)+Math.PI:T=Math.asin(_/c)+Math.PI/2,i.save(),i.translate(E,C),i.rotate(T),i.fillText(d,-w/2,e.size/2+a),i.restore()}}}function On(i,e,t){if(e.label){var r=t.labelSize,n=t.labelFont,a=t.labelWeight,o=t.labelColor.attribute?e[t.labelColor.attribute]||t.labelColor.color||"#000":t.labelColor.color;i.fillStyle=o,i.font="".concat(a," ").concat(r,"px ").concat(n),i.fillText(e.label,e.x+e.size+3,e.y+r/3)}}function Ko(i,e,t){var r=t.labelSize,n=t.labelFont,a=t.labelWeight;i.font="".concat(a," ").concat(r,"px ").concat(n),i.fillStyle="#FFF",i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=8,i.shadowColor="#000";var o=2;if(typeof e.label=="string"){var s=i.measureText(e.label).width,u=Math.round(s+5),d=Math.round(r+2*o),h=Math.max(e.size,r/2)+o,l=Math.asin(d/2/h),f=Math.sqrt(Math.abs(Math.pow(h,2)-Math.pow(d/2,2)));i.beginPath(),i.moveTo(e.x+f,e.y+d/2),i.lineTo(e.x+h+u,e.y+d/2),i.lineTo(e.x+h+u,e.y-d/2),i.lineTo(e.x+f,e.y-d/2),i.arc(e.x,e.y,h,l,-l),i.closePath(),i.fill()}else i.beginPath(),i.arc(e.x,e.y,e.size+o,0,Math.PI*2),i.closePath(),i.fill();i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=0,On(i,e,t)}var Yo=`
precision highp float;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;

uniform float u_correctionRatio;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float border = u_correctionRatio * 2.0;
  float dist = length(v_diffVector) - v_radius + border;

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
  if (dist > border)
    gl_FragColor = transparent;
  else
    gl_FragColor = v_color;

  #else
  float t = 0.0;
  if (dist > border)
    t = 1.0;
  else if (dist > 0.0)
    t = dist / border;

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,Xo=Yo,Zo=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;
varying float v_border;

const float bias = 255.0 / 254.0;

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Jo=Zo,Pn=WebGLRenderingContext,Di=Pn.UNSIGNED_BYTE,Rr=Pn.FLOAT,Qo=["u_sizeRatio","u_correctionRatio","u_matrix"],zt=function(i){function e(){return le(this,e),Se(this,e,arguments)}return Ce(e,i),fe(e,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:Jo,FRAGMENT_SHADER_SOURCE:Xo,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Qo,ATTRIBUTES:[{name:"a_position",size:2,type:Rr},{name:"a_size",size:1,type:Rr},{name:"a_color",size:4,type:Di,normalized:!0},{name:"a_id",size:4,type:Di,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:Rr}],CONSTANT_DATA:[[e.ANGLE_1],[e.ANGLE_2],[e.ANGLE_3]]}}},{key:"processVisibleItem",value:function(r,n,a){var o=this.array,s=At(a.color);o[n++]=a.x,o[n++]=a.y,o[n++]=a.size,o[n++]=s,o[n++]=r}},{key:"setUniforms",value:function(r,n){var a=n.gl,o=n.uniformLocations,s=o.u_sizeRatio,u=o.u_correctionRatio,d=o.u_matrix;a.uniform1f(u,r.correctionRatio),a.uniform1f(s,r.sizeRatio),a.uniformMatrix3fv(d,!1,r.matrix)}}])}(Vo);D(zt,"ANGLE_1",0);D(zt,"ANGLE_2",2*Math.PI/3);D(zt,"ANGLE_3",4*Math.PI/3);var es=`
precision mediump float;

varying vec4 v_color;

void main(void) {
  gl_FragColor = v_color;
}
`,ts=es,rs=`
attribute vec2 a_position;
attribute vec2 a_normal;
attribute float a_radius;
attribute vec3 a_barycentric;

#ifdef PICKING_MODE
attribute vec4 a_id;
#else
attribute vec4 a_color;
#endif

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_widenessToThicknessRatio;

varying vec4 v_color;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // These first computations are taken from edge.vert.glsl and
  // edge.clamped.vert.glsl. Please read it to get better comments on what's
  // happening:
  float pixelsThickness = max(normalLength / u_sizeRatio, minThickness);
  float webGLThickness = pixelsThickness * u_correctionRatio;
  float webGLNodeRadius = a_radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  float webGLArrowHeadThickness = webGLThickness * u_widenessToThicknessRatio;

  float da = a_barycentric.x;
  float db = a_barycentric.y;
  float dc = a_barycentric.z;

  vec2 delta = vec2(
      da * (webGLNodeRadius * unitNormal.y)
    + db * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y + webGLArrowHeadThickness * unitNormal.x)
    + dc * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y - webGLArrowHeadThickness * unitNormal.x),

      da * (-webGLNodeRadius * unitNormal.x)
    + db * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x + webGLArrowHeadThickness * unitNormal.y)
    + dc * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x - webGLArrowHeadThickness * unitNormal.y)
  );

  vec2 position = (u_matrix * vec3(a_position + delta, 1)).xy;

  gl_Position = vec4(position, 0, 1);

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,is=rs,Fn=WebGLRenderingContext,Li=Fn.UNSIGNED_BYTE,Kt=Fn.FLOAT,ns=["u_matrix","u_sizeRatio","u_correctionRatio","u_minEdgeThickness","u_lengthToThicknessRatio","u_widenessToThicknessRatio"],Yr={extremity:"target",lengthToThicknessRatio:2.5,widenessToThicknessRatio:2};function tr(i){var e=I(I({},Yr),i||{});return function(t){function r(){return le(this,r),Se(this,r,arguments)}return Ce(r,t),fe(r,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:is,FRAGMENT_SHADER_SOURCE:ts,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:ns,ATTRIBUTES:[{name:"a_position",size:2,type:Kt},{name:"a_normal",size:2,type:Kt},{name:"a_radius",size:1,type:Kt},{name:"a_color",size:4,type:Li,normalized:!0},{name:"a_id",size:4,type:Li,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_barycentric",size:3,type:Kt}],CONSTANT_DATA:[[1,0,0],[0,1,0],[0,0,1]]}}},{key:"processVisibleItem",value:function(a,o,s,u,d){if(e.extremity==="source"){var h=[u,s];s=h[0],u=h[1]}var l=d.size||1,f=u.size||1,p=s.x,v=s.y,m=u.x,E=u.y,C=At(d.color),_=m-p,A=E-v,c=_*_+A*A,w=0,b=0;c&&(c=1/Math.sqrt(c),w=-A*c*l,b=_*c*l);var T=this.array;T[o++]=m,T[o++]=E,T[o++]=-w,T[o++]=-b,T[o++]=f,T[o++]=C,T[o++]=a}},{key:"setUniforms",value:function(a,o){var s=o.gl,u=o.uniformLocations,d=u.u_matrix,h=u.u_sizeRatio,l=u.u_correctionRatio,f=u.u_minEdgeThickness,p=u.u_lengthToThicknessRatio,v=u.u_widenessToThicknessRatio;s.uniformMatrix3fv(d,!1,a.matrix),s.uniform1f(h,a.sizeRatio),s.uniform1f(l,a.correctionRatio),s.uniform1f(f,a.minEdgeThickness),s.uniform1f(p,e.lengthToThicknessRatio),s.uniform1f(v,e.widenessToThicknessRatio)}}])}(sr)}tr();var as=`
precision mediump float;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  // We only handle antialiasing for normal mode:
  #ifdef PICKING_MODE
  gl_FragColor = v_color;
  #else
  float dist = length(v_normal) * v_thickness;

  float t = smoothstep(
    v_thickness - v_feather,
    v_thickness,
    dist
  );

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,Xr=as,os=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;
attribute float a_radius;
attribute float a_radiusCoef;

uniform mat3 u_matrix;
uniform float u_zoomRatio;
uniform float u_sizeRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float radius = a_radius * a_radiusCoef;
  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // These first computations are taken from edge.vert.glsl. Please read it to
  // get better comments on what's happening:
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here, we move the point to leave space for the arrow head:
  float direction = sign(radius);
  float webGLNodeRadius = direction * radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;

  vec2 compensationVector = vec2(-direction * unitNormal.y, direction * unitNormal.x) * (webGLNodeRadius + webGLArrowHeadLength);

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness + compensationVector, 1)).xy, 0, 1);

  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,ss=os,Nn=WebGLRenderingContext,ki=Nn.UNSIGNED_BYTE,it=Nn.FLOAT,us=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness","u_lengthToThicknessRatio"],ds={lengthToThicknessRatio:Yr.lengthToThicknessRatio};function In(i){var e=I(I({},ds),{});return function(t){function r(){return le(this,r),Se(this,r,arguments)}return Ce(r,t),fe(r,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:ss,FRAGMENT_SHADER_SOURCE:Xr,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:us,ATTRIBUTES:[{name:"a_positionStart",size:2,type:it},{name:"a_positionEnd",size:2,type:it},{name:"a_normal",size:2,type:it},{name:"a_color",size:4,type:ki,normalized:!0},{name:"a_id",size:4,type:ki,normalized:!0},{name:"a_radius",size:1,type:it}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:it},{name:"a_normalCoef",size:1,type:it},{name:"a_radiusCoef",size:1,type:it}],CONSTANT_DATA:[[0,1,0],[0,-1,0],[1,1,1],[1,1,1],[0,-1,0],[1,-1,-1]]}}},{key:"processVisibleItem",value:function(a,o,s,u,d){var h=d.size||1,l=s.x,f=s.y,p=u.x,v=u.y,m=At(d.color),E=p-l,C=v-f,_=u.size||1,A=E*E+C*C,c=0,w=0;A&&(A=1/Math.sqrt(A),c=-C*A*h,w=E*A*h);var b=this.array;b[o++]=l,b[o++]=f,b[o++]=p,b[o++]=v,b[o++]=c,b[o++]=w,b[o++]=m,b[o++]=a,b[o++]=_}},{key:"setUniforms",value:function(a,o){var s=o.gl,u=o.uniformLocations,d=u.u_matrix,h=u.u_zoomRatio,l=u.u_feather,f=u.u_pixelRatio,p=u.u_correctionRatio,v=u.u_sizeRatio,m=u.u_minEdgeThickness,E=u.u_lengthToThicknessRatio;s.uniformMatrix3fv(d,!1,a.matrix),s.uniform1f(h,a.zoomRatio),s.uniform1f(v,a.sizeRatio),s.uniform1f(p,a.correctionRatio),s.uniform1f(f,a.pixelRatio),s.uniform1f(l,a.antiAliasingFeather),s.uniform1f(m,a.minEdgeThickness),s.uniform1f(E,e.lengthToThicknessRatio)}}])}(sr)}In();function hs(i){return Gn([In(),tr(i)])}var cs=hs(),$n=cs,ls=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_zoomRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // We require edges to be at least "minThickness" pixels thick *on screen*
  // (so we need to compensate the size ratio):
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);

  // Then, we need to retrieve the normalized thickness of the edge in the WebGL
  // referential (in a ([0, 1], [0, 1]) space), using our "magic" correction
  // ratio:
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness, 1)).xy, 0, 1);

  // For the fragment shader though, we need a thickness that takes the "magic"
  // correction ratio into account (as in webGLThickness), but so that the
  // antialiasing effect does not depend on the zoom level. So here's yet
  // another thickness version:
  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,fs=ls,zn=WebGLRenderingContext,Gi=zn.UNSIGNED_BYTE,xt=zn.FLOAT,ps=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness"],gs=function(i){function e(){return le(this,e),Se(this,e,arguments)}return Ce(e,i),fe(e,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:fs,FRAGMENT_SHADER_SOURCE:Xr,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:ps,ATTRIBUTES:[{name:"a_positionStart",size:2,type:xt},{name:"a_positionEnd",size:2,type:xt},{name:"a_normal",size:2,type:xt},{name:"a_color",size:4,type:Gi,normalized:!0},{name:"a_id",size:4,type:Gi,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:xt},{name:"a_normalCoef",size:1,type:xt}],CONSTANT_DATA:[[0,1],[0,-1],[1,1],[1,1],[0,-1],[1,-1]]}}},{key:"processVisibleItem",value:function(r,n,a,o,s){var u=s.size||1,d=a.x,h=a.y,l=o.x,f=o.y,p=At(s.color),v=l-d,m=f-h,E=v*v+m*m,C=0,_=0;E&&(E=1/Math.sqrt(E),C=-m*E*u,_=v*E*u);var A=this.array;A[n++]=d,A[n++]=h,A[n++]=l,A[n++]=f,A[n++]=C,A[n++]=_,A[n++]=p,A[n++]=r}},{key:"setUniforms",value:function(r,n){var a=n.gl,o=n.uniformLocations,s=o.u_matrix,u=o.u_zoomRatio,d=o.u_feather,h=o.u_pixelRatio,l=o.u_correctionRatio,f=o.u_sizeRatio,p=o.u_minEdgeThickness;a.uniformMatrix3fv(s,!1,r.matrix),a.uniform1f(u,r.zoomRatio),a.uniform1f(f,r.sizeRatio),a.uniform1f(l,r.correctionRatio),a.uniform1f(h,r.pixelRatio),a.uniform1f(d,r.antiAliasingFeather),a.uniform1f(p,r.minEdgeThickness)}}])}(sr),Zr=function(i){function e(){var t;return le(this,e),t=Se(this,e),t.rawEmitter=t,t}return Ce(e,i),fe(e)}(hn.EventEmitter),vs=Kr();const ms=Br(vs);var ys=function(e){return e},bs=function(e){return e*e},ws=function(e){return e*(2-e)},Es=function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},_s=function(e){return e*e*e},Ts=function(e){return--e*e*e+1},As=function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},Rs={linear:ys,quadraticIn:bs,quadraticOut:ws,quadraticInOut:Es,cubicIn:_s,cubicOut:Ts,cubicInOut:As},Ss={easing:"quadraticInOut",duration:150};function Fe(){return Float32Array.of(1,0,0,0,1,0,0,0,1)}function Yt(i,e,t){return i[0]=e,i[4]=typeof t=="number"?t:e,i}function Oi(i,e){var t=Math.sin(e),r=Math.cos(e);return i[0]=r,i[1]=t,i[3]=-t,i[4]=r,i}function Pi(i,e,t){return i[6]=e,i[7]=t,i}function Qe(i,e){var t=i[0],r=i[1],n=i[2],a=i[3],o=i[4],s=i[5],u=i[6],d=i[7],h=i[8],l=e[0],f=e[1],p=e[2],v=e[3],m=e[4],E=e[5],C=e[6],_=e[7],A=e[8];return i[0]=l*t+f*a+p*u,i[1]=l*r+f*o+p*d,i[2]=l*n+f*s+p*h,i[3]=v*t+m*a+E*u,i[4]=v*r+m*o+E*d,i[5]=v*n+m*s+E*h,i[6]=C*t+_*a+A*u,i[7]=C*r+_*o+A*d,i[8]=C*n+_*s+A*h,i}function Nr(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=i[0],n=i[1],a=i[3],o=i[4],s=i[6],u=i[7],d=e.x,h=e.y;return{x:d*r+h*a+s*t,y:d*n+h*o+u*t}}function Cs(i,e){var t=i.height/i.width,r=e.height/e.width;return t<1&&r>1||t>1&&r<1?1:Math.min(Math.max(r,1/r),Math.max(1/t,t))}function Dt(i,e,t,r,n){var a=i.angle,o=i.ratio,s=i.x,u=i.y,d=e.width,h=e.height,l=Fe(),f=Math.min(d,h)-2*r,p=Cs(e,t);return n?(Qe(l,Pi(Fe(),s,u)),Qe(l,Yt(Fe(),o)),Qe(l,Oi(Fe(),a)),Qe(l,Yt(Fe(),d/f/2/p,h/f/2/p))):(Qe(l,Yt(Fe(),2*(f/d)*p,2*(f/h)*p)),Qe(l,Oi(Fe(),-a)),Qe(l,Yt(Fe(),1/o)),Qe(l,Pi(Fe(),-s,-u))),l}function xs(i,e,t){var r=Nr(i,{x:Math.cos(e.angle),y:Math.sin(e.angle)},0),n=r.x,a=r.y;return 1/Math.sqrt(Math.pow(n,2)+Math.pow(a,2))/t.width}function Ds(i){if(!i.order)return{x:[0,1],y:[0,1]};var e=1/0,t=-1/0,r=1/0,n=-1/0;return i.forEachNode(function(a,o){var s=o.x,u=o.y;s<e&&(e=s),s>t&&(t=s),u<r&&(r=u),u>n&&(n=u)}),{x:[e,t],y:[r,n]}}function Ls(i){if(!ms(i))throw new Error("Sigma: invalid graph instance.");i.forEachNode(function(e,t){if(!Number.isFinite(t.x)||!Number.isFinite(t.y))throw new Error("Sigma: Coordinates of node ".concat(e," are invalid. A node must have a numeric 'x' and 'y' attribute."))})}function ks(i,e,t){var r=document.createElement(i);if(e)for(var n in e)r.style[n]=e[n];if(t)for(var a in t)r.setAttribute(a,t[a]);return r}function Fi(){return typeof window.devicePixelRatio<"u"?window.devicePixelRatio:1}function Ni(i,e,t){return t.sort(function(r,n){var a=e(r)||0,o=e(n)||0;return a<o?-1:a>o?1:0})}function Ii(i){var e=vt(i.x,2),t=e[0],r=e[1],n=vt(i.y,2),a=n[0],o=n[1],s=Math.max(r-t,o-a),u=(r+t)/2,d=(o+a)/2;(s===0||Math.abs(s)===1/0||isNaN(s))&&(s=1),isNaN(u)&&(u=0),isNaN(d)&&(d=0);var h=function(f){return{x:.5+(f.x-u)/s,y:.5+(f.y-d)/s}};return h.applyTo=function(l){l.x=.5+(l.x-u)/s,l.y=.5+(l.y-d)/s},h.inverse=function(l){return{x:u+s*(l.x-.5),y:d+s*(l.y-.5)}},h.ratio=s,h}function Ir(i){"@babel/helpers - typeof";return Ir=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ir(i)}function $i(i,e){var t=e.size;if(t!==0){var r=i.length;i.length+=t;var n=0;e.forEach(function(a){i[r+n]=a,n++})}}function Sr(i){i=i||{};for(var e=0,t=arguments.length<=1?0:arguments.length-1;e<t;e++){var r=e+1<1||arguments.length<=e+1?void 0:arguments[e+1];r&&Object.assign(i,r)}return i}var Jr={hideEdgesOnMove:!1,hideLabelsOnMove:!1,renderLabels:!0,renderEdgeLabels:!1,enableEdgeEvents:!1,defaultNodeColor:"#999",defaultNodeType:"circle",defaultEdgeColor:"#ccc",defaultEdgeType:"line",labelFont:"Arial",labelSize:14,labelWeight:"normal",labelColor:{color:"#000"},edgeLabelFont:"Arial",edgeLabelSize:14,edgeLabelWeight:"normal",edgeLabelColor:{attribute:"color"},stagePadding:30,defaultDrawEdgeLabel:qo,defaultDrawNodeLabel:On,defaultDrawNodeHover:Ko,minEdgeThickness:1.7,antiAliasingFeather:1,dragTimeout:100,draggedEventsTolerance:3,inertiaDuration:200,inertiaRatio:3,zoomDuration:250,zoomingRatio:1.7,doubleClickTimeout:300,doubleClickZoomingRatio:2.2,doubleClickZoomingDuration:200,tapMoveTolerance:10,zoomToSizeRatioFunction:Math.sqrt,itemSizesReference:"screen",autoRescale:!0,autoCenter:!0,labelDensity:1,labelGridCellSize:100,labelRenderedSizeThreshold:6,nodeReducer:null,edgeReducer:null,zIndex:!1,minCameraRatio:null,maxCameraRatio:null,enableCameraZooming:!0,enableCameraPanning:!0,enableCameraRotation:!0,cameraPanBoundaries:null,allowInvalidContainer:!1,nodeProgramClasses:{},nodeHoverProgramClasses:{},edgeProgramClasses:{}},Gs={circle:zt},Os={arrow:$n,line:gs};function Cr(i){if(typeof i.labelDensity!="number"||i.labelDensity<0)throw new Error("Settings: invalid `labelDensity`. Expecting a positive number.");var e=i.minCameraRatio,t=i.maxCameraRatio;if(typeof e=="number"&&typeof t=="number"&&t<e)throw new Error("Settings: invalid camera ratio boundaries. Expecting `maxCameraRatio` to be greater than `minCameraRatio`.")}function Ps(i){var e=Sr({},Jr,i);return e.nodeProgramClasses=Sr({},Gs,e.nodeProgramClasses),e.edgeProgramClasses=Sr({},Os,e.edgeProgramClasses),e}var Xt=1.5,zi=function(i){function e(){var t;return le(this,e),t=Se(this,e),D(t,"x",.5),D(t,"y",.5),D(t,"angle",0),D(t,"ratio",1),D(t,"minRatio",null),D(t,"maxRatio",null),D(t,"enabledZooming",!0),D(t,"enabledPanning",!0),D(t,"enabledRotation",!0),D(t,"clean",null),D(t,"nextFrame",null),D(t,"previousState",null),D(t,"enabled",!0),t.previousState=t.getState(),t}return Ce(e,i),fe(e,[{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"getState",value:function(){return{x:this.x,y:this.y,angle:this.angle,ratio:this.ratio}}},{key:"hasState",value:function(r){return this.x===r.x&&this.y===r.y&&this.ratio===r.ratio&&this.angle===r.angle}},{key:"getPreviousState",value:function(){var r=this.previousState;return r?{x:r.x,y:r.y,angle:r.angle,ratio:r.ratio}:null}},{key:"getBoundedRatio",value:function(r){var n=r;return typeof this.minRatio=="number"&&(n=Math.max(n,this.minRatio)),typeof this.maxRatio=="number"&&(n=Math.min(n,this.maxRatio)),n}},{key:"validateState",value:function(r){var n={};return this.enabledPanning&&typeof r.x=="number"&&(n.x=r.x),this.enabledPanning&&typeof r.y=="number"&&(n.y=r.y),this.enabledZooming&&typeof r.ratio=="number"&&(n.ratio=this.getBoundedRatio(r.ratio)),this.enabledRotation&&typeof r.angle=="number"&&(n.angle=r.angle),this.clean?this.clean(I(I({},this.getState()),n)):n}},{key:"isAnimated",value:function(){return!!this.nextFrame}},{key:"setState",value:function(r){if(!this.enabled)return this;this.previousState=this.getState();var n=this.validateState(r);return typeof n.x=="number"&&(this.x=n.x),typeof n.y=="number"&&(this.y=n.y),typeof n.ratio=="number"&&(this.ratio=n.ratio),typeof n.angle=="number"&&(this.angle=n.angle),this.hasState(this.previousState)||this.emit("updated",this.getState()),this}},{key:"updateState",value:function(r){return this.setState(r(this.getState())),this}},{key:"animate",value:function(r){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;if(!o)return new Promise(function(p){return n.animate(r,a,p)});if(this.enabled){var s=I(I({},Ss),a),u=this.validateState(r),d=typeof s.easing=="function"?s.easing:Rs[s.easing],h=Date.now(),l=this.getState(),f=function(){var v=(Date.now()-h)/s.duration;if(v>=1){n.nextFrame=null,n.setState(u),n.animationCallback&&(n.animationCallback.call(null),n.animationCallback=void 0);return}var m=d(v),E={};typeof u.x=="number"&&(E.x=l.x+(u.x-l.x)*m),typeof u.y=="number"&&(E.y=l.y+(u.y-l.y)*m),n.enabledRotation&&typeof u.angle=="number"&&(E.angle=l.angle+(u.angle-l.angle)*m),typeof u.ratio=="number"&&(E.ratio=l.ratio+(u.ratio-l.ratio)*m),n.setState(E),n.nextFrame=requestAnimationFrame(f)};this.nextFrame?(cancelAnimationFrame(this.nextFrame),this.animationCallback&&this.animationCallback.call(null),this.nextFrame=requestAnimationFrame(f)):f(),this.animationCallback=o}}},{key:"animatedZoom",value:function(r){return r?typeof r=="number"?this.animate({ratio:this.ratio/r}):this.animate({ratio:this.ratio/(r.factor||Xt)},r):this.animate({ratio:this.ratio/Xt})}},{key:"animatedUnzoom",value:function(r){return r?typeof r=="number"?this.animate({ratio:this.ratio*r}):this.animate({ratio:this.ratio*(r.factor||Xt)},r):this.animate({ratio:this.ratio*Xt})}},{key:"animatedReset",value:function(r){return this.animate({x:.5,y:.5,ratio:1,angle:0},r)}},{key:"copy",value:function(){return e.from(this.getState())}}],[{key:"from",value:function(r){var n=new e;return n.setState(r)}}])}(Zr);function Ne(i,e){var t=e.getBoundingClientRect();return{x:i.clientX-t.left,y:i.clientY-t.top}}function Ke(i,e){var t=I(I({},Ne(i,e)),{},{sigmaDefaultPrevented:!1,preventSigmaDefault:function(){t.sigmaDefaultPrevented=!0},original:i});return t}function Lt(i){var e="x"in i?i:I(I({},i.touches[0]||i.previousTouches[0]),{},{original:i.original,sigmaDefaultPrevented:i.sigmaDefaultPrevented,preventSigmaDefault:function(){i.sigmaDefaultPrevented=!0,e.sigmaDefaultPrevented=!0}});return e}function Fs(i,e){return I(I({},Ke(i,e)),{},{delta:Un(i)})}var Ns=2;function Qt(i){for(var e=[],t=0,r=Math.min(i.length,Ns);t<r;t++)e.push(i[t]);return e}function kt(i,e,t){var r={touches:Qt(i.touches).map(function(n){return Ne(n,t)}),previousTouches:e.map(function(n){return Ne(n,t)}),sigmaDefaultPrevented:!1,preventSigmaDefault:function(){r.sigmaDefaultPrevented=!0},original:i};return r}function Un(i){if(typeof i.deltaY<"u")return i.deltaY*-3/360;if(typeof i.detail<"u")return i.detail/-9;throw new Error("Captor: could not extract delta from event.")}var Mn=function(i){function e(t,r){var n;return le(this,e),n=Se(this,e),n.container=t,n.renderer=r,n}return Ce(e,i),fe(e)}(Zr),Is=["doubleClickTimeout","doubleClickZoomingDuration","doubleClickZoomingRatio","dragTimeout","draggedEventsTolerance","inertiaDuration","inertiaRatio","zoomDuration","zoomingRatio"],$s=Is.reduce(function(i,e){return I(I({},i),{},D({},e,Jr[e]))},{}),zs=function(i){function e(t,r){var n;return le(this,e),n=Se(this,e,[t,r]),D(n,"enabled",!0),D(n,"draggedEvents",0),D(n,"downStartTime",null),D(n,"lastMouseX",null),D(n,"lastMouseY",null),D(n,"isMouseDown",!1),D(n,"isMoving",!1),D(n,"movingTimeout",null),D(n,"startCameraState",null),D(n,"clicks",0),D(n,"doubleClickTimeout",null),D(n,"currentWheelDirection",0),D(n,"settings",$s),n.handleClick=n.handleClick.bind(n),n.handleRightClick=n.handleRightClick.bind(n),n.handleDown=n.handleDown.bind(n),n.handleUp=n.handleUp.bind(n),n.handleMove=n.handleMove.bind(n),n.handleWheel=n.handleWheel.bind(n),n.handleLeave=n.handleLeave.bind(n),n.handleEnter=n.handleEnter.bind(n),t.addEventListener("click",n.handleClick,{capture:!1}),t.addEventListener("contextmenu",n.handleRightClick,{capture:!1}),t.addEventListener("mousedown",n.handleDown,{capture:!1}),t.addEventListener("wheel",n.handleWheel,{capture:!1}),t.addEventListener("mouseleave",n.handleLeave,{capture:!1}),t.addEventListener("mouseenter",n.handleEnter,{capture:!1}),document.addEventListener("mousemove",n.handleMove,{capture:!1}),document.addEventListener("mouseup",n.handleUp,{capture:!1}),n}return Ce(e,i),fe(e,[{key:"kill",value:function(){var r=this.container;r.removeEventListener("click",this.handleClick),r.removeEventListener("contextmenu",this.handleRightClick),r.removeEventListener("mousedown",this.handleDown),r.removeEventListener("wheel",this.handleWheel),r.removeEventListener("mouseleave",this.handleLeave),r.removeEventListener("mouseenter",this.handleEnter),document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleUp)}},{key:"handleClick",value:function(r){var n=this;if(this.enabled){if(this.clicks++,this.clicks===2)return this.clicks=0,typeof this.doubleClickTimeout=="number"&&(clearTimeout(this.doubleClickTimeout),this.doubleClickTimeout=null),this.handleDoubleClick(r);setTimeout(function(){n.clicks=0,n.doubleClickTimeout=null},this.settings.doubleClickTimeout),this.draggedEvents<this.settings.draggedEventsTolerance&&this.emit("click",Ke(r,this.container))}}},{key:"handleRightClick",value:function(r){this.enabled&&this.emit("rightClick",Ke(r,this.container))}},{key:"handleDoubleClick",value:function(r){if(this.enabled){r.preventDefault(),r.stopPropagation();var n=Ke(r,this.container);if(this.emit("doubleClick",n),!n.sigmaDefaultPrevented){var a=this.renderer.getCamera(),o=a.getBoundedRatio(a.getState().ratio/this.settings.doubleClickZoomingRatio);a.animate(this.renderer.getViewportZoomedState(Ne(r,this.container),o),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}}},{key:"handleDown",value:function(r){if(this.enabled){if(r.button===0){this.startCameraState=this.renderer.getCamera().getState();var n=Ne(r,this.container),a=n.x,o=n.y;this.lastMouseX=a,this.lastMouseY=o,this.draggedEvents=0,this.downStartTime=Date.now(),this.isMouseDown=!0}this.emit("mousedown",Ke(r,this.container))}}},{key:"handleUp",value:function(r){var n=this;if(!(!this.enabled||!this.isMouseDown)){var a=this.renderer.getCamera();this.isMouseDown=!1,typeof this.movingTimeout=="number"&&(clearTimeout(this.movingTimeout),this.movingTimeout=null);var o=Ne(r,this.container),s=o.x,u=o.y,d=a.getState(),h=a.getPreviousState()||{x:0,y:0};this.isMoving?a.animate({x:d.x+this.settings.inertiaRatio*(d.x-h.x),y:d.y+this.settings.inertiaRatio*(d.y-h.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"}):(this.lastMouseX!==s||this.lastMouseY!==u)&&a.setState({x:d.x,y:d.y}),this.isMoving=!1,setTimeout(function(){var l=n.draggedEvents>0;n.draggedEvents=0,l&&n.renderer.getSetting("hideEdgesOnMove")&&n.renderer.refresh()},0),this.emit("mouseup",Ke(r,this.container))}}},{key:"handleMove",value:function(r){var n=this;if(this.enabled){var a=Ke(r,this.container);if(this.emit("mousemovebody",a),(r.target===this.container||r.composedPath()[0]===this.container)&&this.emit("mousemove",a),!a.sigmaDefaultPrevented&&this.isMouseDown){this.isMoving=!0,this.draggedEvents++,typeof this.movingTimeout=="number"&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){n.movingTimeout=null,n.isMoving=!1},this.settings.dragTimeout);var o=this.renderer.getCamera(),s=Ne(r,this.container),u=s.x,d=s.y,h=this.renderer.viewportToFramedGraph({x:this.lastMouseX,y:this.lastMouseY}),l=this.renderer.viewportToFramedGraph({x:u,y:d}),f=h.x-l.x,p=h.y-l.y,v=o.getState(),m=v.x+f,E=v.y+p;o.setState({x:m,y:E}),this.lastMouseX=u,this.lastMouseY=d,r.preventDefault(),r.stopPropagation()}}}},{key:"handleLeave",value:function(r){this.emit("mouseleave",Ke(r,this.container))}},{key:"handleEnter",value:function(r){this.emit("mouseenter",Ke(r,this.container))}},{key:"handleWheel",value:function(r){var n=this,a=this.renderer.getCamera();if(!(!this.enabled||!a.enabledZooming)){var o=Un(r);if(o){var s=Fs(r,this.container);if(this.emit("wheel",s),s.sigmaDefaultPrevented){r.preventDefault(),r.stopPropagation();return}var u=a.getState().ratio,d=o>0?1/this.settings.zoomingRatio:this.settings.zoomingRatio,h=a.getBoundedRatio(u*d),l=o>0?1:-1,f=Date.now();u!==h&&(r.preventDefault(),r.stopPropagation(),!(this.currentWheelDirection===l&&this.lastWheelTriggerTime&&f-this.lastWheelTriggerTime<this.settings.zoomDuration/5)&&(a.animate(this.renderer.getViewportZoomedState(Ne(r,this.container),h),{easing:"quadraticOut",duration:this.settings.zoomDuration},function(){n.currentWheelDirection=0}),this.currentWheelDirection=l,this.lastWheelTriggerTime=f))}}}},{key:"setSettings",value:function(r){this.settings=r}}])}(Mn),Us=["dragTimeout","inertiaDuration","inertiaRatio","doubleClickTimeout","doubleClickZoomingRatio","doubleClickZoomingDuration","tapMoveTolerance"],Ms=Us.reduce(function(i,e){return I(I({},i),{},D({},e,Jr[e]))},{}),Bs=function(i){function e(t,r){var n;return le(this,e),n=Se(this,e,[t,r]),D(n,"enabled",!0),D(n,"isMoving",!1),D(n,"hasMoved",!1),D(n,"touchMode",0),D(n,"startTouchesPositions",[]),D(n,"lastTouches",[]),D(n,"lastTap",null),D(n,"settings",Ms),n.handleStart=n.handleStart.bind(n),n.handleLeave=n.handleLeave.bind(n),n.handleMove=n.handleMove.bind(n),t.addEventListener("touchstart",n.handleStart,{capture:!1}),t.addEventListener("touchcancel",n.handleLeave,{capture:!1}),document.addEventListener("touchend",n.handleLeave,{capture:!1,passive:!1}),document.addEventListener("touchmove",n.handleMove,{capture:!1,passive:!1}),n}return Ce(e,i),fe(e,[{key:"kill",value:function(){var r=this.container;r.removeEventListener("touchstart",this.handleStart),r.removeEventListener("touchcancel",this.handleLeave),document.removeEventListener("touchend",this.handleLeave),document.removeEventListener("touchmove",this.handleMove)}},{key:"getDimensions",value:function(){return{width:this.container.offsetWidth,height:this.container.offsetHeight}}},{key:"handleStart",value:function(r){var n=this;if(this.enabled){r.preventDefault();var a=Qt(r.touches);if(this.touchMode=a.length,this.startCameraState=this.renderer.getCamera().getState(),this.startTouchesPositions=a.map(function(p){return Ne(p,n.container)}),this.touchMode===2){var o=vt(this.startTouchesPositions,2),s=o[0],u=s.x,d=s.y,h=o[1],l=h.x,f=h.y;this.startTouchesAngle=Math.atan2(f-d,l-u),this.startTouchesDistance=Math.sqrt(Math.pow(l-u,2)+Math.pow(f-d,2))}this.emit("touchdown",kt(r,this.lastTouches,this.container)),this.lastTouches=a,this.lastTouchesPositions=this.startTouchesPositions}}},{key:"handleLeave",value:function(r){if(!(!this.enabled||!this.startTouchesPositions.length)){switch(r.cancelable&&r.preventDefault(),this.movingTimeout&&(this.isMoving=!1,clearTimeout(this.movingTimeout)),this.touchMode){case 2:if(r.touches.length===1){this.handleStart(r),r.preventDefault();break}case 1:if(this.isMoving){var n=this.renderer.getCamera(),a=n.getState(),o=n.getPreviousState()||{x:0,y:0};n.animate({x:a.x+this.settings.inertiaRatio*(a.x-o.x),y:a.y+this.settings.inertiaRatio*(a.y-o.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"})}this.hasMoved=!1,this.isMoving=!1,this.touchMode=0;break}if(this.emit("touchup",kt(r,this.lastTouches,this.container)),!r.touches.length){var s=Ne(this.lastTouches[0],this.container),u=this.startTouchesPositions[0],d=Math.pow(s.x-u.x,2)+Math.pow(s.y-u.y,2);if(!r.touches.length&&d<Math.pow(this.settings.tapMoveTolerance,2))if(this.lastTap&&Date.now()-this.lastTap.time<this.settings.doubleClickTimeout){var h=kt(r,this.lastTouches,this.container);if(this.emit("doubletap",h),this.lastTap=null,!h.sigmaDefaultPrevented){var l=this.renderer.getCamera(),f=l.getBoundedRatio(l.getState().ratio/this.settings.doubleClickZoomingRatio);l.animate(this.renderer.getViewportZoomedState(s,f),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}else{var p=kt(r,this.lastTouches,this.container);this.emit("tap",p),this.lastTap={time:Date.now(),position:p.touches[0]||p.previousTouches[0]}}}this.lastTouches=Qt(r.touches),this.startTouchesPositions=[]}}},{key:"handleMove",value:function(r){var n=this;if(!(!this.enabled||!this.startTouchesPositions.length)){r.preventDefault();var a=Qt(r.touches),o=a.map(function(ne){return Ne(ne,n.container)}),s=this.lastTouches;this.lastTouches=a,this.lastTouchesPositions=o;var u=kt(r,s,this.container);if(this.emit("touchmove",u),!u.sigmaDefaultPrevented&&(this.hasMoved||(this.hasMoved=o.some(function(ne,X){var N=n.startTouchesPositions[X];return N&&(ne.x!==N.x||ne.y!==N.y)})),!!this.hasMoved)){this.isMoving=!0,this.movingTimeout&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){n.isMoving=!1},this.settings.dragTimeout);var d=this.renderer.getCamera(),h=this.startCameraState,l=this.renderer.getSetting("stagePadding");switch(this.touchMode){case 1:{var f=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0]),p=f.x,v=f.y,m=this.renderer.viewportToFramedGraph(o[0]),E=m.x,C=m.y;d.setState({x:h.x+p-E,y:h.y+v-C});break}case 2:{var _={x:.5,y:.5,angle:0,ratio:1},A=o[0],c=A.x,w=A.y,b=o[1],T=b.x,O=b.y,L=Math.atan2(O-w,T-c)-this.startTouchesAngle,k=Math.hypot(O-w,T-c)/this.startTouchesDistance,B=d.getBoundedRatio(h.ratio/k);_.ratio=B,_.angle=h.angle+L;var P=this.getDimensions(),g=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0],{cameraState:h}),K=Math.min(P.width,P.height)-2*l,J=K/P.width,x=K/P.height,y=B/K,U=c-K/2/J,W=w-K/2/x,Q=[U*Math.cos(-_.angle)-W*Math.sin(-_.angle),W*Math.cos(-_.angle)+U*Math.sin(-_.angle)];U=Q[0],W=Q[1],_.x=g.x-U*y,_.y=g.y+W*y,d.setState(_);break}}}}}},{key:"setSettings",value:function(r){this.settings=r}}])}(Mn);function Hs(i){if(Array.isArray(i))return Pr(i)}function Ws(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function js(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ui(i){return Hs(i)||Ws(i)||Rn(i)||js()}function Vs(i,e){if(i==null)return{};var t={};for(var r in i)if({}.hasOwnProperty.call(i,r)){if(e.includes(r))continue;t[r]=i[r]}return t}function xr(i,e){if(i==null)return{};var t,r,n=Vs(i,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);for(r=0;r<a.length;r++)t=a[r],e.includes(t)||{}.propertyIsEnumerable.call(i,t)&&(n[t]=i[t])}return n}var Mi=function(){function i(e,t){le(this,i),this.key=e,this.size=t}return fe(i,null,[{key:"compare",value:function(t,r){return t.size>r.size?-1:t.size<r.size||t.key>r.key?1:-1}}])}(),Bi=function(){function i(){le(this,i),D(this,"width",0),D(this,"height",0),D(this,"cellSize",0),D(this,"columns",0),D(this,"rows",0),D(this,"cells",{})}return fe(i,[{key:"resizeAndClear",value:function(t,r){this.width=t.width,this.height=t.height,this.cellSize=r,this.columns=Math.ceil(t.width/r),this.rows=Math.ceil(t.height/r),this.cells={}}},{key:"getIndex",value:function(t){var r=Math.floor(t.x/this.cellSize),n=Math.floor(t.y/this.cellSize);return n*this.columns+r}},{key:"add",value:function(t,r,n){var a=new Mi(t,r),o=this.getIndex(n),s=this.cells[o];s||(s=[],this.cells[o]=s),s.push(a)}},{key:"organize",value:function(){for(var t in this.cells){var r=this.cells[t];r.sort(Mi.compare)}}},{key:"getLabelsToDisplay",value:function(t,r){var n=this.cellSize*this.cellSize,a=n/t/t,o=a*r/n,s=Math.ceil(o),u=[];for(var d in this.cells)for(var h=this.cells[d],l=0;l<Math.min(s,h.length);l++)u.push(h[l].key);return u}}])}();function qs(i){var e=i.graph,t=i.hoveredNode,r=i.highlightedNodes,n=i.displayedNodeLabels,a=[];return e.forEachEdge(function(o,s,u,d){(u===t||d===t||r.has(u)||r.has(d)||n.has(u)&&n.has(d))&&a.push(o)}),a}var Ks=150,Ys=50,Ye=Object.prototype.hasOwnProperty;function Xs(i,e,t){if(!Ye.call(t,"x")||!Ye.call(t,"y"))throw new Error('Sigma: could not find a valid position (x, y) for node "'.concat(e,'". All your nodes must have a number "x" and "y". Maybe your forgot to apply a layout or your "nodeReducer" is not returning the correct data?'));return t.color||(t.color=i.defaultNodeColor),!t.label&&t.label!==""&&(t.label=null),t.label!==void 0&&t.label!==null?t.label=""+t.label:t.label=null,t.size||(t.size=2),Ye.call(t,"hidden")||(t.hidden=!1),Ye.call(t,"highlighted")||(t.highlighted=!1),Ye.call(t,"forceLabel")||(t.forceLabel=!1),(!t.type||t.type==="")&&(t.type=i.defaultNodeType),t.zIndex||(t.zIndex=0),t}function Zs(i,e,t){return t.color||(t.color=i.defaultEdgeColor),t.label||(t.label=""),t.size||(t.size=.5),Ye.call(t,"hidden")||(t.hidden=!1),Ye.call(t,"forceLabel")||(t.forceLabel=!1),(!t.type||t.type==="")&&(t.type=i.defaultEdgeType),t.zIndex||(t.zIndex=0),t}var Js=function(i){function e(t,r){var n,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(le(this,e),n=Se(this,e),D(n,"elements",{}),D(n,"canvasContexts",{}),D(n,"webGLContexts",{}),D(n,"pickingLayers",new Set),D(n,"textures",{}),D(n,"frameBuffers",{}),D(n,"activeListeners",{}),D(n,"labelGrid",new Bi),D(n,"nodeDataCache",{}),D(n,"edgeDataCache",{}),D(n,"nodeProgramIndex",{}),D(n,"edgeProgramIndex",{}),D(n,"nodesWithForcedLabels",new Set),D(n,"edgesWithForcedLabels",new Set),D(n,"nodeExtent",{x:[0,1],y:[0,1]}),D(n,"nodeZExtent",[1/0,-1/0]),D(n,"edgeZExtent",[1/0,-1/0]),D(n,"matrix",Fe()),D(n,"invMatrix",Fe()),D(n,"correctionRatio",1),D(n,"customBBox",null),D(n,"normalizationFunction",Ii({x:[0,1],y:[0,1]})),D(n,"graphToViewportRatio",1),D(n,"itemIDsIndex",{}),D(n,"nodeIndices",{}),D(n,"edgeIndices",{}),D(n,"width",0),D(n,"height",0),D(n,"pixelRatio",Fi()),D(n,"pickingDownSizingRatio",2*n.pixelRatio),D(n,"displayedNodeLabels",new Set),D(n,"displayedEdgeLabels",new Set),D(n,"highlightedNodes",new Set),D(n,"hoveredNode",null),D(n,"hoveredEdge",null),D(n,"renderFrame",null),D(n,"renderHighlightedNodesFrame",null),D(n,"needToProcess",!1),D(n,"checkEdgesEventsFrame",null),D(n,"nodePrograms",{}),D(n,"nodeHoverPrograms",{}),D(n,"edgePrograms",{}),n.settings=Ps(a),Cr(n.settings),Ls(t),!(r instanceof HTMLElement))throw new Error("Sigma: container should be an html element.");n.graph=t,n.container=r,n.createWebGLContext("edges",{picking:a.enableEdgeEvents}),n.createCanvasContext("edgeLabels"),n.createWebGLContext("nodes",{picking:!0}),n.createCanvasContext("labels"),n.createCanvasContext("hovers"),n.createWebGLContext("hoverNodes"),n.createCanvasContext("mouse",{style:{touchAction:"none",userSelect:"none"}}),n.resize();for(var o in n.settings.nodeProgramClasses)n.registerNodeProgram(o,n.settings.nodeProgramClasses[o],n.settings.nodeHoverProgramClasses[o]);for(var s in n.settings.edgeProgramClasses)n.registerEdgeProgram(s,n.settings.edgeProgramClasses[s]);return n.camera=new zi,n.bindCameraHandlers(),n.mouseCaptor=new zs(n.elements.mouse,n),n.mouseCaptor.setSettings(n.settings),n.touchCaptor=new Bs(n.elements.mouse,n),n.touchCaptor.setSettings(n.settings),n.bindEventHandlers(),n.bindGraphHandlers(),n.handleSettingsUpdate(),n.refresh(),n}return Ce(e,i),fe(e,[{key:"registerNodeProgram",value:function(r,n,a){return this.nodePrograms[r]&&this.nodePrograms[r].kill(),this.nodeHoverPrograms[r]&&this.nodeHoverPrograms[r].kill(),this.nodePrograms[r]=new n(this.webGLContexts.nodes,this.frameBuffers.nodes,this),this.nodeHoverPrograms[r]=new(a||n)(this.webGLContexts.hoverNodes,null,this),this}},{key:"registerEdgeProgram",value:function(r,n){return this.edgePrograms[r]&&this.edgePrograms[r].kill(),this.edgePrograms[r]=new n(this.webGLContexts.edges,this.frameBuffers.edges,this),this}},{key:"unregisterNodeProgram",value:function(r){if(this.nodePrograms[r]){var n=this.nodePrograms,a=n[r],o=xr(n,[r].map(Ot));a.kill(),this.nodePrograms=o}if(this.nodeHoverPrograms[r]){var s=this.nodeHoverPrograms,u=s[r],d=xr(s,[r].map(Ot));u.kill(),this.nodePrograms=d}return this}},{key:"unregisterEdgeProgram",value:function(r){if(this.edgePrograms[r]){var n=this.edgePrograms,a=n[r],o=xr(n,[r].map(Ot));a.kill(),this.edgePrograms=o}return this}},{key:"resetWebGLTexture",value:function(r){var n=this.webGLContexts[r],a=this.frameBuffers[r],o=this.textures[r];o&&n.deleteTexture(o);var s=n.createTexture();return n.bindFramebuffer(n.FRAMEBUFFER,a),n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,null),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0),this.textures[r]=s,this}},{key:"bindCameraHandlers",value:function(){var r=this;return this.activeListeners.camera=function(){r.scheduleRender()},this.camera.on("updated",this.activeListeners.camera),this}},{key:"unbindCameraHandlers",value:function(){return this.camera.removeListener("updated",this.activeListeners.camera),this}},{key:"getNodeAtPosition",value:function(r){var n=r.x,a=r.y,o=Ri(this.webGLContexts.nodes,this.frameBuffers.nodes,n,a,this.pixelRatio,this.pickingDownSizingRatio),s=Ai.apply(void 0,Ui(o)),u=this.itemIDsIndex[s];return u&&u.type==="node"?u.id:null}},{key:"bindEventHandlers",value:function(){var r=this;this.activeListeners.handleResize=function(){r.scheduleRefresh()},window.addEventListener("resize",this.activeListeners.handleResize),this.activeListeners.handleMove=function(a){var o=Lt(a),s={event:o,preventSigmaDefault:function(){o.preventSigmaDefault()}},u=r.getNodeAtPosition(o);if(u&&r.hoveredNode!==u&&!r.nodeDataCache[u].hidden){r.hoveredNode&&r.emit("leaveNode",I(I({},s),{},{node:r.hoveredNode})),r.hoveredNode=u,r.emit("enterNode",I(I({},s),{},{node:u})),r.scheduleHighlightedNodesRender();return}if(r.hoveredNode&&r.getNodeAtPosition(o)!==r.hoveredNode){var d=r.hoveredNode;r.hoveredNode=null,r.emit("leaveNode",I(I({},s),{},{node:d})),r.scheduleHighlightedNodesRender();return}if(r.settings.enableEdgeEvents){var h=r.hoveredNode?null:r.getEdgeAtPoint(s.event.x,s.event.y);h!==r.hoveredEdge&&(r.hoveredEdge&&r.emit("leaveEdge",I(I({},s),{},{edge:r.hoveredEdge})),h&&r.emit("enterEdge",I(I({},s),{},{edge:h})),r.hoveredEdge=h)}},this.activeListeners.handleMoveBody=function(a){var o=Lt(a);r.emit("moveBody",{event:o,preventSigmaDefault:function(){o.preventSigmaDefault()}})},this.activeListeners.handleLeave=function(a){var o=Lt(a),s={event:o,preventSigmaDefault:function(){o.preventSigmaDefault()}};r.hoveredNode&&(r.emit("leaveNode",I(I({},s),{},{node:r.hoveredNode})),r.scheduleHighlightedNodesRender()),r.settings.enableEdgeEvents&&r.hoveredEdge&&(r.emit("leaveEdge",I(I({},s),{},{edge:r.hoveredEdge})),r.scheduleHighlightedNodesRender()),r.emit("leaveStage",I({},s))},this.activeListeners.handleEnter=function(a){var o=Lt(a),s={event:o,preventSigmaDefault:function(){o.preventSigmaDefault()}};r.emit("enterStage",I({},s))};var n=function(o){return function(s){var u=Lt(s),d={event:u,preventSigmaDefault:function(){u.preventSigmaDefault()}},h=r.getNodeAtPosition(u);if(h)return r.emit("".concat(o,"Node"),I(I({},d),{},{node:h}));if(r.settings.enableEdgeEvents){var l=r.getEdgeAtPoint(u.x,u.y);if(l)return r.emit("".concat(o,"Edge"),I(I({},d),{},{edge:l}))}return r.emit("".concat(o,"Stage"),d)}};return this.activeListeners.handleClick=n("click"),this.activeListeners.handleRightClick=n("rightClick"),this.activeListeners.handleDoubleClick=n("doubleClick"),this.activeListeners.handleWheel=n("wheel"),this.activeListeners.handleDown=n("down"),this.activeListeners.handleUp=n("up"),this.mouseCaptor.on("mousemove",this.activeListeners.handleMove),this.mouseCaptor.on("mousemovebody",this.activeListeners.handleMoveBody),this.mouseCaptor.on("click",this.activeListeners.handleClick),this.mouseCaptor.on("rightClick",this.activeListeners.handleRightClick),this.mouseCaptor.on("doubleClick",this.activeListeners.handleDoubleClick),this.mouseCaptor.on("wheel",this.activeListeners.handleWheel),this.mouseCaptor.on("mousedown",this.activeListeners.handleDown),this.mouseCaptor.on("mouseup",this.activeListeners.handleUp),this.mouseCaptor.on("mouseleave",this.activeListeners.handleLeave),this.mouseCaptor.on("mouseenter",this.activeListeners.handleEnter),this.touchCaptor.on("touchdown",this.activeListeners.handleDown),this.touchCaptor.on("touchdown",this.activeListeners.handleMove),this.touchCaptor.on("touchup",this.activeListeners.handleUp),this.touchCaptor.on("touchmove",this.activeListeners.handleMove),this.touchCaptor.on("tap",this.activeListeners.handleClick),this.touchCaptor.on("doubletap",this.activeListeners.handleDoubleClick),this.touchCaptor.on("touchmove",this.activeListeners.handleMoveBody),this}},{key:"bindGraphHandlers",value:function(){var r=this,n=this.graph,a=new Set(["x","y","zIndex","type"]);return this.activeListeners.eachNodeAttributesUpdatedGraphUpdate=function(o){var s,u=(s=o.hints)===null||s===void 0?void 0:s.attributes;r.graph.forEachNode(function(h){return r.updateNode(h)});var d=!u||u.some(function(h){return a.has(h)});r.refresh({partialGraph:{nodes:n.nodes()},skipIndexation:!d,schedule:!0})},this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate=function(o){var s,u=(s=o.hints)===null||s===void 0?void 0:s.attributes;r.graph.forEachEdge(function(h){return r.updateEdge(h)});var d=u&&["zIndex","type"].some(function(h){return u==null?void 0:u.includes(h)});r.refresh({partialGraph:{edges:n.edges()},skipIndexation:!d,schedule:!0})},this.activeListeners.addNodeGraphUpdate=function(o){var s=o.key;r.addNode(s),r.refresh({partialGraph:{nodes:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.updateNodeGraphUpdate=function(o){var s=o.key;r.refresh({partialGraph:{nodes:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropNodeGraphUpdate=function(o){var s=o.key;r.removeNode(s),r.refresh({schedule:!0})},this.activeListeners.addEdgeGraphUpdate=function(o){var s=o.key;r.addEdge(s),r.refresh({partialGraph:{edges:[s]},schedule:!0})},this.activeListeners.updateEdgeGraphUpdate=function(o){var s=o.key;r.refresh({partialGraph:{edges:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropEdgeGraphUpdate=function(o){var s=o.key;r.removeEdge(s),r.refresh({schedule:!0})},this.activeListeners.clearEdgesGraphUpdate=function(){r.clearEdgeState(),r.clearEdgeIndices(),r.refresh({schedule:!0})},this.activeListeners.clearGraphUpdate=function(){r.clearEdgeState(),r.clearNodeState(),r.clearEdgeIndices(),r.clearNodeIndices(),r.refresh({schedule:!0})},n.on("nodeAdded",this.activeListeners.addNodeGraphUpdate),n.on("nodeDropped",this.activeListeners.dropNodeGraphUpdate),n.on("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),n.on("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),n.on("edgeAdded",this.activeListeners.addEdgeGraphUpdate),n.on("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),n.on("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),n.on("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),n.on("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),n.on("cleared",this.activeListeners.clearGraphUpdate),this}},{key:"unbindGraphHandlers",value:function(){var r=this.graph;r.removeListener("nodeAdded",this.activeListeners.addNodeGraphUpdate),r.removeListener("nodeDropped",this.activeListeners.dropNodeGraphUpdate),r.removeListener("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),r.removeListener("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),r.removeListener("edgeAdded",this.activeListeners.addEdgeGraphUpdate),r.removeListener("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),r.removeListener("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),r.removeListener("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),r.removeListener("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),r.removeListener("cleared",this.activeListeners.clearGraphUpdate)}},{key:"getEdgeAtPoint",value:function(r,n){var a=Ri(this.webGLContexts.edges,this.frameBuffers.edges,r,n,this.pixelRatio,this.pickingDownSizingRatio),o=Ai.apply(void 0,Ui(a)),s=this.itemIDsIndex[o];return s&&s.type==="edge"?s.id:null}},{key:"process",value:function(){var r=this;this.emit("beforeProcess");var n=this.graph,a=this.settings,o=this.getDimensions();if(this.nodeExtent=Ds(this.graph),!this.settings.autoRescale){var s=o.width,u=o.height,d=this.nodeExtent,h=d.x,l=d.y;this.nodeExtent={x:[(h[0]+h[1])/2-s/2,(h[0]+h[1])/2+s/2],y:[(l[0]+l[1])/2-u/2,(l[0]+l[1])/2+u/2]}}this.normalizationFunction=Ii(this.customBBox||this.nodeExtent);var f=new zi,p=Dt(f.getState(),o,this.getGraphDimensions(),this.getStagePadding());this.labelGrid.resizeAndClear(o,a.labelGridCellSize);for(var v={},m={},E={},C={},_=1,A=n.nodes(),c=0,w=A.length;c<w;c++){var b=A[c],T=this.nodeDataCache[b],O=n.getNodeAttributes(b);T.x=O.x,T.y=O.y,this.normalizationFunction.applyTo(T),typeof T.label=="string"&&!T.hidden&&this.labelGrid.add(b,T.size,this.framedGraphToViewport(T,{matrix:p})),v[T.type]=(v[T.type]||0)+1}this.labelGrid.organize();for(var L in this.nodePrograms){if(!Ye.call(this.nodePrograms,L))throw new Error('Sigma: could not find a suitable program for node type "'.concat(L,'"!'));this.nodePrograms[L].reallocate(v[L]||0),v[L]=0}this.settings.zIndex&&this.nodeZExtent[0]!==this.nodeZExtent[1]&&(A=Ni(this.nodeZExtent,function(ee){return r.nodeDataCache[ee].zIndex},A));for(var k=0,B=A.length;k<B;k++){var P=A[k];m[P]=_,C[m[P]]={type:"node",id:P},_++;var g=this.nodeDataCache[P];this.addNodeToProgram(P,m[P],v[g.type]++)}for(var K={},J=n.edges(),x=0,y=J.length;x<y;x++){var U=J[x],W=this.edgeDataCache[U];K[W.type]=(K[W.type]||0)+1}this.settings.zIndex&&this.edgeZExtent[0]!==this.edgeZExtent[1]&&(J=Ni(this.edgeZExtent,function(ee){return r.edgeDataCache[ee].zIndex},J));for(var Q in this.edgePrograms){if(!Ye.call(this.edgePrograms,Q))throw new Error('Sigma: could not find a suitable program for edge type "'.concat(Q,'"!'));this.edgePrograms[Q].reallocate(K[Q]||0),K[Q]=0}for(var ne=0,X=J.length;ne<X;ne++){var N=J[ne];E[N]=_,C[E[N]]={type:"edge",id:N},_++;var ue=this.edgeDataCache[N];this.addEdgeToProgram(N,E[N],K[ue.type]++)}return this.itemIDsIndex=C,this.nodeIndices=m,this.edgeIndices=E,this.emit("afterProcess"),this}},{key:"handleSettingsUpdate",value:function(r){var n=this,a=this.settings;if(this.camera.minRatio=a.minCameraRatio,this.camera.maxRatio=a.maxCameraRatio,this.camera.enabledZooming=a.enableCameraZooming,this.camera.enabledPanning=a.enableCameraPanning,this.camera.enabledRotation=a.enableCameraRotation,a.cameraPanBoundaries?this.camera.clean=function(h){return n.cleanCameraState(h,a.cameraPanBoundaries&&Ir(a.cameraPanBoundaries)==="object"?a.cameraPanBoundaries:{})}:this.camera.clean=null,this.camera.setState(this.camera.validateState(this.camera.getState())),r){if(r.edgeProgramClasses!==a.edgeProgramClasses){for(var o in a.edgeProgramClasses)a.edgeProgramClasses[o]!==r.edgeProgramClasses[o]&&this.registerEdgeProgram(o,a.edgeProgramClasses[o]);for(var s in r.edgeProgramClasses)a.edgeProgramClasses[s]||this.unregisterEdgeProgram(s)}if(r.nodeProgramClasses!==a.nodeProgramClasses||r.nodeHoverProgramClasses!==a.nodeHoverProgramClasses){for(var u in a.nodeProgramClasses)(a.nodeProgramClasses[u]!==r.nodeProgramClasses[u]||a.nodeHoverProgramClasses[u]!==r.nodeHoverProgramClasses[u])&&this.registerNodeProgram(u,a.nodeProgramClasses[u],a.nodeHoverProgramClasses[u]);for(var d in r.nodeProgramClasses)a.nodeProgramClasses[d]||this.unregisterNodeProgram(d)}}return this.mouseCaptor.setSettings(this.settings),this.touchCaptor.setSettings(this.settings),this}},{key:"cleanCameraState",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.tolerance,o=a===void 0?0:a,s=n.boundaries,u=I({},r),d=s||this.nodeExtent,h=vt(d.x,2),l=h[0],f=h[1],p=vt(d.y,2),v=p[0],m=p[1],E=[this.graphToViewport({x:l,y:v},{cameraState:r}),this.graphToViewport({x:f,y:v},{cameraState:r}),this.graphToViewport({x:l,y:m},{cameraState:r}),this.graphToViewport({x:f,y:m},{cameraState:r})],C=1/0,_=-1/0,A=1/0,c=-1/0;E.forEach(function(K){var J=K.x,x=K.y;C=Math.min(C,J),_=Math.max(_,J),A=Math.min(A,x),c=Math.max(c,x)});var w=_-C,b=c-A,T=this.getDimensions(),O=T.width,L=T.height,k=0,B=0;if(w>=O?_<O-o?k=_-(O-o):C>o&&(k=C-o):_>O+o?k=_-(O+o):C<-o&&(k=C+o),b>=L?c<L-o?B=c-(L-o):A>o&&(B=A-o):c>L+o?B=c-(L+o):A<-o&&(B=A+o),k||B){var P=this.viewportToFramedGraph({x:0,y:0},{cameraState:r}),g=this.viewportToFramedGraph({x:k,y:B},{cameraState:r});k=g.x-P.x,B=g.y-P.y,u.x+=k,u.y+=B}return u}},{key:"renderLabels",value:function(){if(!this.settings.renderLabels)return this;var r=this.camera.getState(),n=this.labelGrid.getLabelsToDisplay(r.ratio,this.settings.labelDensity);$i(n,this.nodesWithForcedLabels),this.displayedNodeLabels=new Set;for(var a=this.canvasContexts.labels,o=0,s=n.length;o<s;o++){var u=n[o],d=this.nodeDataCache[u];if(!this.displayedNodeLabels.has(u)&&!d.hidden){var h=this.framedGraphToViewport(d),l=h.x,f=h.y,p=this.scaleSize(d.size);if(!(!d.forceLabel&&p<this.settings.labelRenderedSizeThreshold)&&!(l<-150||l>this.width+Ks||f<-50||f>this.height+Ys)){this.displayedNodeLabels.add(u);var v=this.settings.defaultDrawNodeLabel,m=this.nodePrograms[d.type],E=(m==null?void 0:m.drawLabel)||v;E(a,I(I({key:u},d),{},{size:p,x:l,y:f}),this.settings)}}}return this}},{key:"renderEdgeLabels",value:function(){if(!this.settings.renderEdgeLabels)return this;var r=this.canvasContexts.edgeLabels;r.clearRect(0,0,this.width,this.height);var n=qs({graph:this.graph,hoveredNode:this.hoveredNode,displayedNodeLabels:this.displayedNodeLabels,highlightedNodes:this.highlightedNodes});$i(n,this.edgesWithForcedLabels);for(var a=new Set,o=0,s=n.length;o<s;o++){var u=n[o],d=this.graph.extremities(u),h=this.nodeDataCache[d[0]],l=this.nodeDataCache[d[1]],f=this.edgeDataCache[u];if(!a.has(u)&&!(f.hidden||h.hidden||l.hidden)){var p=this.settings.defaultDrawEdgeLabel,v=this.edgePrograms[f.type],m=(v==null?void 0:v.drawLabel)||p;m(r,I(I({key:u},f),{},{size:this.scaleSize(f.size)}),I(I(I({key:d[0]},h),this.framedGraphToViewport(h)),{},{size:this.scaleSize(h.size)}),I(I(I({key:d[1]},l),this.framedGraphToViewport(l)),{},{size:this.scaleSize(l.size)}),this.settings),a.add(u)}}return this.displayedEdgeLabels=a,this}},{key:"renderHighlightedNodes",value:function(){var r=this,n=this.canvasContexts.hovers;n.clearRect(0,0,this.width,this.height);var a=function(p){var v=r.nodeDataCache[p],m=r.framedGraphToViewport(v),E=m.x,C=m.y,_=r.scaleSize(v.size),A=r.settings.defaultDrawNodeHover,c=r.nodePrograms[v.type],w=(c==null?void 0:c.drawHover)||A;w(n,I(I({key:p},v),{},{size:_,x:E,y:C}),r.settings)},o=[];this.hoveredNode&&!this.nodeDataCache[this.hoveredNode].hidden&&o.push(this.hoveredNode),this.highlightedNodes.forEach(function(f){f!==r.hoveredNode&&o.push(f)}),o.forEach(function(f){return a(f)});var s={};o.forEach(function(f){var p=r.nodeDataCache[f].type;s[p]=(s[p]||0)+1});for(var u in this.nodeHoverPrograms)this.nodeHoverPrograms[u].reallocate(s[u]||0),s[u]=0;o.forEach(function(f){var p=r.nodeDataCache[f];r.nodeHoverPrograms[p.type].process(0,s[p.type]++,p)}),this.webGLContexts.hoverNodes.clear(this.webGLContexts.hoverNodes.COLOR_BUFFER_BIT);var d=this.getRenderParams();for(var h in this.nodeHoverPrograms){var l=this.nodeHoverPrograms[h];l.render(d)}}},{key:"scheduleHighlightedNodesRender",value:function(){var r=this;this.renderHighlightedNodesFrame||this.renderFrame||(this.renderHighlightedNodesFrame=requestAnimationFrame(function(){r.renderHighlightedNodesFrame=null,r.renderHighlightedNodes(),r.renderEdgeLabels()}))}},{key:"render",value:function(){var r=this;this.emit("beforeRender");var n=function(){return r.emit("afterRender"),r};if(this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.resize(),this.needToProcess&&this.process(),this.needToProcess=!1,this.clear(),this.pickingLayers.forEach(function(E){return r.resetWebGLTexture(E)}),!this.graph.order)return n();var a=this.mouseCaptor,o=this.camera.isAnimated()||a.isMoving||a.draggedEvents||a.currentWheelDirection,s=this.camera.getState(),u=this.getDimensions(),d=this.getGraphDimensions(),h=this.getStagePadding();this.matrix=Dt(s,u,d,h),this.invMatrix=Dt(s,u,d,h,!0),this.correctionRatio=xs(this.matrix,s,u),this.graphToViewportRatio=this.getGraphToViewportRatio();var l=this.getRenderParams();for(var f in this.nodePrograms){var p=this.nodePrograms[f];p.render(l)}if(!this.settings.hideEdgesOnMove||!o)for(var v in this.edgePrograms){var m=this.edgePrograms[v];m.render(l)}return this.settings.hideLabelsOnMove&&o||(this.renderLabels(),this.renderEdgeLabels(),this.renderHighlightedNodes()),n()}},{key:"addNode",value:function(r){var n=Object.assign({},this.graph.getNodeAttributes(r));this.settings.nodeReducer&&(n=this.settings.nodeReducer(r,n));var a=Xs(this.settings,r,n);this.nodeDataCache[r]=a,this.nodesWithForcedLabels.delete(r),a.forceLabel&&!a.hidden&&this.nodesWithForcedLabels.add(r),this.highlightedNodes.delete(r),a.highlighted&&!a.hidden&&this.highlightedNodes.add(r),this.settings.zIndex&&(a.zIndex<this.nodeZExtent[0]&&(this.nodeZExtent[0]=a.zIndex),a.zIndex>this.nodeZExtent[1]&&(this.nodeZExtent[1]=a.zIndex))}},{key:"updateNode",value:function(r){this.addNode(r);var n=this.nodeDataCache[r];this.normalizationFunction.applyTo(n)}},{key:"removeNode",value:function(r){delete this.nodeDataCache[r],delete this.nodeProgramIndex[r],this.highlightedNodes.delete(r),this.hoveredNode===r&&(this.hoveredNode=null),this.nodesWithForcedLabels.delete(r)}},{key:"addEdge",value:function(r){var n=Object.assign({},this.graph.getEdgeAttributes(r));this.settings.edgeReducer&&(n=this.settings.edgeReducer(r,n));var a=Zs(this.settings,r,n);this.edgeDataCache[r]=a,this.edgesWithForcedLabels.delete(r),a.forceLabel&&!a.hidden&&this.edgesWithForcedLabels.add(r),this.settings.zIndex&&(a.zIndex<this.edgeZExtent[0]&&(this.edgeZExtent[0]=a.zIndex),a.zIndex>this.edgeZExtent[1]&&(this.edgeZExtent[1]=a.zIndex))}},{key:"updateEdge",value:function(r){this.addEdge(r)}},{key:"removeEdge",value:function(r){delete this.edgeDataCache[r],delete this.edgeProgramIndex[r],this.hoveredEdge===r&&(this.hoveredEdge=null),this.edgesWithForcedLabels.delete(r)}},{key:"clearNodeIndices",value:function(){this.labelGrid=new Bi,this.nodeExtent={x:[0,1],y:[0,1]},this.nodeDataCache={},this.edgeProgramIndex={},this.nodesWithForcedLabels=new Set,this.nodeZExtent=[1/0,-1/0]}},{key:"clearEdgeIndices",value:function(){this.edgeDataCache={},this.edgeProgramIndex={},this.edgesWithForcedLabels=new Set,this.edgeZExtent=[1/0,-1/0]}},{key:"clearIndices",value:function(){this.clearEdgeIndices(),this.clearNodeIndices()}},{key:"clearNodeState",value:function(){this.displayedNodeLabels=new Set,this.highlightedNodes=new Set,this.hoveredNode=null}},{key:"clearEdgeState",value:function(){this.displayedEdgeLabels=new Set,this.highlightedNodes=new Set,this.hoveredEdge=null}},{key:"clearState",value:function(){this.clearEdgeState(),this.clearNodeState()}},{key:"addNodeToProgram",value:function(r,n,a){var o=this.nodeDataCache[r],s=this.nodePrograms[o.type];if(!s)throw new Error('Sigma: could not find a suitable program for node type "'.concat(o.type,'"!'));s.process(n,a,o),this.nodeProgramIndex[r]=a}},{key:"addEdgeToProgram",value:function(r,n,a){var o=this.edgeDataCache[r],s=this.edgePrograms[o.type];if(!s)throw new Error('Sigma: could not find a suitable program for edge type "'.concat(o.type,'"!'));var u=this.graph.extremities(r),d=this.nodeDataCache[u[0]],h=this.nodeDataCache[u[1]];s.process(n,a,d,h,o),this.edgeProgramIndex[r]=a}},{key:"getRenderParams",value:function(){return{matrix:this.matrix,invMatrix:this.invMatrix,width:this.width,height:this.height,pixelRatio:this.pixelRatio,zoomRatio:this.camera.ratio,cameraAngle:this.camera.angle,sizeRatio:1/this.scaleSize(),correctionRatio:this.correctionRatio,downSizingRatio:this.pickingDownSizingRatio,minEdgeThickness:this.settings.minEdgeThickness,antiAliasingFeather:this.settings.antiAliasingFeather}}},{key:"getStagePadding",value:function(){var r=this.settings,n=r.stagePadding,a=r.autoRescale;return a&&n||0}},{key:"createLayer",value:function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.elements[r])throw new Error('Sigma: a layer named "'.concat(r,'" already exists'));var o=ks(n,{position:"absolute"},{class:"sigma-".concat(r)});return a.style&&Object.assign(o.style,a.style),this.elements[r]=o,"beforeLayer"in a&&a.beforeLayer?this.elements[a.beforeLayer].before(o):"afterLayer"in a&&a.afterLayer?this.elements[a.afterLayer].after(o):this.container.appendChild(o),o}},{key:"createCanvas",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.createLayer(r,"canvas",n)}},{key:"createCanvasContext",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.createCanvas(r,n),o={preserveDrawingBuffer:!1,antialias:!1};return this.canvasContexts[r]=a.getContext("2d",o),this}},{key:"createWebGLContext",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=(n==null?void 0:n.canvas)||this.createCanvas(r,n);n.hidden&&a.remove();var o=I({preserveDrawingBuffer:!1,antialias:!1},n),s;s=a.getContext("webgl2",o),s||(s=a.getContext("webgl",o)),s||(s=a.getContext("experimental-webgl",o));var u=s;if(this.webGLContexts[r]=u,u.blendFunc(u.ONE,u.ONE_MINUS_SRC_ALPHA),n.picking){this.pickingLayers.add(r);var d=u.createFramebuffer();if(!d)throw new Error("Sigma: cannot create a new frame buffer for layer ".concat(r));this.frameBuffers[r]=d}return u}},{key:"killLayer",value:function(r){var n=this.elements[r];if(!n)throw new Error("Sigma: cannot kill layer ".concat(r,", which does not exist"));if(this.webGLContexts[r]){var a,o=this.webGLContexts[r];(a=o.getExtension("WEBGL_lose_context"))===null||a===void 0||a.loseContext(),delete this.webGLContexts[r]}else this.canvasContexts[r]&&delete this.canvasContexts[r];return n.remove(),delete this.elements[r],this}},{key:"getCamera",value:function(){return this.camera}},{key:"setCamera",value:function(r){this.unbindCameraHandlers(),this.camera=r,this.bindCameraHandlers()}},{key:"getContainer",value:function(){return this.container}},{key:"getGraph",value:function(){return this.graph}},{key:"setGraph",value:function(r){r!==this.graph&&(this.hoveredNode&&!r.hasNode(this.hoveredNode)&&(this.hoveredNode=null),this.hoveredEdge&&!r.hasEdge(this.hoveredEdge)&&(this.hoveredEdge=null),this.unbindGraphHandlers(),this.checkEdgesEventsFrame!==null&&(cancelAnimationFrame(this.checkEdgesEventsFrame),this.checkEdgesEventsFrame=null),this.graph=r,this.bindGraphHandlers(),this.refresh())}},{key:"getMouseCaptor",value:function(){return this.mouseCaptor}},{key:"getTouchCaptor",value:function(){return this.touchCaptor}},{key:"getDimensions",value:function(){return{width:this.width,height:this.height}}},{key:"getGraphDimensions",value:function(){var r=this.customBBox||this.nodeExtent;return{width:r.x[1]-r.x[0]||1,height:r.y[1]-r.y[0]||1}}},{key:"getNodeDisplayData",value:function(r){var n=this.nodeDataCache[r];return n?Object.assign({},n):void 0}},{key:"getEdgeDisplayData",value:function(r){var n=this.edgeDataCache[r];return n?Object.assign({},n):void 0}},{key:"getNodeDisplayedLabels",value:function(){return new Set(this.displayedNodeLabels)}},{key:"getEdgeDisplayedLabels",value:function(){return new Set(this.displayedEdgeLabels)}},{key:"getSettings",value:function(){return I({},this.settings)}},{key:"getSetting",value:function(r){return this.settings[r]}},{key:"setSetting",value:function(r,n){var a=I({},this.settings);return this.settings[r]=n,Cr(this.settings),this.handleSettingsUpdate(a),this.scheduleRefresh(),this}},{key:"updateSetting",value:function(r,n){return this.setSetting(r,n(this.settings[r])),this}},{key:"setSettings",value:function(r){var n=I({},this.settings);return this.settings=I(I({},this.settings),r),Cr(this.settings),this.handleSettingsUpdate(n),this.scheduleRefresh(),this}},{key:"resize",value:function(r){var n=this.width,a=this.height;if(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.pixelRatio=Fi(),this.width===0)if(this.settings.allowInvalidContainer)this.width=1;else throw new Error("Sigma: Container has no width. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(this.height===0)if(this.settings.allowInvalidContainer)this.height=1;else throw new Error("Sigma: Container has no height. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(!r&&n===this.width&&a===this.height)return this;for(var o in this.elements){var s=this.elements[o];s.style.width=this.width+"px",s.style.height=this.height+"px"}for(var u in this.canvasContexts)this.elements[u].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[u].setAttribute("height",this.height*this.pixelRatio+"px"),this.pixelRatio!==1&&this.canvasContexts[u].scale(this.pixelRatio,this.pixelRatio);for(var d in this.webGLContexts){this.elements[d].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[d].setAttribute("height",this.height*this.pixelRatio+"px");var h=this.webGLContexts[d];if(h.viewport(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio),this.pickingLayers.has(d)){var l=this.textures[d];l&&h.deleteTexture(l)}}return this.emit("resize"),this}},{key:"clear",value:function(){return this.emit("beforeClear"),this.webGLContexts.nodes.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.nodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.edges.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.edges.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.hoverNodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.canvasContexts.labels.clearRect(0,0,this.width,this.height),this.canvasContexts.hovers.clearRect(0,0,this.width,this.height),this.canvasContexts.edgeLabels.clearRect(0,0,this.width,this.height),this.emit("afterClear"),this}},{key:"refresh",value:function(r){var n=this,a=(r==null?void 0:r.skipIndexation)!==void 0?r==null?void 0:r.skipIndexation:!1,o=(r==null?void 0:r.schedule)!==void 0?r.schedule:!1,s=!r||!r.partialGraph;if(s)this.clearEdgeIndices(),this.clearNodeIndices(),this.graph.forEachNode(function(c){return n.addNode(c)}),this.graph.forEachEdge(function(c){return n.addEdge(c)});else{for(var u,d,h=((u=r.partialGraph)===null||u===void 0?void 0:u.nodes)||[],l=0,f=(h==null?void 0:h.length)||0;l<f;l++){var p=h[l];if(this.updateNode(p),a){var v=this.nodeProgramIndex[p];if(v===void 0)throw new Error('Sigma: node "'.concat(p,`" can't be repaint`));this.addNodeToProgram(p,this.nodeIndices[p],v)}}for(var m=(r==null||(d=r.partialGraph)===null||d===void 0?void 0:d.edges)||[],E=0,C=m.length;E<C;E++){var _=m[E];if(this.updateEdge(_),a){var A=this.edgeProgramIndex[_];if(A===void 0)throw new Error('Sigma: edge "'.concat(_,`" can't be repaint`));this.addEdgeToProgram(_,this.edgeIndices[_],A)}}}return(s||!a)&&(this.needToProcess=!0),o?this.scheduleRender():this.render(),this}},{key:"scheduleRender",value:function(){var r=this;return this.renderFrame||(this.renderFrame=requestAnimationFrame(function(){r.render()})),this}},{key:"scheduleRefresh",value:function(r){return this.refresh(I(I({},r),{},{schedule:!0}))}},{key:"getViewportZoomedState",value:function(r,n){var a=this.camera.getState(),o=a.ratio,s=a.angle,u=a.x,d=a.y,h=this.settings,l=h.minCameraRatio,f=h.maxCameraRatio;typeof f=="number"&&(n=Math.min(n,f)),typeof l=="number"&&(n=Math.max(n,l));var p=n/o,v={x:this.width/2,y:this.height/2},m=this.viewportToFramedGraph(r),E=this.viewportToFramedGraph(v);return{angle:s,x:(m.x-E.x)*(1-p)+u,y:(m.y-E.y)*(1-p)+d,ratio:n}}},{key:"viewRectangle",value:function(){var r=this.viewportToFramedGraph({x:0,y:0}),n=this.viewportToFramedGraph({x:this.width,y:0}),a=this.viewportToFramedGraph({x:0,y:this.height});return{x1:r.x,y1:r.y,x2:n.x,y2:n.y,height:n.y-a.y}}},{key:"framedGraphToViewport",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=!!n.cameraState||!!n.viewportDimensions||!!n.graphDimensions,o=n.matrix?n.matrix:a?Dt(n.cameraState||this.camera.getState(),n.viewportDimensions||this.getDimensions(),n.graphDimensions||this.getGraphDimensions(),n.padding||this.getStagePadding()):this.matrix,s=Nr(o,r);return{x:(1+s.x)*this.width/2,y:(1-s.y)*this.height/2}}},{key:"viewportToFramedGraph",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=!!n.cameraState||!!n.viewportDimensions||!n.graphDimensions,o=n.matrix?n.matrix:a?Dt(n.cameraState||this.camera.getState(),n.viewportDimensions||this.getDimensions(),n.graphDimensions||this.getGraphDimensions(),n.padding||this.getStagePadding(),!0):this.invMatrix,s=Nr(o,{x:r.x/this.width*2-1,y:1-r.y/this.height*2});return isNaN(s.x)&&(s.x=0),isNaN(s.y)&&(s.y=0),s}},{key:"viewportToGraph",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.normalizationFunction.inverse(this.viewportToFramedGraph(r,n))}},{key:"graphToViewport",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.framedGraphToViewport(this.normalizationFunction(r),n)}},{key:"getGraphToViewportRatio",value:function(){var r={x:0,y:0},n={x:1,y:1},a=Math.sqrt(Math.pow(r.x-n.x,2)+Math.pow(r.y-n.y,2)),o=this.graphToViewport(r),s=this.graphToViewport(n),u=Math.sqrt(Math.pow(o.x-s.x,2)+Math.pow(o.y-s.y,2));return u/a}},{key:"getBBox",value:function(){return this.nodeExtent}},{key:"getCustomBBox",value:function(){return this.customBBox}},{key:"setCustomBBox",value:function(r){return this.customBBox=r,this.scheduleRender(),this}},{key:"kill",value:function(){this.emit("kill"),this.removeAllListeners(),this.unbindCameraHandlers(),window.removeEventListener("resize",this.activeListeners.handleResize),this.mouseCaptor.kill(),this.touchCaptor.kill(),this.unbindGraphHandlers(),this.clearIndices(),this.clearState(),this.nodeDataCache={},this.edgeDataCache={},this.highlightedNodes.clear(),this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.renderHighlightedNodesFrame&&(cancelAnimationFrame(this.renderHighlightedNodesFrame),this.renderHighlightedNodesFrame=null);for(var r=this.container;r.firstChild;)r.removeChild(r.firstChild);this.canvasContexts={},this.webGLContexts={},this.elements={};for(var n in this.nodePrograms)this.nodePrograms[n].kill();for(var a in this.nodeHoverPrograms)this.nodeHoverPrograms[a].kill();for(var o in this.edgePrograms)this.edgePrograms[o].kill();this.nodePrograms={},this.nodeHoverPrograms={},this.edgePrograms={};for(var s in this.elements)this.killLayer(s)}},{key:"scaleSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.camera.ratio;return r/this.settings.zoomToSizeRatioFunction(n)*(this.getSetting("itemSizesReference")==="positions"?n*this.graphToViewportRatio:1)}},{key:"getCanvases",value:function(){var r={};for(var n in this.elements)this.elements[n]instanceof HTMLCanvasElement&&(r[n]=this.elements[n]);return r}}])}(Zr),Qs=Js,eu=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;
attribute float a_sourceRadius;
attribute float a_targetRadius;
attribute float a_sourceRadiusCoef;
attribute float a_targetRadiusCoef;

uniform mat3 u_matrix;
uniform float u_zoomRatio;
uniform float u_sizeRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // These first computations are taken from edge.vert.glsl. Please read it to
  // get better comments on what's happening:
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here, we move the point to leave space for the arrow heads:
  // Source arrow head
  float sourceRadius = a_sourceRadius * a_sourceRadiusCoef;
  float sourceDirection = sign(sourceRadius);
  float webGLSourceRadius = sourceDirection * sourceRadius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLSourceArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  vec2 sourceCompensationVector =
    vec2(-sourceDirection * unitNormal.y, sourceDirection * unitNormal.x)
    * (webGLSourceRadius + webGLSourceArrowHeadLength);
    
  // Target arrow head
  float targetRadius = a_targetRadius * a_targetRadiusCoef;
  float targetDirection = sign(targetRadius);
  float webGLTargetRadius = targetDirection * targetRadius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLTargetArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  vec2 targetCompensationVector =
  vec2(-targetDirection * unitNormal.y, targetDirection * unitNormal.x)
    * (webGLTargetRadius + webGLTargetArrowHeadLength);

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness + sourceCompensationVector + targetCompensationVector, 1)).xy, 0, 1);

  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,tu=eu,Bn=WebGLRenderingContext,Hi=Bn.UNSIGNED_BYTE,qe=Bn.FLOAT,ru=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness","u_lengthToThicknessRatio"],iu={lengthToThicknessRatio:Yr.lengthToThicknessRatio};function Hn(i){var e=I(I({},iu),{});return function(t){function r(){return le(this,r),Se(this,r,arguments)}return Ce(r,t),fe(r,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:tu,FRAGMENT_SHADER_SOURCE:Xr,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:ru,ATTRIBUTES:[{name:"a_positionStart",size:2,type:qe},{name:"a_positionEnd",size:2,type:qe},{name:"a_normal",size:2,type:qe},{name:"a_color",size:4,type:Hi,normalized:!0},{name:"a_id",size:4,type:Hi,normalized:!0},{name:"a_sourceRadius",size:1,type:qe},{name:"a_targetRadius",size:1,type:qe}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:qe},{name:"a_normalCoef",size:1,type:qe},{name:"a_sourceRadiusCoef",size:1,type:qe},{name:"a_targetRadiusCoef",size:1,type:qe}],CONSTANT_DATA:[[0,1,-1,0],[0,-1,1,0],[1,1,0,1],[1,1,0,1],[0,-1,1,0],[1,-1,0,-1]]}}},{key:"processVisibleItem",value:function(a,o,s,u,d){var h=d.size||1,l=s.x,f=s.y,p=u.x,v=u.y,m=At(d.color),E=p-l,C=v-f,_=s.size||1,A=u.size||1,c=E*E+C*C,w=0,b=0;c&&(c=1/Math.sqrt(c),w=-C*c*h,b=E*c*h);var T=this.array;T[o++]=l,T[o++]=f,T[o++]=p,T[o++]=v,T[o++]=w,T[o++]=b,T[o++]=m,T[o++]=a,T[o++]=_,T[o++]=A}},{key:"setUniforms",value:function(a,o){var s=o.gl,u=o.uniformLocations,d=u.u_matrix,h=u.u_zoomRatio,l=u.u_feather,f=u.u_pixelRatio,p=u.u_correctionRatio,v=u.u_sizeRatio,m=u.u_minEdgeThickness,E=u.u_lengthToThicknessRatio;s.uniformMatrix3fv(d,!1,a.matrix),s.uniform1f(h,a.zoomRatio),s.uniform1f(v,a.sizeRatio),s.uniform1f(p,a.correctionRatio),s.uniform1f(f,a.pixelRatio),s.uniform1f(l,a.antiAliasingFeather),s.uniform1f(m,a.minEdgeThickness),s.uniform1f(E,e.lengthToThicknessRatio)}}])}(sr)}Hn();function nu(i){return Gn([Hn(),tr(i),tr(I(I({},i),{},{extremity:"source"}))])}nu();var _e="top",Ge="bottom",Oe="right",Te="left",Qr="auto",Ut=[_e,Ge,Oe,Te],mt="start",It="end",au="clippingParents",Wn="viewport",Gt="popper",ou="reference",Wi=Ut.reduce(function(i,e){return i.concat([e+"-"+mt,e+"-"+It])},[]),jn=[].concat(Ut,[Qr]).reduce(function(i,e){return i.concat([e,e+"-"+mt,e+"-"+It])},[]),su="beforeRead",uu="read",du="afterRead",hu="beforeMain",cu="main",lu="afterMain",fu="beforeWrite",pu="write",gu="afterWrite",vu=[su,uu,du,hu,cu,lu,fu,pu,gu];function Me(i){return i?(i.nodeName||"").toLowerCase():null}function Re(i){if(i==null)return window;if(i.toString()!=="[object Window]"){var e=i.ownerDocument;return e&&e.defaultView||window}return i}function ot(i){var e=Re(i).Element;return i instanceof e||i instanceof Element}function ke(i){var e=Re(i).HTMLElement;return i instanceof e||i instanceof HTMLElement}function ei(i){if(typeof ShadowRoot>"u")return!1;var e=Re(i).ShadowRoot;return i instanceof e||i instanceof ShadowRoot}function mu(i){var e=i.state;Object.keys(e.elements).forEach(function(t){var r=e.styles[t]||{},n=e.attributes[t]||{},a=e.elements[t];!ke(a)||!Me(a)||(Object.assign(a.style,r),Object.keys(n).forEach(function(o){var s=n[o];s===!1?a.removeAttribute(o):a.setAttribute(o,s===!0?"":s)}))})}function yu(i){var e=i.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(r){var n=e.elements[r],a=e.attributes[r]||{},o=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:t[r]),s=o.reduce(function(u,d){return u[d]="",u},{});!ke(n)||!Me(n)||(Object.assign(n.style,s),Object.keys(a).forEach(function(u){n.removeAttribute(u)}))})}}const Vn={name:"applyStyles",enabled:!0,phase:"write",fn:mu,effect:yu,requires:["computeStyles"]};function Ue(i){return i.split("-")[0]}var at=Math.max,rr=Math.min,yt=Math.round;function $r(){var i=navigator.userAgentData;return i!=null&&i.brands&&Array.isArray(i.brands)?i.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function qn(){return!/^((?!chrome|android).)*safari/i.test($r())}function bt(i,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var r=i.getBoundingClientRect(),n=1,a=1;e&&ke(i)&&(n=i.offsetWidth>0&&yt(r.width)/i.offsetWidth||1,a=i.offsetHeight>0&&yt(r.height)/i.offsetHeight||1);var o=ot(i)?Re(i):window,s=o.visualViewport,u=!qn()&&t,d=(r.left+(u&&s?s.offsetLeft:0))/n,h=(r.top+(u&&s?s.offsetTop:0))/a,l=r.width/n,f=r.height/a;return{width:l,height:f,top:h,right:d+l,bottom:h+f,left:d,x:d,y:h}}function ti(i){var e=bt(i),t=i.offsetWidth,r=i.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:i.offsetLeft,y:i.offsetTop,width:t,height:r}}function Kn(i,e){var t=e.getRootNode&&e.getRootNode();if(i.contains(e))return!0;if(t&&ei(t)){var r=e;do{if(r&&i.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Ze(i){return Re(i).getComputedStyle(i)}function bu(i){return["table","td","th"].indexOf(Me(i))>=0}function et(i){return((ot(i)?i.ownerDocument:i.document)||window.document).documentElement}function ur(i){return Me(i)==="html"?i:i.assignedSlot||i.parentNode||(ei(i)?i.host:null)||et(i)}function ji(i){return!ke(i)||Ze(i).position==="fixed"?null:i.offsetParent}function wu(i){var e=/firefox/i.test($r()),t=/Trident/i.test($r());if(t&&ke(i)){var r=Ze(i);if(r.position==="fixed")return null}var n=ur(i);for(ei(n)&&(n=n.host);ke(n)&&["html","body"].indexOf(Me(n))<0;){var a=Ze(n);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return n;n=n.parentNode}return null}function Mt(i){for(var e=Re(i),t=ji(i);t&&bu(t)&&Ze(t).position==="static";)t=ji(t);return t&&(Me(t)==="html"||Me(t)==="body"&&Ze(t).position==="static")?e:t||wu(i)||e}function ri(i){return["top","bottom"].indexOf(i)>=0?"x":"y"}function Pt(i,e,t){return at(i,rr(e,t))}function Eu(i,e,t){var r=Pt(i,e,t);return r>t?t:r}function Yn(){return{top:0,right:0,bottom:0,left:0}}function Xn(i){return Object.assign({},Yn(),i)}function Zn(i,e){return e.reduce(function(t,r){return t[r]=i,t},{})}var _u=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Xn(typeof e!="number"?e:Zn(e,Ut))};function Tu(i){var e,t=i.state,r=i.name,n=i.options,a=t.elements.arrow,o=t.modifiersData.popperOffsets,s=Ue(t.placement),u=ri(s),d=[Te,Oe].indexOf(s)>=0,h=d?"height":"width";if(!(!a||!o)){var l=_u(n.padding,t),f=ti(a),p=u==="y"?_e:Te,v=u==="y"?Ge:Oe,m=t.rects.reference[h]+t.rects.reference[u]-o[u]-t.rects.popper[h],E=o[u]-t.rects.reference[u],C=Mt(a),_=C?u==="y"?C.clientHeight||0:C.clientWidth||0:0,A=m/2-E/2,c=l[p],w=_-f[h]-l[v],b=_/2-f[h]/2+A,T=Pt(c,b,w),O=u;t.modifiersData[r]=(e={},e[O]=T,e.centerOffset=T-b,e)}}function Au(i){var e=i.state,t=i.options,r=t.element,n=r===void 0?"[data-popper-arrow]":r;n!=null&&(typeof n=="string"&&(n=e.elements.popper.querySelector(n),!n)||Kn(e.elements.popper,n)&&(e.elements.arrow=n))}const Ru={name:"arrow",enabled:!0,phase:"main",fn:Tu,effect:Au,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function wt(i){return i.split("-")[1]}var Su={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Cu(i,e){var t=i.x,r=i.y,n=e.devicePixelRatio||1;return{x:yt(t*n)/n||0,y:yt(r*n)/n||0}}function Vi(i){var e,t=i.popper,r=i.popperRect,n=i.placement,a=i.variation,o=i.offsets,s=i.position,u=i.gpuAcceleration,d=i.adaptive,h=i.roundOffsets,l=i.isFixed,f=o.x,p=f===void 0?0:f,v=o.y,m=v===void 0?0:v,E=typeof h=="function"?h({x:p,y:m}):{x:p,y:m};p=E.x,m=E.y;var C=o.hasOwnProperty("x"),_=o.hasOwnProperty("y"),A=Te,c=_e,w=window;if(d){var b=Mt(t),T="clientHeight",O="clientWidth";if(b===Re(t)&&(b=et(t),Ze(b).position!=="static"&&s==="absolute"&&(T="scrollHeight",O="scrollWidth")),b=b,n===_e||(n===Te||n===Oe)&&a===It){c=Ge;var L=l&&b===w&&w.visualViewport?w.visualViewport.height:b[T];m-=L-r.height,m*=u?1:-1}if(n===Te||(n===_e||n===Ge)&&a===It){A=Oe;var k=l&&b===w&&w.visualViewport?w.visualViewport.width:b[O];p-=k-r.width,p*=u?1:-1}}var B=Object.assign({position:s},d&&Su),P=h===!0?Cu({x:p,y:m},Re(t)):{x:p,y:m};if(p=P.x,m=P.y,u){var g;return Object.assign({},B,(g={},g[c]=_?"0":"",g[A]=C?"0":"",g.transform=(w.devicePixelRatio||1)<=1?"translate("+p+"px, "+m+"px)":"translate3d("+p+"px, "+m+"px, 0)",g))}return Object.assign({},B,(e={},e[c]=_?m+"px":"",e[A]=C?p+"px":"",e.transform="",e))}function xu(i){var e=i.state,t=i.options,r=t.gpuAcceleration,n=r===void 0?!0:r,a=t.adaptive,o=a===void 0?!0:a,s=t.roundOffsets,u=s===void 0?!0:s,d={placement:Ue(e.placement),variation:wt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:n,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Vi(Object.assign({},d,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:u})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Vi(Object.assign({},d,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Du={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:xu,data:{}};var Zt={passive:!0};function Lu(i){var e=i.state,t=i.instance,r=i.options,n=r.scroll,a=n===void 0?!0:n,o=r.resize,s=o===void 0?!0:o,u=Re(e.elements.popper),d=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&d.forEach(function(h){h.addEventListener("scroll",t.update,Zt)}),s&&u.addEventListener("resize",t.update,Zt),function(){a&&d.forEach(function(h){h.removeEventListener("scroll",t.update,Zt)}),s&&u.removeEventListener("resize",t.update,Zt)}}const ku={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Lu,data:{}};var Gu={left:"right",right:"left",bottom:"top",top:"bottom"};function er(i){return i.replace(/left|right|bottom|top/g,function(e){return Gu[e]})}var Ou={start:"end",end:"start"};function qi(i){return i.replace(/start|end/g,function(e){return Ou[e]})}function ii(i){var e=Re(i),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function ni(i){return bt(et(i)).left+ii(i).scrollLeft}function Pu(i,e){var t=Re(i),r=et(i),n=t.visualViewport,a=r.clientWidth,o=r.clientHeight,s=0,u=0;if(n){a=n.width,o=n.height;var d=qn();(d||!d&&e==="fixed")&&(s=n.offsetLeft,u=n.offsetTop)}return{width:a,height:o,x:s+ni(i),y:u}}function Fu(i){var e,t=et(i),r=ii(i),n=(e=i.ownerDocument)==null?void 0:e.body,a=at(t.scrollWidth,t.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),o=at(t.scrollHeight,t.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),s=-r.scrollLeft+ni(i),u=-r.scrollTop;return Ze(n||t).direction==="rtl"&&(s+=at(t.clientWidth,n?n.clientWidth:0)-a),{width:a,height:o,x:s,y:u}}function ai(i){var e=Ze(i),t=e.overflow,r=e.overflowX,n=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+n+r)}function Jn(i){return["html","body","#document"].indexOf(Me(i))>=0?i.ownerDocument.body:ke(i)&&ai(i)?i:Jn(ur(i))}function Ft(i,e){var t;e===void 0&&(e=[]);var r=Jn(i),n=r===((t=i.ownerDocument)==null?void 0:t.body),a=Re(r),o=n?[a].concat(a.visualViewport||[],ai(r)?r:[]):r,s=e.concat(o);return n?s:s.concat(Ft(ur(o)))}function zr(i){return Object.assign({},i,{left:i.x,top:i.y,right:i.x+i.width,bottom:i.y+i.height})}function Nu(i,e){var t=bt(i,!1,e==="fixed");return t.top=t.top+i.clientTop,t.left=t.left+i.clientLeft,t.bottom=t.top+i.clientHeight,t.right=t.left+i.clientWidth,t.width=i.clientWidth,t.height=i.clientHeight,t.x=t.left,t.y=t.top,t}function Ki(i,e,t){return e===Wn?zr(Pu(i,t)):ot(e)?Nu(e,t):zr(Fu(et(i)))}function Iu(i){var e=Ft(ur(i)),t=["absolute","fixed"].indexOf(Ze(i).position)>=0,r=t&&ke(i)?Mt(i):i;return ot(r)?e.filter(function(n){return ot(n)&&Kn(n,r)&&Me(n)!=="body"}):[]}function $u(i,e,t,r){var n=e==="clippingParents"?Iu(i):[].concat(e),a=[].concat(n,[t]),o=a[0],s=a.reduce(function(u,d){var h=Ki(i,d,r);return u.top=at(h.top,u.top),u.right=rr(h.right,u.right),u.bottom=rr(h.bottom,u.bottom),u.left=at(h.left,u.left),u},Ki(i,o,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function Qn(i){var e=i.reference,t=i.element,r=i.placement,n=r?Ue(r):null,a=r?wt(r):null,o=e.x+e.width/2-t.width/2,s=e.y+e.height/2-t.height/2,u;switch(n){case _e:u={x:o,y:e.y-t.height};break;case Ge:u={x:o,y:e.y+e.height};break;case Oe:u={x:e.x+e.width,y:s};break;case Te:u={x:e.x-t.width,y:s};break;default:u={x:e.x,y:e.y}}var d=n?ri(n):null;if(d!=null){var h=d==="y"?"height":"width";switch(a){case mt:u[d]=u[d]-(e[h]/2-t[h]/2);break;case It:u[d]=u[d]+(e[h]/2-t[h]/2);break}}return u}function $t(i,e){e===void 0&&(e={});var t=e,r=t.placement,n=r===void 0?i.placement:r,a=t.strategy,o=a===void 0?i.strategy:a,s=t.boundary,u=s===void 0?au:s,d=t.rootBoundary,h=d===void 0?Wn:d,l=t.elementContext,f=l===void 0?Gt:l,p=t.altBoundary,v=p===void 0?!1:p,m=t.padding,E=m===void 0?0:m,C=Xn(typeof E!="number"?E:Zn(E,Ut)),_=f===Gt?ou:Gt,A=i.rects.popper,c=i.elements[v?_:f],w=$u(ot(c)?c:c.contextElement||et(i.elements.popper),u,h,o),b=bt(i.elements.reference),T=Qn({reference:b,element:A,placement:n}),O=zr(Object.assign({},A,T)),L=f===Gt?O:b,k={top:w.top-L.top+C.top,bottom:L.bottom-w.bottom+C.bottom,left:w.left-L.left+C.left,right:L.right-w.right+C.right},B=i.modifiersData.offset;if(f===Gt&&B){var P=B[n];Object.keys(k).forEach(function(g){var K=[Oe,Ge].indexOf(g)>=0?1:-1,J=[_e,Ge].indexOf(g)>=0?"y":"x";k[g]+=P[J]*K})}return k}function zu(i,e){e===void 0&&(e={});var t=e,r=t.placement,n=t.boundary,a=t.rootBoundary,o=t.padding,s=t.flipVariations,u=t.allowedAutoPlacements,d=u===void 0?jn:u,h=wt(r),l=h?s?Wi:Wi.filter(function(v){return wt(v)===h}):Ut,f=l.filter(function(v){return d.indexOf(v)>=0});f.length===0&&(f=l);var p=f.reduce(function(v,m){return v[m]=$t(i,{placement:m,boundary:n,rootBoundary:a,padding:o})[Ue(m)],v},{});return Object.keys(p).sort(function(v,m){return p[v]-p[m]})}function Uu(i){if(Ue(i)===Qr)return[];var e=er(i);return[qi(i),e,qi(e)]}function Mu(i){var e=i.state,t=i.options,r=i.name;if(!e.modifiersData[r]._skip){for(var n=t.mainAxis,a=n===void 0?!0:n,o=t.altAxis,s=o===void 0?!0:o,u=t.fallbackPlacements,d=t.padding,h=t.boundary,l=t.rootBoundary,f=t.altBoundary,p=t.flipVariations,v=p===void 0?!0:p,m=t.allowedAutoPlacements,E=e.options.placement,C=Ue(E),_=C===E,A=u||(_||!v?[er(E)]:Uu(E)),c=[E].concat(A).reduce(function(ue,ee){return ue.concat(Ue(ee)===Qr?zu(e,{placement:ee,boundary:h,rootBoundary:l,padding:d,flipVariations:v,allowedAutoPlacements:m}):ee)},[]),w=e.rects.reference,b=e.rects.popper,T=new Map,O=!0,L=c[0],k=0;k<c.length;k++){var B=c[k],P=Ue(B),g=wt(B)===mt,K=[_e,Ge].indexOf(P)>=0,J=K?"width":"height",x=$t(e,{placement:B,boundary:h,rootBoundary:l,altBoundary:f,padding:d}),y=K?g?Oe:Te:g?Ge:_e;w[J]>b[J]&&(y=er(y));var U=er(y),W=[];if(a&&W.push(x[P]<=0),s&&W.push(x[y]<=0,x[U]<=0),W.every(function(ue){return ue})){L=B,O=!1;break}T.set(B,W)}if(O)for(var Q=v?3:1,ne=function(ee){var Ee=c.find(function(ye){var pe=T.get(ye);if(pe)return pe.slice(0,ee).every(function(ge){return ge})});if(Ee)return L=Ee,"break"},X=Q;X>0;X--){var N=ne(X);if(N==="break")break}e.placement!==L&&(e.modifiersData[r]._skip=!0,e.placement=L,e.reset=!0)}}const Bu={name:"flip",enabled:!0,phase:"main",fn:Mu,requiresIfExists:["offset"],data:{_skip:!1}};function Yi(i,e,t){return t===void 0&&(t={x:0,y:0}),{top:i.top-e.height-t.y,right:i.right-e.width+t.x,bottom:i.bottom-e.height+t.y,left:i.left-e.width-t.x}}function Xi(i){return[_e,Oe,Ge,Te].some(function(e){return i[e]>=0})}function Hu(i){var e=i.state,t=i.name,r=e.rects.reference,n=e.rects.popper,a=e.modifiersData.preventOverflow,o=$t(e,{elementContext:"reference"}),s=$t(e,{altBoundary:!0}),u=Yi(o,r),d=Yi(s,n,a),h=Xi(u),l=Xi(d);e.modifiersData[t]={referenceClippingOffsets:u,popperEscapeOffsets:d,isReferenceHidden:h,hasPopperEscaped:l},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":l})}const Wu={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Hu};function ju(i,e,t){var r=Ue(i),n=[Te,_e].indexOf(r)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:i})):t,o=a[0],s=a[1];return o=o||0,s=(s||0)*n,[Te,Oe].indexOf(r)>=0?{x:s,y:o}:{x:o,y:s}}function Vu(i){var e=i.state,t=i.options,r=i.name,n=t.offset,a=n===void 0?[0,0]:n,o=jn.reduce(function(h,l){return h[l]=ju(l,e.rects,a),h},{}),s=o[e.placement],u=s.x,d=s.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=u,e.modifiersData.popperOffsets.y+=d),e.modifiersData[r]=o}const qu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Vu};function Ku(i){var e=i.state,t=i.name;e.modifiersData[t]=Qn({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Yu={name:"popperOffsets",enabled:!0,phase:"read",fn:Ku,data:{}};function Xu(i){return i==="x"?"y":"x"}function Zu(i){var e=i.state,t=i.options,r=i.name,n=t.mainAxis,a=n===void 0?!0:n,o=t.altAxis,s=o===void 0?!1:o,u=t.boundary,d=t.rootBoundary,h=t.altBoundary,l=t.padding,f=t.tether,p=f===void 0?!0:f,v=t.tetherOffset,m=v===void 0?0:v,E=$t(e,{boundary:u,rootBoundary:d,padding:l,altBoundary:h}),C=Ue(e.placement),_=wt(e.placement),A=!_,c=ri(C),w=Xu(c),b=e.modifiersData.popperOffsets,T=e.rects.reference,O=e.rects.popper,L=typeof m=="function"?m(Object.assign({},e.rects,{placement:e.placement})):m,k=typeof L=="number"?{mainAxis:L,altAxis:L}:Object.assign({mainAxis:0,altAxis:0},L),B=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,P={x:0,y:0};if(b){if(a){var g,K=c==="y"?_e:Te,J=c==="y"?Ge:Oe,x=c==="y"?"height":"width",y=b[c],U=y+E[K],W=y-E[J],Q=p?-O[x]/2:0,ne=_===mt?T[x]:O[x],X=_===mt?-O[x]:-T[x],N=e.elements.arrow,ue=p&&N?ti(N):{width:0,height:0},ee=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Yn(),Ee=ee[K],ye=ee[J],pe=Pt(0,T[x],ue[x]),ge=A?T[x]/2-Q-pe-Ee-k.mainAxis:ne-pe-Ee-k.mainAxis,Y=A?-T[x]/2+Q+pe+ye+k.mainAxis:X+pe+ye+k.mainAxis,q=e.elements.arrow&&Mt(e.elements.arrow),V=q?c==="y"?q.clientTop||0:q.clientLeft||0:0,re=(g=B==null?void 0:B[c])!=null?g:0,M=y+ge-re-V,z=y+Y-re,R=Pt(p?rr(U,M):U,y,p?at(W,z):W);b[c]=R,P[c]=R-y}if(s){var ve,me=c==="x"?_e:Te,be=c==="x"?Ge:Oe,oe=b[w],ae=w==="y"?"height":"width",de=oe+E[me],he=oe-E[be],Ae=[_e,Te].indexOf(C)!==-1,Be=(ve=B==null?void 0:B[w])!=null?ve:0,He=Ae?de:oe-T[ae]-O[ae]-Be+k.altAxis,$e=Ae?oe+T[ae]+O[ae]-Be-k.altAxis:he,We=p&&Ae?Eu(He,oe,$e):Pt(p?He:de,oe,p?$e:he);b[w]=We,P[w]=We-oe}e.modifiersData[r]=P}}const Ju={name:"preventOverflow",enabled:!0,phase:"main",fn:Zu,requiresIfExists:["offset"]};function Qu(i){return{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}}function ed(i){return i===Re(i)||!ke(i)?ii(i):Qu(i)}function td(i){var e=i.getBoundingClientRect(),t=yt(e.width)/i.offsetWidth||1,r=yt(e.height)/i.offsetHeight||1;return t!==1||r!==1}function rd(i,e,t){t===void 0&&(t=!1);var r=ke(e),n=ke(e)&&td(e),a=et(e),o=bt(i,n,t),s={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(r||!r&&!t)&&((Me(e)!=="body"||ai(a))&&(s=ed(e)),ke(e)?(u=bt(e,!0),u.x+=e.clientLeft,u.y+=e.clientTop):a&&(u.x=ni(a))),{x:o.left+s.scrollLeft-u.x,y:o.top+s.scrollTop-u.y,width:o.width,height:o.height}}function id(i){var e=new Map,t=new Set,r=[];i.forEach(function(a){e.set(a.name,a)});function n(a){t.add(a.name);var o=[].concat(a.requires||[],a.requiresIfExists||[]);o.forEach(function(s){if(!t.has(s)){var u=e.get(s);u&&n(u)}}),r.push(a)}return i.forEach(function(a){t.has(a.name)||n(a)}),r}function nd(i){var e=id(i);return vu.reduce(function(t,r){return t.concat(e.filter(function(n){return n.phase===r}))},[])}function ad(i){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(i())})})),e}}function od(i){var e=i.reduce(function(t,r){var n=t[r.name];return t[r.name]=n?Object.assign({},n,r,{options:Object.assign({},n.options,r.options),data:Object.assign({},n.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var Zi={placement:"bottom",modifiers:[],strategy:"absolute"};function Ji(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function sd(i){i===void 0&&(i={});var e=i,t=e.defaultModifiers,r=t===void 0?[]:t,n=e.defaultOptions,a=n===void 0?Zi:n;return function(s,u,d){d===void 0&&(d=a);var h={placement:"bottom",orderedModifiers:[],options:Object.assign({},Zi,a),modifiersData:{},elements:{reference:s,popper:u},attributes:{},styles:{}},l=[],f=!1,p={state:h,setOptions:function(C){var _=typeof C=="function"?C(h.options):C;m(),h.options=Object.assign({},a,h.options,_),h.scrollParents={reference:ot(s)?Ft(s):s.contextElement?Ft(s.contextElement):[],popper:Ft(u)};var A=nd(od([].concat(r,h.options.modifiers)));return h.orderedModifiers=A.filter(function(c){return c.enabled}),v(),p.update()},forceUpdate:function(){if(!f){var C=h.elements,_=C.reference,A=C.popper;if(Ji(_,A)){h.rects={reference:rd(_,Mt(A),h.options.strategy==="fixed"),popper:ti(A)},h.reset=!1,h.placement=h.options.placement,h.orderedModifiers.forEach(function(k){return h.modifiersData[k.name]=Object.assign({},k.data)});for(var c=0;c<h.orderedModifiers.length;c++){if(h.reset===!0){h.reset=!1,c=-1;continue}var w=h.orderedModifiers[c],b=w.fn,T=w.options,O=T===void 0?{}:T,L=w.name;typeof b=="function"&&(h=b({state:h,options:O,name:L,instance:p})||h)}}}},update:ad(function(){return new Promise(function(E){p.forceUpdate(),E(h)})}),destroy:function(){m(),f=!0}};if(!Ji(s,u))return p;p.setOptions(d).then(function(E){!f&&d.onFirstUpdate&&d.onFirstUpdate(E)});function v(){h.orderedModifiers.forEach(function(E){var C=E.name,_=E.options,A=_===void 0?{}:_,c=E.effect;if(typeof c=="function"){var w=c({state:h,name:C,instance:p,options:A}),b=function(){};l.push(w||b)}})}function m(){l.forEach(function(E){return E()}),l=[]}return p}}var ud=[ku,Yu,Du,Vn,qu,Bu,Ju,Ru,Wu],dd=sd({defaultModifiers:ud}),hd="tippy-box",ea="tippy-content",cd="tippy-backdrop",ta="tippy-arrow",ra="tippy-svg-arrow",nt={passive:!0,capture:!0},ia=function(){return document.body};function Dr(i,e,t){if(Array.isArray(i)){var r=i[e];return r??(Array.isArray(t)?t[e]:t)}return i}function oi(i,e){var t={}.toString.call(i);return t.indexOf("[object")===0&&t.indexOf(e+"]")>-1}function na(i,e){return typeof i=="function"?i.apply(void 0,e):i}function Qi(i,e){if(e===0)return i;var t;return function(r){clearTimeout(t),t=setTimeout(function(){i(r)},e)}}function ld(i){return i.split(/\s+/).filter(Boolean)}function lt(i){return[].concat(i)}function en(i,e){i.indexOf(e)===-1&&i.push(e)}function fd(i){return i.filter(function(e,t){return i.indexOf(e)===t})}function pd(i){return i.split("-")[0]}function ir(i){return[].slice.call(i)}function tn(i){return Object.keys(i).reduce(function(e,t){return i[t]!==void 0&&(e[t]=i[t]),e},{})}function Nt(){return document.createElement("div")}function dr(i){return["Element","Fragment"].some(function(e){return oi(i,e)})}function gd(i){return oi(i,"NodeList")}function vd(i){return oi(i,"MouseEvent")}function md(i){return!!(i&&i._tippy&&i._tippy.reference===i)}function yd(i){return dr(i)?[i]:gd(i)?ir(i):Array.isArray(i)?i:ir(document.querySelectorAll(i))}function Lr(i,e){i.forEach(function(t){t&&(t.style.transitionDuration=e+"ms")})}function rn(i,e){i.forEach(function(t){t&&t.setAttribute("data-state",e)})}function bd(i){var e,t=lt(i),r=t[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function wd(i,e){var t=e.clientX,r=e.clientY;return i.every(function(n){var a=n.popperRect,o=n.popperState,s=n.props,u=s.interactiveBorder,d=pd(o.placement),h=o.modifiersData.offset;if(!h)return!0;var l=d==="bottom"?h.top.y:0,f=d==="top"?h.bottom.y:0,p=d==="right"?h.left.x:0,v=d==="left"?h.right.x:0,m=a.top-r+l>u,E=r-a.bottom-f>u,C=a.left-t+p>u,_=t-a.right-v>u;return m||E||C||_})}function kr(i,e,t){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(n){i[r](n,t)})}function nn(i,e){for(var t=e;t;){var r;if(i.contains(t))return!0;t=t.getRootNode==null||(r=t.getRootNode())==null?void 0:r.host}return!1}var ze={isTouch:!1},an=0;function Ed(){ze.isTouch||(ze.isTouch=!0,window.performance&&document.addEventListener("mousemove",aa))}function aa(){var i=performance.now();i-an<20&&(ze.isTouch=!1,document.removeEventListener("mousemove",aa)),an=i}function _d(){var i=document.activeElement;if(md(i)){var e=i._tippy;i.blur&&!e.state.isVisible&&i.blur()}}function Td(){document.addEventListener("touchstart",Ed,nt),window.addEventListener("blur",_d)}var Ad=typeof window<"u"&&typeof document<"u",Rd=Ad?!!window.msCrypto:!1,Sd={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},Cd={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},Ie=Object.assign({appendTo:ia,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},Sd,Cd),xd=Object.keys(Ie),Dd=function(e){var t=Object.keys(e);t.forEach(function(r){Ie[r]=e[r]})};function oa(i){var e=i.plugins||[],t=e.reduce(function(r,n){var a=n.name,o=n.defaultValue;if(a){var s;r[a]=i[a]!==void 0?i[a]:(s=Ie[a])!=null?s:o}return r},{});return Object.assign({},i,t)}function Ld(i,e){var t=e?Object.keys(oa(Object.assign({},Ie,{plugins:e}))):xd,r=t.reduce(function(n,a){var o=(i.getAttribute("data-tippy-"+a)||"").trim();if(!o)return n;if(a==="content")n[a]=o;else try{n[a]=JSON.parse(o)}catch{n[a]=o}return n},{});return r}function on(i,e){var t=Object.assign({},e,{content:na(e.content,[i])},e.ignoreAttributes?{}:Ld(i,e.plugins));return t.aria=Object.assign({},Ie.aria,t.aria),t.aria={expanded:t.aria.expanded==="auto"?e.interactive:t.aria.expanded,content:t.aria.content==="auto"?e.interactive?null:"describedby":t.aria.content},t}var kd=function(){return"innerHTML"};function Ur(i,e){i[kd()]=e}function sn(i){var e=Nt();return i===!0?e.className=ta:(e.className=ra,dr(i)?e.appendChild(i):Ur(e,i)),e}function un(i,e){dr(e.content)?(Ur(i,""),i.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?Ur(i,e.content):i.textContent=e.content)}function Mr(i){var e=i.firstElementChild,t=ir(e.children);return{box:e,content:t.find(function(r){return r.classList.contains(ea)}),arrow:t.find(function(r){return r.classList.contains(ta)||r.classList.contains(ra)}),backdrop:t.find(function(r){return r.classList.contains(cd)})}}function sa(i){var e=Nt(),t=Nt();t.className=hd,t.setAttribute("data-state","hidden"),t.setAttribute("tabindex","-1");var r=Nt();r.className=ea,r.setAttribute("data-state","hidden"),un(r,i.props),e.appendChild(t),t.appendChild(r),n(i.props,i.props);function n(a,o){var s=Mr(e),u=s.box,d=s.content,h=s.arrow;o.theme?u.setAttribute("data-theme",o.theme):u.removeAttribute("data-theme"),typeof o.animation=="string"?u.setAttribute("data-animation",o.animation):u.removeAttribute("data-animation"),o.inertia?u.setAttribute("data-inertia",""):u.removeAttribute("data-inertia"),u.style.maxWidth=typeof o.maxWidth=="number"?o.maxWidth+"px":o.maxWidth,o.role?u.setAttribute("role",o.role):u.removeAttribute("role"),(a.content!==o.content||a.allowHTML!==o.allowHTML)&&un(d,i.props),o.arrow?h?a.arrow!==o.arrow&&(u.removeChild(h),u.appendChild(sn(o.arrow))):u.appendChild(sn(o.arrow)):h&&u.removeChild(h)}return{popper:e,onUpdate:n}}sa.$$tippy=!0;var Gd=1,Jt=[],Gr=[];function Od(i,e){var t=on(i,Object.assign({},Ie,oa(tn(e)))),r,n,a,o=!1,s=!1,u=!1,d=!1,h,l,f,p=[],v=Qi(M,t.interactiveDebounce),m,E=Gd++,C=null,_=fd(t.plugins),A={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},c={id:E,reference:i,popper:Nt(),popperInstance:C,props:t,state:A,plugins:_,clearDelayTimeouts:He,setProps:$e,setContent:We,show:je,hide:st,hideWithInteractivity:ut,enable:Ae,disable:Be,unmount:ua,destroy:da};if(!t.render)return c;var w=t.render(c),b=w.popper,T=w.onUpdate;b.setAttribute("data-tippy-root",""),b.id="tippy-"+c.id,c.popper=b,i._tippy=c,b._tippy=c;var O=_.map(function(S){return S.fn(c)}),L=i.hasAttribute("aria-expanded");return q(),Q(),y(),U("onCreate",[c]),t.showOnCreate&&de(),b.addEventListener("mouseenter",function(){c.props.interactive&&c.state.isVisible&&c.clearDelayTimeouts()}),b.addEventListener("mouseleave",function(){c.props.interactive&&c.props.trigger.indexOf("mouseenter")>=0&&K().addEventListener("mousemove",v)}),c;function k(){var S=c.props.touch;return Array.isArray(S)?S:[S,0]}function B(){return k()[0]==="hold"}function P(){var S;return!!((S=c.props.render)!=null&&S.$$tippy)}function g(){return m||i}function K(){var S=g().parentNode;return S?bd(S):document}function J(){return Mr(b)}function x(S){return c.state.isMounted&&!c.state.isVisible||ze.isTouch||h&&h.type==="focus"?0:Dr(c.props.delay,S?0:1,Ie.delay)}function y(S){S===void 0&&(S=!1),b.style.pointerEvents=c.props.interactive&&!S?"":"none",b.style.zIndex=""+c.props.zIndex}function U(S,$,j){if(j===void 0&&(j=!0),O.forEach(function(Z){Z[S]&&Z[S].apply(Z,$)}),j){var te;(te=c.props)[S].apply(te,$)}}function W(){var S=c.props.aria;if(S.content){var $="aria-"+S.content,j=b.id,te=lt(c.props.triggerTarget||i);te.forEach(function(Z){var we=Z.getAttribute($);if(c.state.isVisible)Z.setAttribute($,we?we+" "+j:j);else{var xe=we&&we.replace(j,"").trim();xe?Z.setAttribute($,xe):Z.removeAttribute($)}})}}function Q(){if(!(L||!c.props.aria.expanded)){var S=lt(c.props.triggerTarget||i);S.forEach(function($){c.props.interactive?$.setAttribute("aria-expanded",c.state.isVisible&&$===g()?"true":"false"):$.removeAttribute("aria-expanded")})}}function ne(){K().removeEventListener("mousemove",v),Jt=Jt.filter(function(S){return S!==v})}function X(S){if(!(ze.isTouch&&(u||S.type==="mousedown"))){var $=S.composedPath&&S.composedPath()[0]||S.target;if(!(c.props.interactive&&nn(b,$))){if(lt(c.props.triggerTarget||i).some(function(j){return nn(j,$)})){if(ze.isTouch||c.state.isVisible&&c.props.trigger.indexOf("click")>=0)return}else U("onClickOutside",[c,S]);c.props.hideOnClick===!0&&(c.clearDelayTimeouts(),c.hide(),s=!0,setTimeout(function(){s=!1}),c.state.isMounted||Ee())}}}function N(){u=!0}function ue(){u=!1}function ee(){var S=K();S.addEventListener("mousedown",X,!0),S.addEventListener("touchend",X,nt),S.addEventListener("touchstart",ue,nt),S.addEventListener("touchmove",N,nt)}function Ee(){var S=K();S.removeEventListener("mousedown",X,!0),S.removeEventListener("touchend",X,nt),S.removeEventListener("touchstart",ue,nt),S.removeEventListener("touchmove",N,nt)}function ye(S,$){ge(S,function(){!c.state.isVisible&&b.parentNode&&b.parentNode.contains(b)&&$()})}function pe(S,$){ge(S,$)}function ge(S,$){var j=J().box;function te(Z){Z.target===j&&(kr(j,"remove",te),$())}if(S===0)return $();kr(j,"remove",l),kr(j,"add",te),l=te}function Y(S,$,j){j===void 0&&(j=!1);var te=lt(c.props.triggerTarget||i);te.forEach(function(Z){Z.addEventListener(S,$,j),p.push({node:Z,eventType:S,handler:$,options:j})})}function q(){B()&&(Y("touchstart",re,{passive:!0}),Y("touchend",z,{passive:!0})),ld(c.props.trigger).forEach(function(S){if(S!=="manual")switch(Y(S,re),S){case"mouseenter":Y("mouseleave",z);break;case"focus":Y(Rd?"focusout":"blur",R);break;case"focusin":Y("focusout",R);break}})}function V(){p.forEach(function(S){var $=S.node,j=S.eventType,te=S.handler,Z=S.options;$.removeEventListener(j,te,Z)}),p=[]}function re(S){var $,j=!1;if(!(!c.state.isEnabled||ve(S)||s)){var te=(($=h)==null?void 0:$.type)==="focus";h=S,m=S.currentTarget,Q(),!c.state.isVisible&&vd(S)&&Jt.forEach(function(Z){return Z(S)}),S.type==="click"&&(c.props.trigger.indexOf("mouseenter")<0||o)&&c.props.hideOnClick!==!1&&c.state.isVisible?j=!0:de(S),S.type==="click"&&(o=!j),j&&!te&&he(S)}}function M(S){var $=S.target,j=g().contains($)||b.contains($);if(!(S.type==="mousemove"&&j)){var te=ae().concat(b).map(function(Z){var we,xe=Z._tippy,dt=(we=xe.popperInstance)==null?void 0:we.state;return dt?{popperRect:Z.getBoundingClientRect(),popperState:dt,props:t}:null}).filter(Boolean);wd(te,S)&&(ne(),he(S))}}function z(S){var $=ve(S)||c.props.trigger.indexOf("click")>=0&&o;if(!$){if(c.props.interactive){c.hideWithInteractivity(S);return}he(S)}}function R(S){c.props.trigger.indexOf("focusin")<0&&S.target!==g()||c.props.interactive&&S.relatedTarget&&b.contains(S.relatedTarget)||he(S)}function ve(S){return ze.isTouch?B()!==S.type.indexOf("touch")>=0:!1}function me(){be();var S=c.props,$=S.popperOptions,j=S.placement,te=S.offset,Z=S.getReferenceClientRect,we=S.moveTransition,xe=P()?Mr(b).arrow:null,dt=Z?{getBoundingClientRect:Z,contextElement:Z.contextElement||g()}:i,si={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Ht){var ht=Ht.state;if(P()){var ha=J(),cr=ha.box;["placement","reference-hidden","escaped"].forEach(function(Wt){Wt==="placement"?cr.setAttribute("data-placement",ht.placement):ht.attributes.popper["data-popper-"+Wt]?cr.setAttribute("data-"+Wt,""):cr.removeAttribute("data-"+Wt)}),ht.attributes.popper={}}}},tt=[{name:"offset",options:{offset:te}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!we}},si];P()&&xe&&tt.push({name:"arrow",options:{element:xe,padding:3}}),tt.push.apply(tt,($==null?void 0:$.modifiers)||[]),c.popperInstance=dd(dt,b,Object.assign({},$,{placement:j,onFirstUpdate:f,modifiers:tt}))}function be(){c.popperInstance&&(c.popperInstance.destroy(),c.popperInstance=null)}function oe(){var S=c.props.appendTo,$,j=g();c.props.interactive&&S===ia||S==="parent"?$=j.parentNode:$=na(S,[j]),$.contains(b)||$.appendChild(b),c.state.isMounted=!0,me()}function ae(){return ir(b.querySelectorAll("[data-tippy-root]"))}function de(S){c.clearDelayTimeouts(),S&&U("onTrigger",[c,S]),ee();var $=x(!0),j=k(),te=j[0],Z=j[1];ze.isTouch&&te==="hold"&&Z&&($=Z),$?r=setTimeout(function(){c.show()},$):c.show()}function he(S){if(c.clearDelayTimeouts(),U("onUntrigger",[c,S]),!c.state.isVisible){Ee();return}if(!(c.props.trigger.indexOf("mouseenter")>=0&&c.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(S.type)>=0&&o)){var $=x(!1);$?n=setTimeout(function(){c.state.isVisible&&c.hide()},$):a=requestAnimationFrame(function(){c.hide()})}}function Ae(){c.state.isEnabled=!0}function Be(){c.hide(),c.state.isEnabled=!1}function He(){clearTimeout(r),clearTimeout(n),cancelAnimationFrame(a)}function $e(S){if(!c.state.isDestroyed){U("onBeforeUpdate",[c,S]),V();var $=c.props,j=on(i,Object.assign({},$,tn(S),{ignoreAttributes:!0}));c.props=j,q(),$.interactiveDebounce!==j.interactiveDebounce&&(ne(),v=Qi(M,j.interactiveDebounce)),$.triggerTarget&&!j.triggerTarget?lt($.triggerTarget).forEach(function(te){te.removeAttribute("aria-expanded")}):j.triggerTarget&&i.removeAttribute("aria-expanded"),Q(),y(),T&&T($,j),c.popperInstance&&(me(),ae().forEach(function(te){requestAnimationFrame(te._tippy.popperInstance.forceUpdate)})),U("onAfterUpdate",[c,S])}}function We(S){c.setProps({content:S})}function je(){var S=c.state.isVisible,$=c.state.isDestroyed,j=!c.state.isEnabled,te=ze.isTouch&&!c.props.touch,Z=Dr(c.props.duration,0,Ie.duration);if(!(S||$||j||te)&&!g().hasAttribute("disabled")&&(U("onShow",[c],!1),c.props.onShow(c)!==!1)){if(c.state.isVisible=!0,P()&&(b.style.visibility="visible"),y(),ee(),c.state.isMounted||(b.style.transition="none"),P()){var we=J(),xe=we.box,dt=we.content;Lr([xe,dt],0)}f=function(){var tt;if(!(!c.state.isVisible||d)){if(d=!0,b.offsetHeight,b.style.transition=c.props.moveTransition,P()&&c.props.animation){var hr=J(),Ht=hr.box,ht=hr.content;Lr([Ht,ht],Z),rn([Ht,ht],"visible")}W(),Q(),en(Gr,c),(tt=c.popperInstance)==null||tt.forceUpdate(),U("onMount",[c]),c.props.animation&&P()&&pe(Z,function(){c.state.isShown=!0,U("onShown",[c])})}},oe()}}function st(){var S=!c.state.isVisible,$=c.state.isDestroyed,j=!c.state.isEnabled,te=Dr(c.props.duration,1,Ie.duration);if(!(S||$||j)&&(U("onHide",[c],!1),c.props.onHide(c)!==!1)){if(c.state.isVisible=!1,c.state.isShown=!1,d=!1,o=!1,P()&&(b.style.visibility="hidden"),ne(),Ee(),y(!0),P()){var Z=J(),we=Z.box,xe=Z.content;c.props.animation&&(Lr([we,xe],te),rn([we,xe],"hidden"))}W(),Q(),c.props.animation?P()&&ye(te,c.unmount):c.unmount()}}function ut(S){K().addEventListener("mousemove",v),en(Jt,v),v(S)}function ua(){c.state.isVisible&&c.hide(),c.state.isMounted&&(be(),ae().forEach(function(S){S._tippy.unmount()}),b.parentNode&&b.parentNode.removeChild(b),Gr=Gr.filter(function(S){return S!==c}),c.state.isMounted=!1,U("onHidden",[c]))}function da(){c.state.isDestroyed||(c.clearDelayTimeouts(),c.unmount(),V(),delete i._tippy,c.state.isDestroyed=!0,U("onDestroy",[c]))}}function Bt(i,e){e===void 0&&(e={});var t=Ie.plugins.concat(e.plugins||[]);Td();var r=Object.assign({},e,{plugins:t}),n=yd(i),a=n.reduce(function(o,s){var u=s&&Od(s,r);return u&&o.push(u),o},[]);return dr(i)?a[0]:a}Bt.defaultProps=Ie;Bt.setDefaultProps=Dd;Bt.currentInput=ze;Object.assign({},Vn,{effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow)}});Bt.setDefaultProps({render:sa});const Pd=new URLSearchParams(window.location.search),nr=Pd.get("repo_id");if(!nr)throw document.body.innerHTML='<p style="color:red; padding:1rem;">Error: No repo_id specified in URL.</p>',new Error("Missing repo_id");const dn=document.getElementById("repo-id");dn&&(dn.textContent=nr);const pt=document.getElementById("sigma-container");if(!pt)throw console.error('No element with id="sigma-container" found'),new Error("Missing sigma-container");pt.style.touchAction="none";pt.style.cursor="grab";const ar=document.createElement("div");Object.assign(ar.style,{position:"absolute",pointerEvents:"none",display:"none",background:"rgba(0,0,0,0.8)",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",maxWidth:"200px",zIndex:9999});document.body.appendChild(ar);function Fd(i,e,t,r,n=15){const a=i.getContainer().getBoundingClientRect(),{x:o,y:s}=i.viewportToGraph({x:t-a.left,y:r-a.top});let u=null,d=1/0;return e.forEachNode((h,l)=>{const f=Math.hypot(l.x-o,l.y-s);f<n&&f<d&&(u=h,d=f)}),u}fetch(`/scan/${nr}/latest`).then(i=>{if(!i.ok)throw new Error(`Scan not found (status ${i.status})`);return i.json()}).then(i=>{const e=i.attack_graph??i;if(!Array.isArray(e.nodes))throw new Error("Invalid attack_graph format");const t=new Map;e.nodes.forEach(d=>t.set(String(d.id),d));const r=new qr,n=new Map;e.nodes.filter(d=>d.type==="file").forEach(d=>{const h=String(d.id);r.addNode(h,{label:d.label,filepath:d.filepath,x:Math.random()*100,y:Math.random()*100,size:18,color:"#0074D9",nodeCategory:"file",type:"nodeCircle",_expanded:!1}),n.set(h,(d.children||[]).map(String))});const a=new Map;n.forEach((d,h)=>{d.forEach(l=>a.set(l,h))});const o=new Set;e.links.forEach(d=>{const h=a.get(String(d.source)),l=a.get(String(d.target));if(h&&l&&h!==l){const f=`${h}->${l}`;o.has(f)||(r.addEdgeWithKey(f,h,l,{type:"arrow",color:"rgba(150,150,150,0.8)",size:2,arrowSize:6}),o.add(f))}});const s=new Set(r.edges());Ao.assign(r,{iterations:200,settings:{gravity:1,scalingRatio:4,adjustSizes:!0}}),_i.assign(r,{gridSize:10,nodeMargin:15,scaleNodes:1.2,maxIterations:200});const u=new Qs(r,pt,{settings:{defaultEdgeType:"arrow",minArrowSize:6,defaultEdgeColor:"#ccc",defaultNodeColor:"#0074D9",labelThreshold:16,labelSize:"fixed"},nodeProgramClasses:{nodeCircle:zt},edgeProgramClasses:{arrow:$n}});u.refresh(),u.on("enterNode",({node:d})=>{const h=r.getNodeAttributes(d),l=Object.entries(h).map(([f,p])=>`<tr><th style="text-align:left;padding:2px 4px">${f}</th><td style="padding:2px 4px">${p}</td></tr>`).join("");Bt(ar,{content:`<strong>${h.label}</strong><table>${l}</table>`,allowHTML:!0,interactive:!0,trigger:"manual",placement:"right",animation:"shift-away",arrow:!0,offset:[0,8],theme:"custom",popperOptions:{modifiers:[{name:"preventOverflow",options:{padding:8}},{name:"flip",options:{fallbackPlacements:["right","bottom","top"]}}]}}).show()}),u.on("leaveNode",()=>{var d;return(d=ar._tippy)==null?void 0:d.hide()}),pt.addEventListener("click",d=>{const h=Fd(u,r,d.clientX,d.clientY);if(!h)return;const l=r.getNodeAttributes(h);if(l.nodeCategory!=="file")return;const f=n.get(h)||[],p=10,v=l.size+p+8;if(l._expanded)f.forEach(m=>{const E=`${h}::${m}`;r.hasNode(E)&&r.dropNode(E)}),r.edges().forEach(m=>{s.has(m)||r.dropEdge(m)}),r.setNodeAttribute(h,"_expanded",!1);else{f.forEach((E,C)=>{const _=`${h}::${E}`;if(r.hasNode(_))return;const A=t.get(E)||{},c=2*Math.PI*C/f.length;r.addNode(_,{label:A.label,filepath:A.filepath,x:l.x+Math.cos(c)*v,y:l.y+Math.sin(c)*v,size:p,color:A.vulnerable?"#FF4136":"#2ECC40",nodeCategory:"function",type:"nodeCircle"}),r.addEdgeWithKey(`${h}->${_}`,h,_,{type:"arrow",color:"#FF851B",size:2,arrowSize:8})});const m=new Set(f);e.links.forEach(E=>{const C=String(E.source),_=String(E.target);if(m.has(C)&&m.has(_)){const A=`${h}::${C}`,c=`${h}::${_}`,w=`${A}->${c}`;r.hasEdge(w)||r.addEdgeWithKey(w,A,c,{type:"arrow",color:"#999",size:1,arrowSize:4})}}),r.setNodeAttribute(h,"_expanded",!0)}_i.assign(r,{gridSize:10,nodeMargin:15,scaleNodes:1.2,maxIterations:100}),u.refresh()}),console.log(`✅ Attack graph for repo ${nr} rendered`)}).catch(i=>{console.error(i),pt.innerHTML=`<p style="color:red; padding:1rem;">${i.message}</p>`});
