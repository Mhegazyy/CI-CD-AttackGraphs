import"./modulepreload-polyfill.js";const u=new URLSearchParams(window.location.search),d=u.get("repo_id");if(!d)throw document.getElementById("report-container").innerHTML='<p class="error">Error: repo_id is missing</p>',new Error("Missing repo_id");const i=document.querySelector("a[data-repo-link]");i&&(i.href=`attack_graph.html?repo_id=${d}`);fetch(`/scan/${d}/latest`).then(t=>{if(!t.ok)throw new Error(`No scan found (status ${t.status})`);return t.json()}).then(f).catch(t=>{document.getElementById("report-container").innerHTML=`<p class="error">${t.message}</p>`});function m(t){return t.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/\w\S*/g,o=>o.charAt(0).toUpperCase()+o.slice(1).toLowerCase())}function f(t){const o=document.getElementById("report-container");o.innerHTML="",Object.entries(t).forEach(([h,n])=>{const r=document.createElement("section");r.className="report-section";const p=document.createElement("h2");if(p.textContent=m(h),r.appendChild(p),Array.isArray(n)){const e=document.createElement("ul");e.className="report-list",n.forEach(c=>{const a=document.createElement("li");a.textContent=typeof c=="object"?JSON.stringify(c):c,e.appendChild(a)}),r.appendChild(e)}else if(n!==null&&typeof n=="object"){const e=document.createElement("dl");e.className="report-dl",Object.entries(n).forEach(([c,a])=>{const s=document.createElement("dt");s.textContent=m(c);const l=document.createElement("dd");l.textContent=a,e.appendChild(s),e.appendChild(l)}),r.appendChild(e)}else{const e=document.createElement("p");e.textContent=n,r.appendChild(e)}o.appendChild(r)})}
