(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=e(n);fetch(n.href,o)}})();function Xr(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ht={exports:{}},tr;function Qn(){if(tr)return Ht.exports;tr=1;var r=typeof Reflect=="object"?Reflect:null,t=r&&typeof r.apply=="function"?r.apply:function(b,m,_){return Function.prototype.apply.call(b,m,_)},e;r&&typeof r.ownKeys=="function"?e=r.ownKeys:Object.getOwnPropertySymbols?e=function(b){return Object.getOwnPropertyNames(b).concat(Object.getOwnPropertySymbols(b))}:e=function(b){return Object.getOwnPropertyNames(b)};function i(c){console&&console.warn&&console.warn(c)}var n=Number.isNaN||function(b){return b!==b};function o(){o.init.call(this)}Ht.exports=o,Ht.exports.once=C,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function s(c){if(typeof c!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof c)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(c){if(typeof c!="number"||c<0||n(c))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+c+".");a=c}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(b){if(typeof b!="number"||b<0||n(b))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+b+".");return this._maxListeners=b,this};function u(c){return c._maxListeners===void 0?o.defaultMaxListeners:c._maxListeners}o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(b){for(var m=[],_=1;_<arguments.length;_++)m.push(arguments[_]);var G=b==="error",k=this._events;if(k!==void 0)G=G&&k.error===void 0;else if(!G)return!1;if(G){var O;if(m.length>0&&(O=m[0]),O instanceof Error)throw O;var H=new Error("Unhandled error."+(O?" ("+O.message+")":""));throw H.context=O,H}var F=k[b];if(F===void 0)return!1;if(typeof F=="function")t(F,this,m);else for(var g=F.length,q=y(F,g),_=0;_<g;++_)t(q[_],this,m);return!0};function d(c,b,m,_){var G,k,O;if(s(m),k=c._events,k===void 0?(k=c._events=Object.create(null),c._eventsCount=0):(k.newListener!==void 0&&(c.emit("newListener",b,m.listener?m.listener:m),k=c._events),O=k[b]),O===void 0)O=k[b]=m,++c._eventsCount;else if(typeof O=="function"?O=k[b]=_?[m,O]:[O,m]:_?O.unshift(m):O.push(m),G=u(c),G>0&&O.length>G&&!O.warned){O.warned=!0;var H=new Error("Possible EventEmitter memory leak detected. "+O.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");H.name="MaxListenersExceededWarning",H.emitter=c,H.type=b,H.count=O.length,i(H)}return c}o.prototype.addListener=function(b,m){return d(this,b,m,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(b,m){return d(this,b,m,!0)};function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(c,b,m){var _={fired:!1,wrapFn:void 0,target:c,type:b,listener:m},G=h.bind(_);return G.listener=m,_.wrapFn=G,G}o.prototype.once=function(b,m){return s(m),this.on(b,l(this,b,m)),this},o.prototype.prependOnceListener=function(b,m){return s(m),this.prependListener(b,l(this,b,m)),this},o.prototype.removeListener=function(b,m){var _,G,k,O,H;if(s(m),G=this._events,G===void 0)return this;if(_=G[b],_===void 0)return this;if(_===m||_.listener===m)--this._eventsCount===0?this._events=Object.create(null):(delete G[b],G.removeListener&&this.emit("removeListener",b,_.listener||m));else if(typeof _!="function"){for(k=-1,O=_.length-1;O>=0;O--)if(_[O]===m||_[O].listener===m){H=_[O].listener,k=O;break}if(k<0)return this;k===0?_.shift():w(_,k),_.length===1&&(G[b]=_[0]),G.removeListener!==void 0&&this.emit("removeListener",b,H||m)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(b){var m,_,G;if(_=this._events,_===void 0)return this;if(_.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):_[b]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete _[b]),this;if(arguments.length===0){var k=Object.keys(_),O;for(G=0;G<k.length;++G)O=k[G],O!=="removeListener"&&this.removeAllListeners(O);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(m=_[b],typeof m=="function")this.removeListener(b,m);else if(m!==void 0)for(G=m.length-1;G>=0;G--)this.removeListener(b,m[G]);return this};function f(c,b,m){var _=c._events;if(_===void 0)return[];var G=_[b];return G===void 0?[]:typeof G=="function"?m?[G.listener||G]:[G]:m?E(G):y(G,G.length)}o.prototype.listeners=function(b){return f(this,b,!0)},o.prototype.rawListeners=function(b){return f(this,b,!1)},o.listenerCount=function(c,b){return typeof c.listenerCount=="function"?c.listenerCount(b):p.call(c,b)},o.prototype.listenerCount=p;function p(c){var b=this._events;if(b!==void 0){var m=b[c];if(typeof m=="function")return 1;if(m!==void 0)return m.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]};function y(c,b){for(var m=new Array(b),_=0;_<b;++_)m[_]=c[_];return m}function w(c,b){for(;b+1<c.length;b++)c[b]=c[b+1];c.pop()}function E(c){for(var b=new Array(c.length),m=0;m<b.length;++m)b[m]=c[m].listener||c[m];return b}function C(c,b){return new Promise(function(m,_){function G(O){c.removeListener(b,k),_(O)}function k(){typeof c.removeListener=="function"&&c.removeListener("error",G),m([].slice.call(arguments))}S(c,b,k,{once:!0}),b!=="error"&&T(c,G,{once:!0})})}function T(c,b,m){typeof c.on=="function"&&S(c,"error",b,m)}function S(c,b,m,_){if(typeof c.on=="function")_.once?c.once(b,m):c.on(b,m);else if(typeof c.addEventListener=="function")c.addEventListener(b,function G(k){_.once&&c.removeEventListener(b,G),m(k)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof c)}return Ht.exports}var Zr=Qn();function eo(){const r=arguments[0];for(let t=1,e=arguments.length;t<e;t++)if(arguments[t])for(const i in arguments[t])r[i]=arguments[t][i];return r}let oe=eo;typeof Object.assign=="function"&&(oe=Object.assign);function Ae(r,t,e,i){const n=r._nodes.get(t);let o=null;return n&&(i==="mixed"?o=n.out&&n.out[e]||n.undirected&&n.undirected[e]:i==="directed"?o=n.out&&n.out[e]:o=n.undirected&&n.undirected[e]),o}function ae(r){return typeof r=="object"&&r!==null}function Jr(r){let t;for(t in r)return!1;return!0}function Te(r,t,e){Object.defineProperty(r,t,{enumerable:!1,configurable:!1,writable:!0,value:e})}function Oe(r,t,e){const i={enumerable:!0,configurable:!0};typeof e=="function"?i.get=e:(i.value=e,i.writable=!1),Object.defineProperty(r,t,i)}function ir(r){return!(!ae(r)||r.attributes&&!Array.isArray(r.attributes))}function to(){let r=Math.floor(Math.random()*256)&255;return()=>r++}function Xe(){const r=arguments;let t=null,e=-1;return{[Symbol.iterator](){return this},next(){let i=null;do{if(t===null){if(e++,e>=r.length)return{done:!0};t=r[e][Symbol.iterator]()}if(i=t.next(),i.done){t=null;continue}break}while(!0);return i}}}function bt(){return{[Symbol.iterator](){return this},next(){return{done:!0}}}}class Ii extends Error{constructor(t){super(),this.name="GraphError",this.message=t}}class P extends Ii{constructor(t){super(t),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,P.prototype.constructor)}}class L extends Ii{constructor(t){super(t),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,L.prototype.constructor)}}class B extends Ii{constructor(t){super(t),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,B.prototype.constructor)}}function Qr(r,t){this.key=r,this.attributes=t,this.clear()}Qr.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function en(r,t){this.key=r,this.attributes=t,this.clear()}en.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function tn(r,t){this.key=r,this.attributes=t,this.clear()}tn.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function wt(r,t,e,i,n){this.key=t,this.attributes=n,this.undirected=r,this.source=e,this.target=i}wt.prototype.attach=function(){let r="out",t="in";this.undirected&&(r=t="undirected");const e=this.source.key,i=this.target.key;this.source[r][i]=this,!(this.undirected&&e===i)&&(this.target[t][e]=this)};wt.prototype.attachMulti=function(){let r="out",t="in";const e=this.source.key,i=this.target.key;this.undirected&&(r=t="undirected");const n=this.source[r],o=n[i];if(typeof o>"u"){n[i]=this,this.undirected&&e===i||(this.target[t][e]=this);return}o.previous=this,this.next=o,n[i]=this,this.target[t][e]=this};wt.prototype.detach=function(){const r=this.source.key,t=this.target.key;let e="out",i="in";this.undirected&&(e=i="undirected"),delete this.source[e][t],delete this.target[i][r]};wt.prototype.detachMulti=function(){const r=this.source.key,t=this.target.key;let e="out",i="in";this.undirected&&(e=i="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[e][t],delete this.target[i][r]):(this.next.previous=void 0,this.source[e][t]=this.next,this.target[i][r]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const rn=0,nn=1,io=2,on=3;function Je(r,t,e,i,n,o,a){let s,u,d,h;if(i=""+i,e===rn){if(s=r._nodes.get(i),!s)throw new L(`Graph.${t}: could not find the "${i}" node in the graph.`);d=n,h=o}else if(e===on){if(n=""+n,u=r._edges.get(n),!u)throw new L(`Graph.${t}: could not find the "${n}" edge in the graph.`);const l=u.source.key,f=u.target.key;if(i===l)s=u.target;else if(i===f)s=u.source;else throw new L(`Graph.${t}: the "${i}" node is not attached to the "${n}" edge (${l}, ${f}).`);d=o,h=a}else{if(u=r._edges.get(i),!u)throw new L(`Graph.${t}: could not find the "${i}" edge in the graph.`);e===nn?s=u.source:s=u.target,d=n,h=o}return[s,d,h]}function ro(r,t,e){r.prototype[t]=function(i,n,o){const[a,s]=Je(this,t,e,i,n,o);return a.attributes[s]}}function no(r,t,e){r.prototype[t]=function(i,n){const[o]=Je(this,t,e,i,n);return o.attributes}}function oo(r,t,e){r.prototype[t]=function(i,n,o){const[a,s]=Je(this,t,e,i,n,o);return a.attributes.hasOwnProperty(s)}}function ao(r,t,e){r.prototype[t]=function(i,n,o,a){const[s,u,d]=Je(this,t,e,i,n,o,a);return s.attributes[u]=d,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:u}),this}}function so(r,t,e){r.prototype[t]=function(i,n,o,a){const[s,u,d]=Je(this,t,e,i,n,o,a);if(typeof d!="function")throw new P(`Graph.${t}: updater should be a function.`);const h=s.attributes,l=d(h[u]);return h[u]=l,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:u}),this}}function uo(r,t,e){r.prototype[t]=function(i,n,o){const[a,s]=Je(this,t,e,i,n,o);return delete a.attributes[s],this.emit("nodeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:s}),this}}function ho(r,t,e){r.prototype[t]=function(i,n,o){const[a,s]=Je(this,t,e,i,n,o);if(!ae(s))throw new P(`Graph.${t}: provided attributes are not a plain object.`);return a.attributes=s,this.emit("nodeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function co(r,t,e){r.prototype[t]=function(i,n,o){const[a,s]=Je(this,t,e,i,n,o);if(!ae(s))throw new P(`Graph.${t}: provided attributes are not a plain object.`);return oe(a.attributes,s),this.emit("nodeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:s}),this}}function lo(r,t,e){r.prototype[t]=function(i,n,o){const[a,s]=Je(this,t,e,i,n,o);if(typeof s!="function")throw new P(`Graph.${t}: provided updater is not a function.`);return a.attributes=s(a.attributes),this.emit("nodeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const fo=[{name:r=>`get${r}Attribute`,attacher:ro},{name:r=>`get${r}Attributes`,attacher:no},{name:r=>`has${r}Attribute`,attacher:oo},{name:r=>`set${r}Attribute`,attacher:ao},{name:r=>`update${r}Attribute`,attacher:so},{name:r=>`remove${r}Attribute`,attacher:uo},{name:r=>`replace${r}Attributes`,attacher:ho},{name:r=>`merge${r}Attributes`,attacher:co},{name:r=>`update${r}Attributes`,attacher:lo}];function po(r){fo.forEach(function({name:t,attacher:e}){e(r,t("Node"),rn),e(r,t("Source"),nn),e(r,t("Target"),io),e(r,t("Opposite"),on)})}function go(r,t,e){r.prototype[t]=function(i,n){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new B(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new B(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,s=""+n;if(n=arguments[2],o=Ae(this,a,s,e),!o)throw new L(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new B(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new L(`Graph.${t}: could not find the "${i}" edge in the graph.`)}return o.attributes[n]}}function vo(r,t,e){r.prototype[t]=function(i){let n;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new B(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new B(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+arguments[1];if(n=Ae(this,o,a,e),!n)throw new L(`Graph.${t}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(e!=="mixed")throw new B(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,n=this._edges.get(i),!n)throw new L(`Graph.${t}: could not find the "${i}" edge in the graph.`)}return n.attributes}}function mo(r,t,e){r.prototype[t]=function(i,n){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new B(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new B(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,s=""+n;if(n=arguments[2],o=Ae(this,a,s,e),!o)throw new L(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new B(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new L(`Graph.${t}: could not find the "${i}" edge in the graph.`)}return o.attributes.hasOwnProperty(n)}}function yo(r,t,e){r.prototype[t]=function(i,n,o){let a;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new B(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new B(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+i,u=""+n;if(n=arguments[2],o=arguments[3],a=Ae(this,s,u,e),!a)throw new L(`Graph.${t}: could not find an edge for the given path ("${s}" - "${u}").`)}else{if(e!=="mixed")throw new B(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,a=this._edges.get(i),!a)throw new L(`Graph.${t}: could not find the "${i}" edge in the graph.`)}return a.attributes[n]=o,this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:n}),this}}function bo(r,t,e){r.prototype[t]=function(i,n,o){let a;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new B(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new B(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+i,u=""+n;if(n=arguments[2],o=arguments[3],a=Ae(this,s,u,e),!a)throw new L(`Graph.${t}: could not find an edge for the given path ("${s}" - "${u}").`)}else{if(e!=="mixed")throw new B(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,a=this._edges.get(i),!a)throw new L(`Graph.${t}: could not find the "${i}" edge in the graph.`)}if(typeof o!="function")throw new P(`Graph.${t}: updater should be a function.`);return a.attributes[n]=o(a.attributes[n]),this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:n}),this}}function wo(r,t,e){r.prototype[t]=function(i,n){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new B(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new B(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,s=""+n;if(n=arguments[2],o=Ae(this,a,s,e),!o)throw new L(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new B(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new L(`Graph.${t}: could not find the "${i}" edge in the graph.`)}return delete o.attributes[n],this.emit("edgeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:n}),this}}function Eo(r,t,e){r.prototype[t]=function(i,n){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new B(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new B(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,s=""+n;if(n=arguments[2],o=Ae(this,a,s,e),!o)throw new L(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new B(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new L(`Graph.${t}: could not find the "${i}" edge in the graph.`)}if(!ae(n))throw new P(`Graph.${t}: provided attributes are not a plain object.`);return o.attributes=n,this.emit("edgeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function _o(r,t,e){r.prototype[t]=function(i,n){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new B(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new B(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,s=""+n;if(n=arguments[2],o=Ae(this,a,s,e),!o)throw new L(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new B(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new L(`Graph.${t}: could not find the "${i}" edge in the graph.`)}if(!ae(n))throw new P(`Graph.${t}: provided attributes are not a plain object.`);return oe(o.attributes,n),this.emit("edgeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:n}),this}}function To(r,t,e){r.prototype[t]=function(i,n){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new B(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new B(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,s=""+n;if(n=arguments[2],o=Ae(this,a,s,e),!o)throw new L(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new B(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new L(`Graph.${t}: could not find the "${i}" edge in the graph.`)}if(typeof n!="function")throw new P(`Graph.${t}: provided updater is not a function.`);return o.attributes=n(o.attributes),this.emit("edgeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const Ao=[{name:r=>`get${r}Attribute`,attacher:go},{name:r=>`get${r}Attributes`,attacher:vo},{name:r=>`has${r}Attribute`,attacher:mo},{name:r=>`set${r}Attribute`,attacher:yo},{name:r=>`update${r}Attribute`,attacher:bo},{name:r=>`remove${r}Attribute`,attacher:wo},{name:r=>`replace${r}Attributes`,attacher:Eo},{name:r=>`merge${r}Attributes`,attacher:_o},{name:r=>`update${r}Attributes`,attacher:To}];function Ro(r){Ao.forEach(function({name:t,attacher:e}){e(r,t("Edge"),"mixed"),e(r,t("DirectedEdge"),"directed"),e(r,t("UndirectedEdge"),"undirected")})}const So=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Co(r,t,e,i){let n=!1;for(const o in t){if(o===i)continue;const a=t[o];if(n=e(a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes,a.undirected),r&&n)return a.key}}function Do(r,t,e,i){let n,o,a,s=!1;for(const u in t)if(u!==i){n=t[u];do{if(o=n.source,a=n.target,s=e(n.key,n.attributes,o.key,a.key,o.attributes,a.attributes,n.undirected),r&&s)return n.key;n=n.next}while(n!==void 0)}}function di(r,t){const e=Object.keys(r),i=e.length;let n,o=0;return{[Symbol.iterator](){return this},next(){do if(n)n=n.next;else{if(o>=i)return{done:!0};const a=e[o++];if(a===t){n=void 0;continue}n=r[a]}while(!n);return{done:!1,value:{edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected}}}}}function xo(r,t,e,i){const n=t[e];if(!n)return;const o=n.source,a=n.target;if(i(n.key,n.attributes,o.key,a.key,o.attributes,a.attributes,n.undirected)&&r)return n.key}function Lo(r,t,e,i){let n=t[e];if(!n)return;let o=!1;do{if(o=i(n.key,n.attributes,n.source.key,n.target.key,n.source.attributes,n.target.attributes,n.undirected),r&&o)return n.key;n=n.next}while(n!==void 0)}function hi(r,t){let e=r[t];if(e.next!==void 0)return{[Symbol.iterator](){return this},next(){if(!e)return{done:!0};const n={edge:e.key,attributes:e.attributes,source:e.source.key,target:e.target.key,sourceAttributes:e.source.attributes,targetAttributes:e.target.attributes,undirected:e.undirected};return e=e.next,{done:!1,value:n}}};let i=!1;return{[Symbol.iterator](){return this},next(){return i===!0?{done:!0}:(i=!0,{done:!1,value:{edge:e.key,attributes:e.attributes,source:e.source.key,target:e.target.key,sourceAttributes:e.source.attributes,targetAttributes:e.target.attributes,undirected:e.undirected}})}}}function ko(r,t){if(r.size===0)return[];if(t==="mixed"||t===r.type)return Array.from(r._edges.keys());const e=t==="undirected"?r.undirectedSize:r.directedSize,i=new Array(e),n=t==="undirected",o=r._edges.values();let a=0,s,u;for(;s=o.next(),s.done!==!0;)u=s.value,u.undirected===n&&(i[a++]=u.key);return i}function an(r,t,e,i){if(t.size===0)return;const n=e!=="mixed"&&e!==t.type,o=e==="undirected";let a,s,u=!1;const d=t._edges.values();for(;a=d.next(),a.done!==!0;){if(s=a.value,n&&s.undirected!==o)continue;const{key:h,attributes:l,source:f,target:p}=s;if(u=i(h,l,f.key,p.key,f.attributes,p.attributes,s.undirected),r&&u)return h}}function Go(r,t){if(r.size===0)return bt();const e=t!=="mixed"&&t!==r.type,i=t==="undirected",n=r._edges.values();return{[Symbol.iterator](){return this},next(){let o,a;for(;;){if(o=n.next(),o.done)return o;if(a=o.value,!(e&&a.undirected!==i))break}return{value:{edge:a.key,attributes:a.attributes,source:a.source.key,target:a.target.key,sourceAttributes:a.source.attributes,targetAttributes:a.target.attributes,undirected:a.undirected},done:!1}}}}function $i(r,t,e,i,n,o){const a=t?Do:Co;let s;if(e!=="undirected"&&(i!=="out"&&(s=a(r,n.in,o),r&&s)||i!=="in"&&(s=a(r,n.out,o,i?void 0:n.key),r&&s))||e!=="directed"&&(s=a(r,n.undirected,o),r&&s))return s}function Oo(r,t,e,i){const n=[];return $i(!1,r,t,e,i,function(o){n.push(o)}),n}function Po(r,t,e){let i=bt();return r!=="undirected"&&(t!=="out"&&typeof e.in<"u"&&(i=Xe(i,di(e.in))),t!=="in"&&typeof e.out<"u"&&(i=Xe(i,di(e.out,t?void 0:e.key)))),r!=="directed"&&typeof e.undirected<"u"&&(i=Xe(i,di(e.undirected))),i}function zi(r,t,e,i,n,o,a){const s=e?Lo:xo;let u;if(t!=="undirected"&&(typeof n.in<"u"&&i!=="out"&&(u=s(r,n.in,o,a),r&&u)||typeof n.out<"u"&&i!=="in"&&(i||n.key!==o)&&(u=s(r,n.out,o,a),r&&u))||t!=="directed"&&typeof n.undirected<"u"&&(u=s(r,n.undirected,o,a),r&&u))return u}function Fo(r,t,e,i,n){const o=[];return zi(!1,r,t,e,i,n,function(a){o.push(a)}),o}function No(r,t,e,i){let n=bt();return r!=="undirected"&&(typeof e.in<"u"&&t!=="out"&&i in e.in&&(n=Xe(n,hi(e.in,i))),typeof e.out<"u"&&t!=="in"&&i in e.out&&(t||e.key!==i)&&(n=Xe(n,hi(e.out,i)))),r!=="directed"&&typeof e.undirected<"u"&&i in e.undirected&&(n=Xe(n,hi(e.undirected,i))),n}function Io(r,t){const{name:e,type:i,direction:n}=t;r.prototype[e]=function(o,a){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];if(!arguments.length)return ko(this,i);if(arguments.length===1){o=""+o;const s=this._nodes.get(o);if(typeof s>"u")throw new L(`Graph.${e}: could not find the "${o}" node in the graph.`);return Oo(this.multi,i==="mixed"?this.type:i,n,s)}if(arguments.length===2){o=""+o,a=""+a;const s=this._nodes.get(o);if(!s)throw new L(`Graph.${e}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new L(`Graph.${e}:  could not find the "${a}" target node in the graph.`);return Fo(i,this.multi,n,s,a)}throw new P(`Graph.${e}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function $o(r,t){const{name:e,type:i,direction:n}=t,o="forEach"+e[0].toUpperCase()+e.slice(1,-1);r.prototype[o]=function(d,h,l){if(!(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)){if(arguments.length===1)return l=d,an(!1,this,i,l);if(arguments.length===2){d=""+d,l=h;const f=this._nodes.get(d);if(typeof f>"u")throw new L(`Graph.${o}: could not find the "${d}" node in the graph.`);return $i(!1,this.multi,i==="mixed"?this.type:i,n,f,l)}if(arguments.length===3){d=""+d,h=""+h;const f=this._nodes.get(d);if(!f)throw new L(`Graph.${o}:  could not find the "${d}" source node in the graph.`);if(!this._nodes.has(h))throw new L(`Graph.${o}:  could not find the "${h}" target node in the graph.`);return zi(!1,i,this.multi,n,f,h,l)}throw new P(`Graph.${o}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const a="map"+e[0].toUpperCase()+e.slice(1);r.prototype[a]=function(){const d=Array.prototype.slice.call(arguments),h=d.pop();let l;if(d.length===0){let f=0;i!=="directed"&&(f+=this.undirectedSize),i!=="undirected"&&(f+=this.directedSize),l=new Array(f);let p=0;d.push((y,w,E,C,T,S,c)=>{l[p++]=h(y,w,E,C,T,S,c)})}else l=[],d.push((f,p,y,w,E,C,T)=>{l.push(h(f,p,y,w,E,C,T))});return this[o].apply(this,d),l};const s="filter"+e[0].toUpperCase()+e.slice(1);r.prototype[s]=function(){const d=Array.prototype.slice.call(arguments),h=d.pop(),l=[];return d.push((f,p,y,w,E,C,T)=>{h(f,p,y,w,E,C,T)&&l.push(f)}),this[o].apply(this,d),l};const u="reduce"+e[0].toUpperCase()+e.slice(1);r.prototype[u]=function(){let d=Array.prototype.slice.call(arguments);if(d.length<2||d.length>4)throw new P(`Graph.${u}: invalid number of arguments (expecting 2, 3 or 4 and got ${d.length}).`);if(typeof d[d.length-1]=="function"&&typeof d[d.length-2]!="function")throw new P(`Graph.${u}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let h,l;d.length===2?(h=d[0],l=d[1],d=[]):d.length===3?(h=d[1],l=d[2],d=[d[0]]):d.length===4&&(h=d[2],l=d[3],d=[d[0],d[1]]);let f=l;return d.push((p,y,w,E,C,T,S)=>{f=h(f,p,y,w,E,C,T,S)}),this[o].apply(this,d),f}}function zo(r,t){const{name:e,type:i,direction:n}=t,o="find"+e[0].toUpperCase()+e.slice(1,-1);r.prototype[o]=function(u,d,h){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return!1;if(arguments.length===1)return h=u,an(!0,this,i,h);if(arguments.length===2){u=""+u,h=d;const l=this._nodes.get(u);if(typeof l>"u")throw new L(`Graph.${o}: could not find the "${u}" node in the graph.`);return $i(!0,this.multi,i==="mixed"?this.type:i,n,l,h)}if(arguments.length===3){u=""+u,d=""+d;const l=this._nodes.get(u);if(!l)throw new L(`Graph.${o}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(d))throw new L(`Graph.${o}:  could not find the "${d}" target node in the graph.`);return zi(!0,i,this.multi,n,l,d,h)}throw new P(`Graph.${o}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const a="some"+e[0].toUpperCase()+e.slice(1,-1);r.prototype[a]=function(){const u=Array.prototype.slice.call(arguments),d=u.pop();return u.push((l,f,p,y,w,E,C)=>d(l,f,p,y,w,E,C)),!!this[o].apply(this,u)};const s="every"+e[0].toUpperCase()+e.slice(1,-1);r.prototype[s]=function(){const u=Array.prototype.slice.call(arguments),d=u.pop();return u.push((l,f,p,y,w,E,C)=>!d(l,f,p,y,w,E,C)),!this[o].apply(this,u)}}function Uo(r,t){const{name:e,type:i,direction:n}=t,o=e.slice(0,-1)+"Entries";r.prototype[o]=function(a,s){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return bt();if(!arguments.length)return Go(this,i);if(arguments.length===1){a=""+a;const u=this._nodes.get(a);if(!u)throw new L(`Graph.${o}: could not find the "${a}" node in the graph.`);return Po(i,n,u)}if(arguments.length===2){a=""+a,s=""+s;const u=this._nodes.get(a);if(!u)throw new L(`Graph.${o}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(s))throw new L(`Graph.${o}:  could not find the "${s}" target node in the graph.`);return No(i,n,u,s)}throw new P(`Graph.${o}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Mo(r){So.forEach(t=>{Io(r,t),$o(r,t),zo(r,t),Uo(r,t)})}const Bo=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function ri(){this.A=null,this.B=null}ri.prototype.wrap=function(r){this.A===null?this.A=r:this.B===null&&(this.B=r)};ri.prototype.has=function(r){return this.A!==null&&r in this.A||this.B!==null&&r in this.B};function Tt(r,t,e,i,n){for(const o in i){const a=i[o],s=a.source,u=a.target,d=s===e?u:s;if(t&&t.has(d.key))continue;const h=n(d.key,d.attributes);if(r&&h)return d.key}}function Ui(r,t,e,i,n){if(t!=="mixed"){if(t==="undirected")return Tt(r,null,i,i.undirected,n);if(typeof e=="string")return Tt(r,null,i,i[e],n)}const o=new ri;let a;if(t!=="undirected"){if(e!=="out"){if(a=Tt(r,null,i,i.in,n),r&&a)return a;o.wrap(i.in)}if(e!=="in"){if(a=Tt(r,o,i,i.out,n),r&&a)return a;o.wrap(i.out)}}if(t!=="directed"&&(a=Tt(r,o,i,i.undirected,n),r&&a))return a}function Ho(r,t,e){if(r!=="mixed"){if(r==="undirected")return Object.keys(e.undirected);if(typeof t=="string")return Object.keys(e[t])}const i=[];return Ui(!1,r,t,e,function(n){i.push(n)}),i}function At(r,t,e){const i=Object.keys(e),n=i.length;let o=0;return{[Symbol.iterator](){return this},next(){let a=null;do{if(o>=n)return r&&r.wrap(e),{done:!0};const s=e[i[o++]],u=s.source,d=s.target;if(a=u===t?d:u,r&&r.has(a.key)){a=null;continue}}while(a===null);return{done:!1,value:{neighbor:a.key,attributes:a.attributes}}}}}function Wo(r,t,e){if(r!=="mixed"){if(r==="undirected")return At(null,e,e.undirected);if(typeof t=="string")return At(null,e,e[t])}let i=bt();const n=new ri;return r!=="undirected"&&(t!=="out"&&(i=Xe(i,At(n,e,e.in))),t!=="in"&&(i=Xe(i,At(n,e,e.out)))),r!=="directed"&&(i=Xe(i,At(n,e,e.undirected))),i}function jo(r,t){const{name:e,type:i,direction:n}=t;r.prototype[e]=function(o){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];o=""+o;const a=this._nodes.get(o);if(typeof a>"u")throw new L(`Graph.${e}: could not find the "${o}" node in the graph.`);return Ho(i==="mixed"?this.type:i,n,a)}}function Vo(r,t){const{name:e,type:i,direction:n}=t,o="forEach"+e[0].toUpperCase()+e.slice(1,-1);r.prototype[o]=function(d,h){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;d=""+d;const l=this._nodes.get(d);if(typeof l>"u")throw new L(`Graph.${o}: could not find the "${d}" node in the graph.`);Ui(!1,i==="mixed"?this.type:i,n,l,h)};const a="map"+e[0].toUpperCase()+e.slice(1);r.prototype[a]=function(d,h){const l=[];return this[o](d,(f,p)=>{l.push(h(f,p))}),l};const s="filter"+e[0].toUpperCase()+e.slice(1);r.prototype[s]=function(d,h){const l=[];return this[o](d,(f,p)=>{h(f,p)&&l.push(f)}),l};const u="reduce"+e[0].toUpperCase()+e.slice(1);r.prototype[u]=function(d,h,l){if(arguments.length<3)throw new P(`Graph.${u}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let f=l;return this[o](d,(p,y)=>{f=h(f,p,y)}),f}}function qo(r,t){const{name:e,type:i,direction:n}=t,o=e[0].toUpperCase()+e.slice(1,-1),a="find"+o;r.prototype[a]=function(d,h){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;d=""+d;const l=this._nodes.get(d);if(typeof l>"u")throw new L(`Graph.${a}: could not find the "${d}" node in the graph.`);return Ui(!0,i==="mixed"?this.type:i,n,l,h)};const s="some"+o;r.prototype[s]=function(d,h){return!!this[a](d,h)};const u="every"+o;r.prototype[u]=function(d,h){return!this[a](d,(f,p)=>!h(f,p))}}function Ko(r,t){const{name:e,type:i,direction:n}=t,o=e.slice(0,-1)+"Entries";r.prototype[o]=function(a){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return bt();a=""+a;const s=this._nodes.get(a);if(typeof s>"u")throw new L(`Graph.${o}: could not find the "${a}" node in the graph.`);return Wo(i==="mixed"?this.type:i,n,s)}}function Yo(r){Bo.forEach(t=>{jo(r,t),Vo(r,t),qo(r,t),Ko(r,t)})}function Wt(r,t,e,i,n){const o=i._nodes.values(),a=i.type;let s,u,d,h,l,f;for(;s=o.next(),s.done!==!0;){let p=!1;if(u=s.value,a!=="undirected"){h=u.out;for(d in h){l=h[d];do f=l.target,p=!0,n(u.key,f.key,u.attributes,f.attributes,l.key,l.attributes,l.undirected),l=l.next;while(l)}}if(a!=="directed"){h=u.undirected;for(d in h)if(!(t&&u.key>d)){l=h[d];do f=l.target,f.key!==d&&(f=l.source),p=!0,n(u.key,f.key,u.attributes,f.attributes,l.key,l.attributes,l.undirected),l=l.next;while(l)}}e&&!p&&n(u.key,null,u.attributes,null,null,null,null)}}function Xo(r,t){const e={key:r};return Jr(t.attributes)||(e.attributes=oe({},t.attributes)),e}function Zo(r,t,e){const i={key:t,source:e.source.key,target:e.target.key};return Jr(e.attributes)||(i.attributes=oe({},e.attributes)),r==="mixed"&&e.undirected&&(i.undirected=!0),i}function Jo(r){if(!ae(r))throw new P('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in r))throw new P("Graph.import: serialized node is missing its key.");if("attributes"in r&&(!ae(r.attributes)||r.attributes===null))throw new P("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function Qo(r){if(!ae(r))throw new P('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in r))throw new P("Graph.import: serialized edge is missing its source.");if(!("target"in r))throw new P("Graph.import: serialized edge is missing its target.");if("attributes"in r&&(!ae(r.attributes)||r.attributes===null))throw new P("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in r&&typeof r.undirected!="boolean")throw new P("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const ea=to(),ta=new Set(["directed","undirected","mixed"]),rr=new Set(["domain","_events","_eventsCount","_maxListeners"]),ia=[{name:r=>`${r}Edge`,generateKey:!0},{name:r=>`${r}DirectedEdge`,generateKey:!0,type:"directed"},{name:r=>`${r}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:r=>`${r}EdgeWithKey`},{name:r=>`${r}DirectedEdgeWithKey`,type:"directed"},{name:r=>`${r}UndirectedEdgeWithKey`,type:"undirected"}],ra={allowSelfLoops:!0,multi:!1,type:"mixed"};function na(r,t,e){if(e&&!ae(e))throw new P(`Graph.addNode: invalid attributes. Expecting an object but got "${e}"`);if(t=""+t,e=e||{},r._nodes.has(t))throw new B(`Graph.addNode: the "${t}" node already exist in the graph.`);const i=new r.NodeDataClass(t,e);return r._nodes.set(t,i),r.emit("nodeAdded",{key:t,attributes:e}),i}function nr(r,t,e){const i=new r.NodeDataClass(t,e);return r._nodes.set(t,i),r.emit("nodeAdded",{key:t,attributes:e}),i}function sn(r,t,e,i,n,o,a,s){if(!i&&r.type==="undirected")throw new B(`Graph.${t}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(i&&r.type==="directed")throw new B(`Graph.${t}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(s&&!ae(s))throw new P(`Graph.${t}: invalid attributes. Expecting an object but got "${s}"`);if(o=""+o,a=""+a,s=s||{},!r.allowSelfLoops&&o===a)throw new B(`Graph.${t}: source & target are the same ("${o}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const u=r._nodes.get(o),d=r._nodes.get(a);if(!u)throw new L(`Graph.${t}: source node "${o}" not found.`);if(!d)throw new L(`Graph.${t}: target node "${a}" not found.`);const h={key:null,undirected:i,source:o,target:a,attributes:s};if(e)n=r._edgeKeyGenerator();else if(n=""+n,r._edges.has(n))throw new B(`Graph.${t}: the "${n}" edge already exists in the graph.`);if(!r.multi&&(i?typeof u.undirected[a]<"u":typeof u.out[a]<"u"))throw new B(`Graph.${t}: an edge linking "${o}" to "${a}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const l=new wt(i,n,u,d,s);r._edges.set(n,l);const f=o===a;return i?(u.undirectedDegree++,d.undirectedDegree++,f&&(u.undirectedLoops++,r._undirectedSelfLoopCount++)):(u.outDegree++,d.inDegree++,f&&(u.directedLoops++,r._directedSelfLoopCount++)),r.multi?l.attachMulti():l.attach(),i?r._undirectedSize++:r._directedSize++,h.key=n,r.emit("edgeAdded",h),n}function oa(r,t,e,i,n,o,a,s,u){if(!i&&r.type==="undirected")throw new B(`Graph.${t}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(i&&r.type==="directed")throw new B(`Graph.${t}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(s){if(u){if(typeof s!="function")throw new P(`Graph.${t}: invalid updater function. Expecting a function but got "${s}"`)}else if(!ae(s))throw new P(`Graph.${t}: invalid attributes. Expecting an object but got "${s}"`)}o=""+o,a=""+a;let d;if(u&&(d=s,s=void 0),!r.allowSelfLoops&&o===a)throw new B(`Graph.${t}: source & target are the same ("${o}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let h=r._nodes.get(o),l=r._nodes.get(a),f,p;if(!e&&(f=r._edges.get(n),f)){if((f.source.key!==o||f.target.key!==a)&&(!i||f.source.key!==a||f.target.key!==o))throw new B(`Graph.${t}: inconsistency detected when attempting to merge the "${n}" edge with "${o}" source & "${a}" target vs. ("${f.source.key}", "${f.target.key}").`);p=f}if(!p&&!r.multi&&h&&(p=i?h.undirected[a]:h.out[a]),p){const T=[p.key,!1,!1,!1];if(u?!d:!s)return T;if(u){const S=p.attributes;p.attributes=d(S),r.emit("edgeAttributesUpdated",{type:"replace",key:p.key,attributes:p.attributes})}else oe(p.attributes,s),r.emit("edgeAttributesUpdated",{type:"merge",key:p.key,attributes:p.attributes,data:s});return T}s=s||{},u&&d&&(s=d(s));const y={key:null,undirected:i,source:o,target:a,attributes:s};if(e)n=r._edgeKeyGenerator();else if(n=""+n,r._edges.has(n))throw new B(`Graph.${t}: the "${n}" edge already exists in the graph.`);let w=!1,E=!1;h||(h=nr(r,o,{}),w=!0,o===a&&(l=h,E=!0)),l||(l=nr(r,a,{}),E=!0),f=new wt(i,n,h,l,s),r._edges.set(n,f);const C=o===a;return i?(h.undirectedDegree++,l.undirectedDegree++,C&&(h.undirectedLoops++,r._undirectedSelfLoopCount++)):(h.outDegree++,l.inDegree++,C&&(h.directedLoops++,r._directedSelfLoopCount++)),r.multi?f.attachMulti():f.attach(),i?r._undirectedSize++:r._directedSize++,y.key=n,r.emit("edgeAdded",y),[n,!0,w,E]}function ht(r,t){r._edges.delete(t.key);const{source:e,target:i,attributes:n}=t,o=t.undirected,a=e===i;o?(e.undirectedDegree--,i.undirectedDegree--,a&&(e.undirectedLoops--,r._undirectedSelfLoopCount--)):(e.outDegree--,i.inDegree--,a&&(e.directedLoops--,r._directedSelfLoopCount--)),r.multi?t.detachMulti():t.detach(),o?r._undirectedSize--:r._directedSize--,r.emit("edgeDropped",{key:t.key,attributes:n,source:e.key,target:i.key,undirected:o})}class te extends Zr.EventEmitter{constructor(t){if(super(),t=oe({},ra,t),typeof t.multi!="boolean")throw new P(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${t.multi}".`);if(!ta.has(t.type))throw new P(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${t.type}".`);if(typeof t.allowSelfLoops!="boolean")throw new P(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${t.allowSelfLoops}".`);const e=t.type==="mixed"?Qr:t.type==="directed"?en:tn;Te(this,"NodeDataClass",e);const i="geid_"+ea()+"_";let n=0;const o=()=>{let a;do a=i+n++;while(this._edges.has(a));return a};Te(this,"_attributes",{}),Te(this,"_nodes",new Map),Te(this,"_edges",new Map),Te(this,"_directedSize",0),Te(this,"_undirectedSize",0),Te(this,"_directedSelfLoopCount",0),Te(this,"_undirectedSelfLoopCount",0),Te(this,"_edgeKeyGenerator",o),Te(this,"_options",t),rr.forEach(a=>Te(this,a,this[a])),Oe(this,"order",()=>this._nodes.size),Oe(this,"size",()=>this._edges.size),Oe(this,"directedSize",()=>this._directedSize),Oe(this,"undirectedSize",()=>this._undirectedSize),Oe(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),Oe(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),Oe(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),Oe(this,"multi",this._options.multi),Oe(this,"type",this._options.type),Oe(this,"allowSelfLoops",this._options.allowSelfLoops),Oe(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(t){return this._nodes.has(""+t)}hasDirectedEdge(t,e){if(this.type==="undirected")return!1;if(arguments.length===1){const i=""+t,n=this._edges.get(i);return!!n&&!n.undirected}else if(arguments.length===2){t=""+t,e=""+e;const i=this._nodes.get(t);return i?i.out.hasOwnProperty(e):!1}throw new P(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(t,e){if(this.type==="directed")return!1;if(arguments.length===1){const i=""+t,n=this._edges.get(i);return!!n&&n.undirected}else if(arguments.length===2){t=""+t,e=""+e;const i=this._nodes.get(t);return i?i.undirected.hasOwnProperty(e):!1}throw new P(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(t,e){if(arguments.length===1){const i=""+t;return this._edges.has(i)}else if(arguments.length===2){t=""+t,e=""+e;const i=this._nodes.get(t);return i?typeof i.out<"u"&&i.out.hasOwnProperty(e)||typeof i.undirected<"u"&&i.undirected.hasOwnProperty(e):!1}throw new P(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(t,e){if(this.type==="undirected")return;if(t=""+t,e=""+e,this.multi)throw new B("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const i=this._nodes.get(t);if(!i)throw new L(`Graph.directedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(e))throw new L(`Graph.directedEdge: could not find the "${e}" target node in the graph.`);const n=i.out&&i.out[e]||void 0;if(n)return n.key}undirectedEdge(t,e){if(this.type==="directed")return;if(t=""+t,e=""+e,this.multi)throw new B("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const i=this._nodes.get(t);if(!i)throw new L(`Graph.undirectedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(e))throw new L(`Graph.undirectedEdge: could not find the "${e}" target node in the graph.`);const n=i.undirected&&i.undirected[e]||void 0;if(n)return n.key}edge(t,e){if(this.multi)throw new B("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");t=""+t,e=""+e;const i=this._nodes.get(t);if(!i)throw new L(`Graph.edge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(e))throw new L(`Graph.edge: could not find the "${e}" target node in the graph.`);const n=i.out&&i.out[e]||i.undirected&&i.undirected[e]||void 0;if(n)return n.key}areDirectedNeighbors(t,e){t=""+t,e=""+e;const i=this._nodes.get(t);if(!i)throw new L(`Graph.areDirectedNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:e in i.in||e in i.out}areOutNeighbors(t,e){t=""+t,e=""+e;const i=this._nodes.get(t);if(!i)throw new L(`Graph.areOutNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:e in i.out}areInNeighbors(t,e){t=""+t,e=""+e;const i=this._nodes.get(t);if(!i)throw new L(`Graph.areInNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:e in i.in}areUndirectedNeighbors(t,e){t=""+t,e=""+e;const i=this._nodes.get(t);if(!i)throw new L(`Graph.areUndirectedNeighbors: could not find the "${t}" node in the graph.`);return this.type==="directed"?!1:e in i.undirected}areNeighbors(t,e){t=""+t,e=""+e;const i=this._nodes.get(t);if(!i)throw new L(`Graph.areNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&(e in i.in||e in i.out)||this.type!=="directed"&&e in i.undirected}areInboundNeighbors(t,e){t=""+t,e=""+e;const i=this._nodes.get(t);if(!i)throw new L(`Graph.areInboundNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&e in i.in||this.type!=="directed"&&e in i.undirected}areOutboundNeighbors(t,e){t=""+t,e=""+e;const i=this._nodes.get(t);if(!i)throw new L(`Graph.areOutboundNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&e in i.out||this.type!=="directed"&&e in i.undirected}inDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.inDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.inDegree}outDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.outDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.outDegree}directedDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.directedDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.inDegree+e.outDegree}undirectedDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.undirectedDegree: could not find the "${t}" node in the graph.`);return this.type==="directed"?0:e.undirectedDegree}inboundDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.inboundDegree: could not find the "${t}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=e.undirectedDegree),this.type!=="undirected"&&(i+=e.inDegree),i}outboundDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.outboundDegree: could not find the "${t}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=e.undirectedDegree),this.type!=="undirected"&&(i+=e.outDegree),i}degree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.degree: could not find the "${t}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=e.undirectedDegree),this.type!=="undirected"&&(i+=e.inDegree+e.outDegree),i}inDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.inDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.inDegree-e.directedLoops}outDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.outDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.outDegree-e.directedLoops}directedDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.directedDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.inDegree+e.outDegree-e.directedLoops*2}undirectedDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="directed"?0:e.undirectedDegree-e.undirectedLoops*2}inboundDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let i=0,n=0;return this.type!=="directed"&&(i+=e.undirectedDegree,n+=e.undirectedLoops*2),this.type!=="undirected"&&(i+=e.inDegree,n+=e.directedLoops),i-n}outboundDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let i=0,n=0;return this.type!=="directed"&&(i+=e.undirectedDegree,n+=e.undirectedLoops*2),this.type!=="undirected"&&(i+=e.outDegree,n+=e.directedLoops),i-n}degreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.degreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let i=0,n=0;return this.type!=="directed"&&(i+=e.undirectedDegree,n+=e.undirectedLoops*2),this.type!=="undirected"&&(i+=e.inDegree+e.outDegree,n+=e.directedLoops*2),i-n}source(t){t=""+t;const e=this._edges.get(t);if(!e)throw new L(`Graph.source: could not find the "${t}" edge in the graph.`);return e.source.key}target(t){t=""+t;const e=this._edges.get(t);if(!e)throw new L(`Graph.target: could not find the "${t}" edge in the graph.`);return e.target.key}extremities(t){t=""+t;const e=this._edges.get(t);if(!e)throw new L(`Graph.extremities: could not find the "${t}" edge in the graph.`);return[e.source.key,e.target.key]}opposite(t,e){t=""+t,e=""+e;const i=this._edges.get(e);if(!i)throw new L(`Graph.opposite: could not find the "${e}" edge in the graph.`);const n=i.source.key,o=i.target.key;if(t===n)return o;if(t===o)return n;throw new L(`Graph.opposite: the "${t}" node is not attached to the "${e}" edge (${n}, ${o}).`)}hasExtremity(t,e){t=""+t,e=""+e;const i=this._edges.get(t);if(!i)throw new L(`Graph.hasExtremity: could not find the "${t}" edge in the graph.`);return i.source.key===e||i.target.key===e}isUndirected(t){t=""+t;const e=this._edges.get(t);if(!e)throw new L(`Graph.isUndirected: could not find the "${t}" edge in the graph.`);return e.undirected}isDirected(t){t=""+t;const e=this._edges.get(t);if(!e)throw new L(`Graph.isDirected: could not find the "${t}" edge in the graph.`);return!e.undirected}isSelfLoop(t){t=""+t;const e=this._edges.get(t);if(!e)throw new L(`Graph.isSelfLoop: could not find the "${t}" edge in the graph.`);return e.source===e.target}addNode(t,e){return na(this,t,e).key}mergeNode(t,e){if(e&&!ae(e))throw new P(`Graph.mergeNode: invalid attributes. Expecting an object but got "${e}"`);t=""+t,e=e||{};let i=this._nodes.get(t);return i?(e&&(oe(i.attributes,e),this.emit("nodeAttributesUpdated",{type:"merge",key:t,attributes:i.attributes,data:e})),[t,!1]):(i=new this.NodeDataClass(t,e),this._nodes.set(t,i),this.emit("nodeAdded",{key:t,attributes:e}),[t,!0])}updateNode(t,e){if(e&&typeof e!="function")throw new P(`Graph.updateNode: invalid updater function. Expecting a function but got "${e}"`);t=""+t;let i=this._nodes.get(t);if(i){if(e){const o=i.attributes;i.attributes=e(o),this.emit("nodeAttributesUpdated",{type:"replace",key:t,attributes:i.attributes})}return[t,!1]}const n=e?e({}):{};return i=new this.NodeDataClass(t,n),this._nodes.set(t,i),this.emit("nodeAdded",{key:t,attributes:n}),[t,!0]}dropNode(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new L(`Graph.dropNode: could not find the "${t}" node in the graph.`);let i;if(this.type!=="undirected"){for(const n in e.out){i=e.out[n];do ht(this,i),i=i.next;while(i)}for(const n in e.in){i=e.in[n];do ht(this,i),i=i.next;while(i)}}if(this.type!=="directed")for(const n in e.undirected){i=e.undirected[n];do ht(this,i),i=i.next;while(i)}this._nodes.delete(t),this.emit("nodeDropped",{key:t,attributes:e.attributes})}dropEdge(t){let e;if(arguments.length>1){const i=""+arguments[0],n=""+arguments[1];if(e=Ae(this,i,n,this.type),!e)throw new L(`Graph.dropEdge: could not find the "${i}" -> "${n}" edge in the graph.`)}else if(t=""+t,e=this._edges.get(t),!e)throw new L(`Graph.dropEdge: could not find the "${t}" edge in the graph.`);return ht(this,e),this}dropDirectedEdge(t,e){if(arguments.length<2)throw new B("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new B("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");t=""+t,e=""+e;const i=Ae(this,t,e,"directed");if(!i)throw new L(`Graph.dropDirectedEdge: could not find a "${t}" -> "${e}" edge in the graph.`);return ht(this,i),this}dropUndirectedEdge(t,e){if(arguments.length<2)throw new B("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new B("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const i=Ae(this,t,e,"undirected");if(!i)throw new L(`Graph.dropUndirectedEdge: could not find a "${t}" -> "${e}" edge in the graph.`);return ht(this,i),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const t=this._nodes.values();let e;for(;e=t.next(),e.done!==!0;)e.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(t){return this._attributes[t]}getAttributes(){return this._attributes}hasAttribute(t){return this._attributes.hasOwnProperty(t)}setAttribute(t,e){return this._attributes[t]=e,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}updateAttribute(t,e){if(typeof e!="function")throw new P("Graph.updateAttribute: updater should be a function.");const i=this._attributes[t];return this._attributes[t]=e(i),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}removeAttribute(t){return delete this._attributes[t],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:t}),this}replaceAttributes(t){if(!ae(t))throw new P("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=t,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(t){if(!ae(t))throw new P("Graph.mergeAttributes: provided attributes are not a plain object.");return oe(this._attributes,t),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:t}),this}updateAttributes(t){if(typeof t!="function")throw new P("Graph.updateAttributes: provided updater is not a function.");return this._attributes=t(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(t,e){if(typeof t!="function")throw new P("Graph.updateEachNodeAttributes: expecting an updater function.");if(e&&!ir(e))throw new P("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._nodes.values();let n,o;for(;n=i.next(),n.done!==!0;)o=n.value,o.attributes=t(o.key,o.attributes);this.emit("eachNodeAttributesUpdated",{hints:e||null})}updateEachEdgeAttributes(t,e){if(typeof t!="function")throw new P("Graph.updateEachEdgeAttributes: expecting an updater function.");if(e&&!ir(e))throw new P("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._edges.values();let n,o,a,s;for(;n=i.next(),n.done!==!0;)o=n.value,a=o.source,s=o.target,o.attributes=t(o.key,o.attributes,a.key,s.key,a.attributes,s.attributes,o.undirected);this.emit("eachEdgeAttributesUpdated",{hints:e||null})}forEachAdjacencyEntry(t){if(typeof t!="function")throw new P("Graph.forEachAdjacencyEntry: expecting a callback.");Wt(!1,!1,!1,this,t)}forEachAdjacencyEntryWithOrphans(t){if(typeof t!="function")throw new P("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");Wt(!1,!1,!0,this,t)}forEachAssymetricAdjacencyEntry(t){if(typeof t!="function")throw new P("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");Wt(!1,!0,!1,this,t)}forEachAssymetricAdjacencyEntryWithOrphans(t){if(typeof t!="function")throw new P("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");Wt(!1,!0,!0,this,t)}nodes(){return Array.from(this._nodes.keys())}forEachNode(t){if(typeof t!="function")throw new P("Graph.forEachNode: expecting a callback.");const e=this._nodes.values();let i,n;for(;i=e.next(),i.done!==!0;)n=i.value,t(n.key,n.attributes)}findNode(t){if(typeof t!="function")throw new P("Graph.findNode: expecting a callback.");const e=this._nodes.values();let i,n;for(;i=e.next(),i.done!==!0;)if(n=i.value,t(n.key,n.attributes))return n.key}mapNodes(t){if(typeof t!="function")throw new P("Graph.mapNode: expecting a callback.");const e=this._nodes.values();let i,n;const o=new Array(this.order);let a=0;for(;i=e.next(),i.done!==!0;)n=i.value,o[a++]=t(n.key,n.attributes);return o}someNode(t){if(typeof t!="function")throw new P("Graph.someNode: expecting a callback.");const e=this._nodes.values();let i,n;for(;i=e.next(),i.done!==!0;)if(n=i.value,t(n.key,n.attributes))return!0;return!1}everyNode(t){if(typeof t!="function")throw new P("Graph.everyNode: expecting a callback.");const e=this._nodes.values();let i,n;for(;i=e.next(),i.done!==!0;)if(n=i.value,!t(n.key,n.attributes))return!1;return!0}filterNodes(t){if(typeof t!="function")throw new P("Graph.filterNodes: expecting a callback.");const e=this._nodes.values();let i,n;const o=[];for(;i=e.next(),i.done!==!0;)n=i.value,t(n.key,n.attributes)&&o.push(n.key);return o}reduceNodes(t,e){if(typeof t!="function")throw new P("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new P("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let i=e;const n=this._nodes.values();let o,a;for(;o=n.next(),o.done!==!0;)a=o.value,i=t(i,a.key,a.attributes);return i}nodeEntries(){const t=this._nodes.values();return{[Symbol.iterator](){return this},next(){const e=t.next();if(e.done)return e;const i=e.value;return{value:{node:i.key,attributes:i.attributes},done:!1}}}}export(){const t=new Array(this._nodes.size);let e=0;this._nodes.forEach((n,o)=>{t[e++]=Xo(o,n)});const i=new Array(this._edges.size);return e=0,this._edges.forEach((n,o)=>{i[e++]=Zo(this.type,o,n)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:t,edges:i}}import(t,e=!1){if(t instanceof te)return t.forEachNode((u,d)=>{e?this.mergeNode(u,d):this.addNode(u,d)}),t.forEachEdge((u,d,h,l,f,p,y)=>{e?y?this.mergeUndirectedEdgeWithKey(u,h,l,d):this.mergeDirectedEdgeWithKey(u,h,l,d):y?this.addUndirectedEdgeWithKey(u,h,l,d):this.addDirectedEdgeWithKey(u,h,l,d)}),this;if(!ae(t))throw new P("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(t.attributes){if(!ae(t.attributes))throw new P("Graph.import: invalid attributes. Expecting a plain object.");e?this.mergeAttributes(t.attributes):this.replaceAttributes(t.attributes)}let i,n,o,a,s;if(t.nodes){if(o=t.nodes,!Array.isArray(o))throw new P("Graph.import: invalid nodes. Expecting an array.");for(i=0,n=o.length;i<n;i++){a=o[i],Jo(a);const{key:u,attributes:d}=a;e?this.mergeNode(u,d):this.addNode(u,d)}}if(t.edges){let u=!1;if(this.type==="undirected"&&(u=!0),o=t.edges,!Array.isArray(o))throw new P("Graph.import: invalid edges. Expecting an array.");for(i=0,n=o.length;i<n;i++){s=o[i],Qo(s);const{source:d,target:h,attributes:l,undirected:f=u}=s;let p;"key"in s?(p=e?f?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:f?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,p.call(this,s.key,d,h,l)):(p=e?f?this.mergeUndirectedEdge:this.mergeDirectedEdge:f?this.addUndirectedEdge:this.addDirectedEdge,p.call(this,d,h,l))}}return this}nullCopy(t){const e=new te(oe({},this._options,t));return e.replaceAttributes(oe({},this.getAttributes())),e}emptyCopy(t){const e=this.nullCopy(t);return this._nodes.forEach((i,n)=>{const o=oe({},i.attributes);i=new e.NodeDataClass(n,o),e._nodes.set(n,i)}),e}copy(t){if(t=t||{},typeof t.type=="string"&&t.type!==this.type&&t.type!=="mixed")throw new B(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${t.type}" because this would mean losing information about the current graph.`);if(typeof t.multi=="boolean"&&t.multi!==this.multi&&t.multi!==!0)throw new B("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof t.allowSelfLoops=="boolean"&&t.allowSelfLoops!==this.allowSelfLoops&&t.allowSelfLoops!==!0)throw new B("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const e=this.emptyCopy(t),i=this._edges.values();let n,o;for(;n=i.next(),n.done!==!0;)o=n.value,sn(e,"copy",!1,o.undirected,o.key,o.source.key,o.target.key,oe({},o.attributes));return e}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const t={};this._nodes.forEach((o,a)=>{t[a]=o.attributes});const e={},i={};this._edges.forEach((o,a)=>{const s=o.undirected?"--":"->";let u="",d=o.source.key,h=o.target.key,l;o.undirected&&d>h&&(l=d,d=h,h=l);const f=`(${d})${s}(${h})`;a.startsWith("geid_")?this.multi&&(typeof i[f]>"u"?i[f]=0:i[f]++,u+=`${i[f]}. `):u+=`[${a}]: `,u+=f,e[u]=o.attributes});const n={};for(const o in this)this.hasOwnProperty(o)&&!rr.has(o)&&typeof this[o]!="function"&&typeof o!="symbol"&&(n[o]=this[o]);return n.attributes=this._attributes,n.nodes=t,n.edges=e,Te(n,"constructor",this.constructor),n}}typeof Symbol<"u"&&(te.prototype[Symbol.for("nodejs.util.inspect.custom")]=te.prototype.inspect);ia.forEach(r=>{["add","merge","update"].forEach(t=>{const e=r.name(t),i=t==="add"?sn:oa;r.generateKey?te.prototype[e]=function(n,o,a){return i(this,e,!0,(r.type||this.type)==="undirected",null,n,o,a,t==="update")}:te.prototype[e]=function(n,o,a,s){return i(this,e,!1,(r.type||this.type)==="undirected",n,o,a,s,t==="update")}})});po(te);Ro(te);Mo(te);Yo(te);class Mi extends te{constructor(t){const e=oe({type:"directed"},t);if("multi"in e&&e.multi!==!1)throw new P("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(e.type!=="directed")throw new P('DirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}class un extends te{constructor(t){const e=oe({type:"undirected"},t);if("multi"in e&&e.multi!==!1)throw new P("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(e.type!=="undirected")throw new P('UndirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}class dn extends te{constructor(t){const e=oe({multi:!0},t);if("multi"in e&&e.multi!==!0)throw new P("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(e)}}class hn extends te{constructor(t){const e=oe({type:"directed",multi:!0},t);if("multi"in e&&e.multi!==!0)throw new P("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(e.type!=="directed")throw new P('MultiDirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}class cn extends te{constructor(t){const e=oe({type:"undirected",multi:!0},t);if("multi"in e&&e.multi!==!0)throw new P("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(e.type!=="undirected")throw new P('MultiUndirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}function Et(r){r.from=function(t,e){const i=oe({},t.options,e),n=new r(i);return n.import(t),n}}Et(te);Et(Mi);Et(un);Et(dn);Et(hn);Et(cn);te.Graph=te;te.DirectedGraph=Mi;te.UndirectedGraph=un;te.MultiGraph=dn;te.MultiDirectedGraph=hn;te.MultiUndirectedGraph=cn;te.InvalidArgumentsGraphError=P;te.NotFoundGraphError=L;te.UsageGraphError=B;var ci,or;function ln(){return or||(or=1,ci=function(t){return t!==null&&typeof t=="object"&&typeof t.addUndirectedEdgeWithKey=="function"&&typeof t.dropNode=="function"&&typeof t.multi=="boolean"}),ci}var Rt={},ar;function aa(){if(ar)return Rt;ar=1;function r(i){return typeof i!="number"||isNaN(i)?1:i}function t(i,n){var o={},a=function(d){return typeof d>"u"?n:d};typeof n=="function"&&(a=n);var s=function(d){return a(d[i])},u=function(){return a(void 0)};return typeof i=="string"?(o.fromAttributes=s,o.fromGraph=function(d,h){return s(d.getNodeAttributes(h))},o.fromEntry=function(d,h){return s(h)}):typeof i=="function"?(o.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},o.fromGraph=function(d,h){return a(i(h,d.getNodeAttributes(h)))},o.fromEntry=function(d,h){return a(i(d,h))}):(o.fromAttributes=u,o.fromGraph=u,o.fromEntry=u),o}function e(i,n){var o={},a=function(d){return typeof d>"u"?n:d};typeof n=="function"&&(a=n);var s=function(d){return a(d[i])},u=function(){return a(void 0)};return typeof i=="string"?(o.fromAttributes=s,o.fromGraph=function(d,h){return s(d.getEdgeAttributes(h))},o.fromEntry=function(d,h){return s(h)},o.fromPartialEntry=o.fromEntry,o.fromMinimalEntry=o.fromEntry):typeof i=="function"?(o.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},o.fromGraph=function(d,h){var l=d.extremities(h);return a(i(h,d.getEdgeAttributes(h),l[0],l[1],d.getNodeAttributes(l[0]),d.getNodeAttributes(l[1]),d.isUndirected(h)))},o.fromEntry=function(d,h,l,f,p,y,w){return a(i(d,h,l,f,p,y,w))},o.fromPartialEntry=function(d,h,l,f){return a(i(d,h,l,f))},o.fromMinimalEntry=function(d,h){return a(i(d,h))}):(o.fromAttributes=u,o.fromGraph=u,o.fromEntry=u,o.fromMinimalEntry=u),o}return Rt.createNodeValueGetter=t,Rt.createEdgeValueGetter=e,Rt.createEdgeWeightGetter=function(i){return e(i,r)},Rt}var li,sr;function sa(){if(sr)return li;sr=1;var r=0,t=1,e=2,i=3,n=4,o=5,a=6,s=7,u=8,d=9,h=0,l=1,f=2,p=0,y=1,w=2,E=3,C=4,T=5,S=6,c=7,b=8,m=3,_=10,G=3,k=9,O=10;return li=function(F,g,q){var J,D,v,M,j,ee,re,Z,N,he,ie=g.length,De=q.length,be=F.adjustSizes,xe=F.barnesHutTheta*F.barnesHutTheta,Le,X,V,K,ce,U,z,A=[];for(v=0;v<ie;v+=_)g[v+n]=g[v+e],g[v+o]=g[v+i],g[v+e]=0,g[v+i]=0;if(F.outboundAttractionDistribution){for(Le=0,v=0;v<ie;v+=_)Le+=g[v+a];Le/=ie/_}if(F.barnesHutOptimize){var ge=1/0,ke=-1/0,we=1/0,de=-1/0,ne,Ee,Ge;for(v=0;v<ie;v+=_)ge=Math.min(ge,g[v+r]),ke=Math.max(ke,g[v+r]),we=Math.min(we,g[v+t]),de=Math.max(de,g[v+t]);var Ie=ke-ge,Be=de-we;for(Ie>Be?(we-=(Ie-Be)/2,de=we+Ie):(ge-=(Be-Ie)/2,ke=ge+Be),A[0+p]=-1,A[0+y]=(ge+ke)/2,A[0+w]=(we+de)/2,A[0+E]=Math.max(ke-ge,de-we),A[0+C]=-1,A[0+T]=-1,A[0+S]=0,A[0+c]=0,A[0+b]=0,J=1,v=0;v<ie;v+=_)for(D=0,Ge=m;;)if(A[D+T]>=0){g[v+r]<A[D+y]?g[v+t]<A[D+w]?ne=A[D+T]:ne=A[D+T]+k:g[v+t]<A[D+w]?ne=A[D+T]+k*2:ne=A[D+T]+k*3,A[D+c]=(A[D+c]*A[D+S]+g[v+r]*g[v+a])/(A[D+S]+g[v+a]),A[D+b]=(A[D+b]*A[D+S]+g[v+t]*g[v+a])/(A[D+S]+g[v+a]),A[D+S]+=g[v+a],D=ne;continue}else if(A[D+p]<0){A[D+p]=v;break}else{if(A[D+T]=J*k,Z=A[D+E]/2,N=A[D+T],A[N+p]=-1,A[N+y]=A[D+y]-Z,A[N+w]=A[D+w]-Z,A[N+E]=Z,A[N+C]=N+k,A[N+T]=-1,A[N+S]=0,A[N+c]=0,A[N+b]=0,N+=k,A[N+p]=-1,A[N+y]=A[D+y]-Z,A[N+w]=A[D+w]+Z,A[N+E]=Z,A[N+C]=N+k,A[N+T]=-1,A[N+S]=0,A[N+c]=0,A[N+b]=0,N+=k,A[N+p]=-1,A[N+y]=A[D+y]+Z,A[N+w]=A[D+w]-Z,A[N+E]=Z,A[N+C]=N+k,A[N+T]=-1,A[N+S]=0,A[N+c]=0,A[N+b]=0,N+=k,A[N+p]=-1,A[N+y]=A[D+y]+Z,A[N+w]=A[D+w]+Z,A[N+E]=Z,A[N+C]=A[D+C],A[N+T]=-1,A[N+S]=0,A[N+c]=0,A[N+b]=0,J+=4,g[A[D+p]+r]<A[D+y]?g[A[D+p]+t]<A[D+w]?ne=A[D+T]:ne=A[D+T]+k:g[A[D+p]+t]<A[D+w]?ne=A[D+T]+k*2:ne=A[D+T]+k*3,A[D+S]=g[A[D+p]+a],A[D+c]=g[A[D+p]+r],A[D+b]=g[A[D+p]+t],A[ne+p]=A[D+p],A[D+p]=-1,g[v+r]<A[D+y]?g[v+t]<A[D+w]?Ee=A[D+T]:Ee=A[D+T]+k:g[v+t]<A[D+w]?Ee=A[D+T]+k*2:Ee=A[D+T]+k*3,ne===Ee)if(Ge--){D=ne;continue}else{Ge=m;break}A[Ee+p]=v;break}}if(F.barnesHutOptimize)for(X=F.scalingRatio,v=0;v<ie;v+=_)for(D=0;;)if(A[D+T]>=0)if(U=Math.pow(g[v+r]-A[D+c],2)+Math.pow(g[v+t]-A[D+b],2),he=A[D+E],4*he*he/U<xe){if(V=g[v+r]-A[D+c],K=g[v+t]-A[D+b],be===!0?U>0?(z=X*g[v+a]*A[D+S]/U,g[v+e]+=V*z,g[v+i]+=K*z):U<0&&(z=-X*g[v+a]*A[D+S]/Math.sqrt(U),g[v+e]+=V*z,g[v+i]+=K*z):U>0&&(z=X*g[v+a]*A[D+S]/U,g[v+e]+=V*z,g[v+i]+=K*z),D=A[D+C],D<0)break;continue}else{D=A[D+T];continue}else{if(ee=A[D+p],ee>=0&&ee!==v&&(V=g[v+r]-g[ee+r],K=g[v+t]-g[ee+t],U=V*V+K*K,be===!0?U>0?(z=X*g[v+a]*g[ee+a]/U,g[v+e]+=V*z,g[v+i]+=K*z):U<0&&(z=-X*g[v+a]*g[ee+a]/Math.sqrt(U),g[v+e]+=V*z,g[v+i]+=K*z):U>0&&(z=X*g[v+a]*g[ee+a]/U,g[v+e]+=V*z,g[v+i]+=K*z)),D=A[D+C],D<0)break;continue}else for(X=F.scalingRatio,M=0;M<ie;M+=_)for(j=0;j<M;j+=_)V=g[M+r]-g[j+r],K=g[M+t]-g[j+t],be===!0?(U=Math.sqrt(V*V+K*K)-g[M+u]-g[j+u],U>0?(z=X*g[M+a]*g[j+a]/U/U,g[M+e]+=V*z,g[M+i]+=K*z,g[j+e]-=V*z,g[j+i]-=K*z):U<0&&(z=100*X*g[M+a]*g[j+a],g[M+e]+=V*z,g[M+i]+=K*z,g[j+e]-=V*z,g[j+i]-=K*z)):(U=Math.sqrt(V*V+K*K),U>0&&(z=X*g[M+a]*g[j+a]/U/U,g[M+e]+=V*z,g[M+i]+=K*z,g[j+e]-=V*z,g[j+i]-=K*z));for(N=F.gravity/F.scalingRatio,X=F.scalingRatio,v=0;v<ie;v+=_)z=0,V=g[v+r],K=g[v+t],U=Math.sqrt(Math.pow(V,2)+Math.pow(K,2)),F.strongGravityMode?U>0&&(z=X*g[v+a]*N):U>0&&(z=X*g[v+a]*N/U),g[v+e]-=V*z,g[v+i]-=K*z;for(X=1*(F.outboundAttractionDistribution?Le:1),re=0;re<De;re+=G)M=q[re+h],j=q[re+l],Z=q[re+f],ce=Math.pow(Z,F.edgeWeightInfluence),V=g[M+r]-g[j+r],K=g[M+t]-g[j+t],be===!0?(U=Math.sqrt(V*V+K*K)-g[M+u]-g[j+u],F.linLogMode?F.outboundAttractionDistribution?U>0&&(z=-X*ce*Math.log(1+U)/U/g[M+a]):U>0&&(z=-X*ce*Math.log(1+U)/U):F.outboundAttractionDistribution?U>0&&(z=-X*ce/g[M+a]):U>0&&(z=-X*ce)):(U=Math.sqrt(Math.pow(V,2)+Math.pow(K,2)),F.linLogMode?F.outboundAttractionDistribution?U>0&&(z=-X*ce*Math.log(1+U)/U/g[M+a]):U>0&&(z=-X*ce*Math.log(1+U)/U):F.outboundAttractionDistribution?(U=1,z=-X*ce/g[M+a]):(U=1,z=-X*ce)),U>0&&(g[M+e]+=V*z,g[M+i]+=K*z,g[j+e]-=V*z,g[j+i]-=K*z);var He,$e,We,je,at,st;if(be===!0)for(v=0;v<ie;v+=_)g[v+d]!==1&&(He=Math.sqrt(Math.pow(g[v+e],2)+Math.pow(g[v+i],2)),He>O&&(g[v+e]=g[v+e]*O/He,g[v+i]=g[v+i]*O/He),$e=g[v+a]*Math.sqrt((g[v+n]-g[v+e])*(g[v+n]-g[v+e])+(g[v+o]-g[v+i])*(g[v+o]-g[v+i])),We=Math.sqrt((g[v+n]+g[v+e])*(g[v+n]+g[v+e])+(g[v+o]+g[v+i])*(g[v+o]+g[v+i]))/2,je=.1*Math.log(1+We)/(1+Math.sqrt($e)),at=g[v+r]+g[v+e]*(je/F.slowDown),g[v+r]=at,st=g[v+t]+g[v+i]*(je/F.slowDown),g[v+t]=st);else for(v=0;v<ie;v+=_)g[v+d]!==1&&($e=g[v+a]*Math.sqrt((g[v+n]-g[v+e])*(g[v+n]-g[v+e])+(g[v+o]-g[v+i])*(g[v+o]-g[v+i])),We=Math.sqrt((g[v+n]+g[v+e])*(g[v+n]+g[v+e])+(g[v+o]+g[v+i])*(g[v+o]+g[v+i]))/2,je=g[v+s]*Math.log(1+We)/(1+Math.sqrt($e)),g[v+s]=Math.min(1,Math.sqrt(je*(Math.pow(g[v+e],2)+Math.pow(g[v+i],2))/(1+Math.sqrt($e)))),at=g[v+r]+g[v+e]*(je/F.slowDown),g[v+r]=at,st=g[v+t]+g[v+i]*(je/F.slowDown),g[v+t]=st);return{}},li}var Ve={},ur;function ua(){if(ur)return Ve;ur=1;var r=10,t=3;return Ve.assign=function(e){e=e||{};var i=Array.prototype.slice.call(arguments).slice(1),n,o,a;for(n=0,a=i.length;n<a;n++)if(i[n])for(o in i[n])e[o]=i[n][o];return e},Ve.validateSettings=function(e){return"linLogMode"in e&&typeof e.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in e&&typeof e.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in e&&typeof e.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in e&&typeof e.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in e&&!(typeof e.scalingRatio=="number"&&e.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in e&&typeof e.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in e&&!(typeof e.gravity=="number"&&e.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in e&&!(typeof e.slowDown=="number"||e.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in e&&typeof e.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in e&&!(typeof e.barnesHutTheta=="number"&&e.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null},Ve.graphToByteArrays=function(e,i){var n=e.order,o=e.size,a={},s,u=new Float32Array(n*r),d=new Float32Array(o*t);return s=0,e.forEachNode(function(h,l){a[h]=s,u[s]=l.x,u[s+1]=l.y,u[s+2]=0,u[s+3]=0,u[s+4]=0,u[s+5]=0,u[s+6]=1,u[s+7]=1,u[s+8]=l.size||1,u[s+9]=l.fixed?1:0,s+=r}),s=0,e.forEachEdge(function(h,l,f,p,y,w,E){var C=a[f],T=a[p],S=i(h,l,f,p,y,w,E);u[C+6]+=S,u[T+6]+=S,d[s]=C,d[s+1]=T,d[s+2]=S,s+=t}),{nodes:u,edges:d}},Ve.assignLayoutChanges=function(e,i,n){var o=0;e.updateEachNodeAttributes(function(a,s){return s.x=i[o],s.y=i[o+1],o+=r,n?n(a,s):s})},Ve.readGraphPositions=function(e,i){var n=0;e.forEachNode(function(o,a){i[n]=a.x,i[n+1]=a.y,n+=r})},Ve.collectLayoutChanges=function(e,i,n){for(var o=e.nodes(),a={},s=0,u=0,d=i.length;s<d;s+=r){if(n){var h=Object.assign({},e.getNodeAttributes(o[u]));h.x=i[s],h.y=i[s+1],h=n(o[u],h),a[o[u]]={x:h.x,y:h.y}}else a[o[u]]={x:i[s],y:i[s+1]};u++}return a},Ve.createWorker=function(i){var n=window.URL||window.webkitURL,o=i.toString(),a=n.createObjectURL(new Blob(["("+o+").call(this);"],{type:"text/javascript"})),s=new Worker(a);return n.revokeObjectURL(a),s},Ve}var fi,dr;function da(){return dr||(dr=1,fi={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5}),fi}var pi,hr;function ha(){if(hr)return pi;hr=1;var r=ln(),t=aa().createEdgeWeightGetter,e=sa(),i=ua(),n=da();function o(u,d,h){if(!r(d))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof h=="number"&&(h={iterations:h});var l=h.iterations;if(typeof l!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(l<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var f=t("getEdgeWeight"in h?h.getEdgeWeight:"weight").fromEntry,p=typeof h.outputReducer=="function"?h.outputReducer:null,y=i.assign({},n,h.settings),w=i.validateSettings(y);if(w)throw new Error("graphology-layout-forceatlas2: "+w.message);var E=i.graphToByteArrays(d,f),C;for(C=0;C<l;C++)e(y,E.nodes,E.edges);if(u){i.assignLayoutChanges(d,E.nodes,p);return}return i.collectLayoutChanges(d,E.nodes)}function a(u){var d=typeof u=="number"?u:u.order;return{barnesHutOptimize:d>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(d)}}var s=o.bind(null,!1);return s.assign=o.bind(null,!0),s.inferSettings=a,pi=s,pi}var ca=ha();const la=Xr(ca);function fa(r,t){if(typeof r!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var i=e.call(r,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function kt(r){var t=fa(r,"string");return typeof t=="symbol"?t:t+""}function se(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function cr(r,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,kt(i.key),i)}}function ue(r,t,e){return t&&cr(r.prototype,t),e&&cr(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function ft(r){return ft=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ft(r)}function fn(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fn=function(){return!!r})()}function pa(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ga(r,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pa(r)}function me(r,t,e){return t=ft(t),ga(r,fn()?Reflect.construct(t,e||[],ft(r).constructor):t.apply(r,e))}function Ci(r,t){return Ci=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,i){return e.__proto__=i,e},Ci(r,t)}function ye(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Ci(r,t)}function va(r){if(Array.isArray(r))return r}function ma(r,t){var e=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var i,n,o,a,s=[],u=!0,d=!1;try{if(o=(e=e.call(r)).next,t===0){if(Object(e)!==e)return;u=!1}else for(;!(u=(i=o.call(e)).done)&&(s.push(i.value),s.length!==t);u=!0);}catch(h){d=!0,n=h}finally{try{if(!u&&e.return!=null&&(a=e.return(),Object(a)!==a))return}finally{if(d)throw n}}return s}}function Di(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,i=Array(t);e<t;e++)i[e]=r[e];return i}function pn(r,t){if(r){if(typeof r=="string")return Di(r,t);var e={}.toString.call(r).slice(8,-1);return e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set"?Array.from(r):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Di(r,t):void 0}}function ya(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pt(r,t){return va(r)||ma(r,t)||pn(r,t)||ya()}var gi={black:"#000000",silver:"#C0C0C0",gray:"#808080",grey:"#808080",white:"#FFFFFF",maroon:"#800000",red:"#FF0000",purple:"#800080",fuchsia:"#FF00FF",green:"#008000",lime:"#00FF00",olive:"#808000",yellow:"#FFFF00",navy:"#000080",blue:"#0000FF",teal:"#008080",aqua:"#00FFFF",darkblue:"#00008B",mediumblue:"#0000CD",darkgreen:"#006400",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",springgreen:"#00FF7F",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",rebeccapurple:"#663399",mediumaquamarine:"#66CDAA",dimgray:"#696969",dimgrey:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",slategrey:"#708090",lightslategray:"#778899",lightslategrey:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370DB",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",palevioletred:"#DB7093",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",lightyellow:"#FFFFE0",ivory:"#FFFFF0"},gn=new Int8Array(4),vi=new Int32Array(gn.buffer,0,1),ba=new Float32Array(gn.buffer,0,1),wa=/^\s*rgba?\s*\(/,Ea=/^\s*rgba?\s*\(\s*([0-9]*)\s*,\s*([0-9]*)\s*,\s*([0-9]*)(?:\s*,\s*(.*)?)?\)\s*$/;function _a(r){var t=0,e=0,i=0,n=1;if(r[0]==="#")r.length===4?(t=parseInt(r.charAt(1)+r.charAt(1),16),e=parseInt(r.charAt(2)+r.charAt(2),16),i=parseInt(r.charAt(3)+r.charAt(3),16)):(t=parseInt(r.charAt(1)+r.charAt(2),16),e=parseInt(r.charAt(3)+r.charAt(4),16),i=parseInt(r.charAt(5)+r.charAt(6),16)),r.length===9&&(n=parseInt(r.charAt(7)+r.charAt(8),16)/255);else if(wa.test(r)){var o=r.match(Ea);o&&(t=+o[1],e=+o[2],i=+o[3],o[4]&&(n=+o[4]))}return{r:t,g:e,b:i,a:n}}var lt={};for(var jt in gi)lt[jt]=_t(gi[jt]),lt[gi[jt]]=lt[jt];function vn(r,t,e,i,n){return vi[0]=i<<24|e<<16|t<<8|r,vi[0]=vi[0]&4278190079,ba[0]}function _t(r){if(r=r.toLowerCase(),typeof lt[r]<"u")return lt[r];var t=_a(r),e=t.r,i=t.g,n=t.b,o=t.a;o=o*255|0;var a=vn(e,i,n,o);return lt[r]=a,a}var mi={};function mn(r){if(typeof mi[r]<"u")return mi[r];var t=(r&16711680)>>>16,e=(r&65280)>>>8,i=r&255,n=255,o=vn(t,e,i,n);return mi[r]=o,o}function lr(r,t,e,i){return e+(t<<8)+(r<<16)}function fr(r,t,e,i,n,o){var a=Math.floor(e/o*n),s=Math.floor(r.drawingBufferHeight/o-i/o*n),u=new Uint8Array(4);r.bindFramebuffer(r.FRAMEBUFFER,t),r.readPixels(a,s,1,1,r.RGBA,r.UNSIGNED_BYTE,u);var d=pt(u,4),h=d[0],l=d[1],f=d[2],p=d[3];return[h,l,f,p]}function x(r,t,e){return(t=kt(t))in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function pr(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),e.push.apply(e,i)}return e}function I(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?pr(Object(e),!0).forEach(function(i){x(r,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):pr(Object(e)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(e,i))})}return r}function Ta(r,t){for(;!{}.hasOwnProperty.call(r,t)&&(r=ft(r))!==null;);return r}function xi(){return xi=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(r,t,e){var i=Ta(r,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(arguments.length<3?r:e):n.value}},xi.apply(null,arguments)}function yn(r,t,e,i){var n=xi(ft(r.prototype),t,e);return typeof n=="function"?function(o){return n.apply(e,o)}:n}function Aa(r){return r.normalized?1:r.size}function yi(r){var t=0;return r.forEach(function(e){return t+=Aa(e)}),t}function bn(r,t,e){var i=r==="VERTEX"?t.VERTEX_SHADER:t.FRAGMENT_SHADER,n=t.createShader(i);if(n===null)throw new Error("loadShader: error while creating the shader");t.shaderSource(n,e),t.compileShader(n);var o=t.getShaderParameter(n,t.COMPILE_STATUS);if(!o){var a=t.getShaderInfoLog(n);throw t.deleteShader(n),new Error(`loadShader: error while compiling the shader:
`.concat(a,`
`).concat(e))}return n}function Ra(r,t){return bn("VERTEX",r,t)}function Sa(r,t){return bn("FRAGMENT",r,t)}function Ca(r,t){var e=r.createProgram();if(e===null)throw new Error("loadProgram: error while creating the program.");var i,n;for(i=0,n=t.length;i<n;i++)r.attachShader(e,t[i]);r.linkProgram(e);var o=r.getProgramParameter(e,r.LINK_STATUS);if(!o)throw r.deleteProgram(e),new Error("loadProgram: error while linking the program.");return e}function gr(r){var t=r.gl,e=r.buffer,i=r.program,n=r.vertexShader,o=r.fragmentShader;t.deleteShader(n),t.deleteShader(o),t.deleteProgram(i),t.deleteBuffer(e)}var vr=`#define PICKING_MODE
`,Da=x(x(x(x(x(x(x(x({},WebGL2RenderingContext.BOOL,1),WebGL2RenderingContext.BYTE,1),WebGL2RenderingContext.UNSIGNED_BYTE,1),WebGL2RenderingContext.SHORT,2),WebGL2RenderingContext.UNSIGNED_SHORT,2),WebGL2RenderingContext.INT,4),WebGL2RenderingContext.UNSIGNED_INT,4),WebGL2RenderingContext.FLOAT,4),wn=function(){function r(t,e,i){se(this,r),x(this,"array",new Float32Array),x(this,"constantArray",new Float32Array),x(this,"capacity",0),x(this,"verticesCount",0);var n=this.getDefinition();if(this.VERTICES=n.VERTICES,this.VERTEX_SHADER_SOURCE=n.VERTEX_SHADER_SOURCE,this.FRAGMENT_SHADER_SOURCE=n.FRAGMENT_SHADER_SOURCE,this.UNIFORMS=n.UNIFORMS,this.ATTRIBUTES=n.ATTRIBUTES,this.METHOD=n.METHOD,this.CONSTANT_ATTRIBUTES="CONSTANT_ATTRIBUTES"in n?n.CONSTANT_ATTRIBUTES:[],this.CONSTANT_DATA="CONSTANT_DATA"in n?n.CONSTANT_DATA:[],this.isInstanced="CONSTANT_ATTRIBUTES"in n,this.ATTRIBUTES_ITEMS_COUNT=yi(this.ATTRIBUTES),this.STRIDE=this.VERTICES*this.ATTRIBUTES_ITEMS_COUNT,this.renderer=i,this.normalProgram=this.getProgramInfo("normal",t,n.VERTEX_SHADER_SOURCE,n.FRAGMENT_SHADER_SOURCE,null),this.pickProgram=e?this.getProgramInfo("pick",t,vr+n.VERTEX_SHADER_SOURCE,vr+n.FRAGMENT_SHADER_SOURCE,e):null,this.isInstanced){var o=yi(this.CONSTANT_ATTRIBUTES);if(this.CONSTANT_DATA.length!==this.VERTICES)throw new Error("Program: error while getting constant data (expected ".concat(this.VERTICES," items, received ").concat(this.CONSTANT_DATA.length," instead)"));this.constantArray=new Float32Array(this.CONSTANT_DATA.length*o);for(var a=0;a<this.CONSTANT_DATA.length;a++){var s=this.CONSTANT_DATA[a];if(s.length!==o)throw new Error("Program: error while getting constant data (one vector has ".concat(s.length," items instead of ").concat(o,")"));for(var u=0;u<s.length;u++)this.constantArray[a*o+u]=s[u]}this.STRIDE=this.ATTRIBUTES_ITEMS_COUNT}}return ue(r,[{key:"kill",value:function(){gr(this.normalProgram),this.pickProgram&&(gr(this.pickProgram),this.pickProgram=null)}},{key:"getProgramInfo",value:function(e,i,n,o,a){var s=this.getDefinition(),u=i.createBuffer();if(u===null)throw new Error("Program: error while creating the WebGL buffer.");var d=Ra(i,n),h=Sa(i,o),l=Ca(i,[d,h]),f={};s.UNIFORMS.forEach(function(w){var E=i.getUniformLocation(l,w);E&&(f[w]=E)});var p={};s.ATTRIBUTES.forEach(function(w){p[w.name]=i.getAttribLocation(l,w.name)});var y;if("CONSTANT_ATTRIBUTES"in s&&(s.CONSTANT_ATTRIBUTES.forEach(function(w){p[w.name]=i.getAttribLocation(l,w.name)}),y=i.createBuffer(),y===null))throw new Error("Program: error while creating the WebGL constant buffer.");return{name:e,program:l,gl:i,frameBuffer:a,buffer:u,constantBuffer:y||{},uniformLocations:f,attributeLocations:p,isPicking:e==="pick",vertexShader:d,fragmentShader:h}}},{key:"bindProgram",value:function(e){var i=this,n=0,o=e.gl,a=e.buffer;this.isInstanced?(o.bindBuffer(o.ARRAY_BUFFER,e.constantBuffer),n=0,this.CONSTANT_ATTRIBUTES.forEach(function(s){return n+=i.bindAttribute(s,e,n,!1)}),o.bufferData(o.ARRAY_BUFFER,this.constantArray,o.STATIC_DRAW),o.bindBuffer(o.ARRAY_BUFFER,e.buffer),n=0,this.ATTRIBUTES.forEach(function(s){return n+=i.bindAttribute(s,e,n,!0)}),o.bufferData(o.ARRAY_BUFFER,this.array,o.DYNAMIC_DRAW)):(o.bindBuffer(o.ARRAY_BUFFER,a),n=0,this.ATTRIBUTES.forEach(function(s){return n+=i.bindAttribute(s,e,n)}),o.bufferData(o.ARRAY_BUFFER,this.array,o.DYNAMIC_DRAW)),o.bindBuffer(o.ARRAY_BUFFER,null)}},{key:"unbindProgram",value:function(e){var i=this;this.isInstanced?(this.CONSTANT_ATTRIBUTES.forEach(function(n){return i.unbindAttribute(n,e,!1)}),this.ATTRIBUTES.forEach(function(n){return i.unbindAttribute(n,e,!0)})):this.ATTRIBUTES.forEach(function(n){return i.unbindAttribute(n,e)})}},{key:"bindAttribute",value:function(e,i,n,o){var a=Da[e.type];if(typeof a!="number")throw new Error('Program.bind: yet unsupported attribute type "'.concat(e.type,'"'));var s=i.attributeLocations[e.name],u=i.gl;if(s!==-1){u.enableVertexAttribArray(s);var d=this.isInstanced?(o?this.ATTRIBUTES_ITEMS_COUNT:yi(this.CONSTANT_ATTRIBUTES))*Float32Array.BYTES_PER_ELEMENT:this.ATTRIBUTES_ITEMS_COUNT*Float32Array.BYTES_PER_ELEMENT;if(u.vertexAttribPointer(s,e.size,e.type,e.normalized||!1,d,n),this.isInstanced&&o)if(u instanceof WebGL2RenderingContext)u.vertexAttribDivisor(s,1);else{var h=u.getExtension("ANGLE_instanced_arrays");h&&h.vertexAttribDivisorANGLE(s,1)}}return e.size*a}},{key:"unbindAttribute",value:function(e,i,n){var o=i.attributeLocations[e.name],a=i.gl;if(o!==-1&&(a.disableVertexAttribArray(o),this.isInstanced&&n))if(a instanceof WebGL2RenderingContext)a.vertexAttribDivisor(o,0);else{var s=a.getExtension("ANGLE_instanced_arrays");s&&s.vertexAttribDivisorANGLE(o,0)}}},{key:"reallocate",value:function(e){e!==this.capacity&&(this.capacity=e,this.verticesCount=this.VERTICES*e,this.array=new Float32Array(this.isInstanced?this.capacity*this.ATTRIBUTES_ITEMS_COUNT:this.verticesCount*this.ATTRIBUTES_ITEMS_COUNT))}},{key:"hasNothingToRender",value:function(){return this.verticesCount===0}},{key:"renderProgram",value:function(e,i){var n=i.gl,o=i.program;n.enable(n.BLEND),n.useProgram(o),this.setUniforms(e,i),this.drawWebGL(this.METHOD,i)}},{key:"render",value:function(e){this.hasNothingToRender()||(this.pickProgram&&(this.pickProgram.gl.viewport(0,0,e.width*e.pixelRatio/e.downSizingRatio,e.height*e.pixelRatio/e.downSizingRatio),this.bindProgram(this.pickProgram),this.renderProgram(I(I({},e),{},{pixelRatio:e.pixelRatio/e.downSizingRatio}),this.pickProgram),this.unbindProgram(this.pickProgram)),this.normalProgram.gl.viewport(0,0,e.width*e.pixelRatio,e.height*e.pixelRatio),this.bindProgram(this.normalProgram),this.renderProgram(e,this.normalProgram),this.unbindProgram(this.normalProgram))}},{key:"drawWebGL",value:function(e,i){var n=i.gl,o=i.frameBuffer;if(n.bindFramebuffer(n.FRAMEBUFFER,o),!this.isInstanced)n.drawArrays(e,0,this.verticesCount);else if(n instanceof WebGL2RenderingContext)n.drawArraysInstanced(e,0,this.VERTICES,this.capacity);else{var a=n.getExtension("ANGLE_instanced_arrays");a&&a.drawArraysInstancedANGLE(e,0,this.VERTICES,this.capacity)}}}])}(),xa=function(r){function t(){return se(this,t),me(this,t,arguments)}return ye(t,r),ue(t,[{key:"kill",value:function(){yn(t,"kill",this)([])}},{key:"process",value:function(i,n,o){var a=n*this.STRIDE;if(o.hidden){for(var s=a+this.STRIDE;a<s;a++)this.array[a]=0;return}return this.processVisibleItem(mn(i),a,o)}}])}(wn),ni=function(r){function t(){var e;se(this,t);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return e=me(this,t,[].concat(n)),x(e,"drawLabel",void 0),e}return ye(t,r),ue(t,[{key:"kill",value:function(){yn(t,"kill",this)([])}},{key:"process",value:function(i,n,o,a,s){var u=n*this.STRIDE;if(s.hidden||o.hidden||a.hidden){for(var d=u+this.STRIDE;u<d;u++)this.array[u]=0;return}return this.processVisibleItem(mn(i),u,o,a,s)}}])}(wn);function En(r,t){return function(){function e(i,n,o){se(this,e),x(this,"drawLabel",t),this.programs=r.map(function(a){return new a(i,n,o)})}return ue(e,[{key:"reallocate",value:function(n){this.programs.forEach(function(o){return o.reallocate(n)})}},{key:"process",value:function(n,o,a,s,u){this.programs.forEach(function(d){return d.process(n,o,a,s,u)})}},{key:"render",value:function(n){this.programs.forEach(function(o){return o.render(n)})}},{key:"kill",value:function(){this.programs.forEach(function(n){return n.kill()})}}])}()}function La(r,t,e,i,n){var o=n.edgeLabelSize,a=n.edgeLabelFont,s=n.edgeLabelWeight,u=n.edgeLabelColor.attribute?t[n.edgeLabelColor.attribute]||n.edgeLabelColor.color||"#000":n.edgeLabelColor.color,d=t.label;if(d){r.fillStyle=u,r.font="".concat(s," ").concat(o,"px ").concat(a);var h=e.size,l=i.size,f=e.x,p=e.y,y=i.x,w=i.y,E=(f+y)/2,C=(p+w)/2,T=y-f,S=w-p,c=Math.sqrt(T*T+S*S);if(!(c<h+l)){f+=T*h/c,p+=S*h/c,y-=T*l/c,w-=S*l/c,E=(f+y)/2,C=(p+w)/2,T=y-f,S=w-p,c=Math.sqrt(T*T+S*S);var b=r.measureText(d).width;if(b>c){var m="";for(d=d+m,b=r.measureText(d).width;b>c&&d.length>1;)d=d.slice(0,-2)+m,b=r.measureText(d).width;if(d.length<4)return}var _;T>0?S>0?_=Math.acos(T/c):_=Math.asin(S/c):S>0?_=Math.acos(T/c)+Math.PI:_=Math.asin(T/c)+Math.PI/2,r.save(),r.translate(E,C),r.rotate(_),r.fillText(d,-b/2,t.size/2+o),r.restore()}}}function _n(r,t,e){if(t.label){var i=e.labelSize,n=e.labelFont,o=e.labelWeight,a=e.labelColor.attribute?t[e.labelColor.attribute]||e.labelColor.color||"#000":e.labelColor.color;r.fillStyle=a,r.font="".concat(o," ").concat(i,"px ").concat(n),r.fillText(t.label,t.x+t.size+3,t.y+i/3)}}function ka(r,t,e){var i=e.labelSize,n=e.labelFont,o=e.labelWeight;r.font="".concat(o," ").concat(i,"px ").concat(n),r.fillStyle="#FFF",r.shadowOffsetX=0,r.shadowOffsetY=0,r.shadowBlur=8,r.shadowColor="#000";var a=2;if(typeof t.label=="string"){var s=r.measureText(t.label).width,u=Math.round(s+5),d=Math.round(i+2*a),h=Math.max(t.size,i/2)+a,l=Math.asin(d/2/h),f=Math.sqrt(Math.abs(Math.pow(h,2)-Math.pow(d/2,2)));r.beginPath(),r.moveTo(t.x+f,t.y+d/2),r.lineTo(t.x+h+u,t.y+d/2),r.lineTo(t.x+h+u,t.y-d/2),r.lineTo(t.x+f,t.y-d/2),r.arc(t.x,t.y,h,l,-l),r.closePath(),r.fill()}else r.beginPath(),r.arc(t.x,t.y,t.size+a,0,Math.PI*2),r.closePath(),r.fill();r.shadowOffsetX=0,r.shadowOffsetY=0,r.shadowBlur=0,_n(r,t,e)}var Ga=`
precision highp float;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;

uniform float u_correctionRatio;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float border = u_correctionRatio * 2.0;
  float dist = length(v_diffVector) - v_radius + border;

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
  if (dist > border)
    gl_FragColor = transparent;
  else
    gl_FragColor = v_color;

  #else
  float t = 0.0;
  if (dist > border)
    t = 1.0;
  else if (dist > 0.0)
    t = dist / border;

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,Oa=Ga,Pa=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;
varying float v_border;

const float bias = 255.0 / 254.0;

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Fa=Pa,Tn=WebGLRenderingContext,mr=Tn.UNSIGNED_BYTE,bi=Tn.FLOAT,Na=["u_sizeRatio","u_correctionRatio","u_matrix"],It=function(r){function t(){return se(this,t),me(this,t,arguments)}return ye(t,r),ue(t,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:Fa,FRAGMENT_SHADER_SOURCE:Oa,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Na,ATTRIBUTES:[{name:"a_position",size:2,type:bi},{name:"a_size",size:1,type:bi},{name:"a_color",size:4,type:mr,normalized:!0},{name:"a_id",size:4,type:mr,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:bi}],CONSTANT_DATA:[[t.ANGLE_1],[t.ANGLE_2],[t.ANGLE_3]]}}},{key:"processVisibleItem",value:function(i,n,o){var a=this.array,s=_t(o.color);a[n++]=o.x,a[n++]=o.y,a[n++]=o.size,a[n++]=s,a[n++]=i}},{key:"setUniforms",value:function(i,n){var o=n.gl,a=n.uniformLocations,s=a.u_sizeRatio,u=a.u_correctionRatio,d=a.u_matrix;o.uniform1f(u,i.correctionRatio),o.uniform1f(s,i.sizeRatio),o.uniformMatrix3fv(d,!1,i.matrix)}}])}(xa);x(It,"ANGLE_1",0);x(It,"ANGLE_2",2*Math.PI/3);x(It,"ANGLE_3",4*Math.PI/3);var Ia=`
precision mediump float;

varying vec4 v_color;

void main(void) {
  gl_FragColor = v_color;
}
`,$a=Ia,za=`
attribute vec2 a_position;
attribute vec2 a_normal;
attribute float a_radius;
attribute vec3 a_barycentric;

#ifdef PICKING_MODE
attribute vec4 a_id;
#else
attribute vec4 a_color;
#endif

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_widenessToThicknessRatio;

varying vec4 v_color;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // These first computations are taken from edge.vert.glsl and
  // edge.clamped.vert.glsl. Please read it to get better comments on what's
  // happening:
  float pixelsThickness = max(normalLength / u_sizeRatio, minThickness);
  float webGLThickness = pixelsThickness * u_correctionRatio;
  float webGLNodeRadius = a_radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  float webGLArrowHeadThickness = webGLThickness * u_widenessToThicknessRatio;

  float da = a_barycentric.x;
  float db = a_barycentric.y;
  float dc = a_barycentric.z;

  vec2 delta = vec2(
      da * (webGLNodeRadius * unitNormal.y)
    + db * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y + webGLArrowHeadThickness * unitNormal.x)
    + dc * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y - webGLArrowHeadThickness * unitNormal.x),

      da * (-webGLNodeRadius * unitNormal.x)
    + db * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x + webGLArrowHeadThickness * unitNormal.y)
    + dc * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x - webGLArrowHeadThickness * unitNormal.y)
  );

  vec2 position = (u_matrix * vec3(a_position + delta, 1)).xy;

  gl_Position = vec4(position, 0, 1);

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Ua=za,An=WebGLRenderingContext,yr=An.UNSIGNED_BYTE,Vt=An.FLOAT,Ma=["u_matrix","u_sizeRatio","u_correctionRatio","u_minEdgeThickness","u_lengthToThicknessRatio","u_widenessToThicknessRatio"],Bi={extremity:"target",lengthToThicknessRatio:2.5,widenessToThicknessRatio:2};function Qt(r){var t=I(I({},Bi),r||{});return function(e){function i(){return se(this,i),me(this,i,arguments)}return ye(i,e),ue(i,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:Ua,FRAGMENT_SHADER_SOURCE:$a,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Ma,ATTRIBUTES:[{name:"a_position",size:2,type:Vt},{name:"a_normal",size:2,type:Vt},{name:"a_radius",size:1,type:Vt},{name:"a_color",size:4,type:yr,normalized:!0},{name:"a_id",size:4,type:yr,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_barycentric",size:3,type:Vt}],CONSTANT_DATA:[[1,0,0],[0,1,0],[0,0,1]]}}},{key:"processVisibleItem",value:function(o,a,s,u,d){if(t.extremity==="source"){var h=[u,s];s=h[0],u=h[1]}var l=d.size||1,f=u.size||1,p=s.x,y=s.y,w=u.x,E=u.y,C=_t(d.color),T=w-p,S=E-y,c=T*T+S*S,b=0,m=0;c&&(c=1/Math.sqrt(c),b=-S*c*l,m=T*c*l);var _=this.array;_[a++]=w,_[a++]=E,_[a++]=-b,_[a++]=-m,_[a++]=f,_[a++]=C,_[a++]=o}},{key:"setUniforms",value:function(o,a){var s=a.gl,u=a.uniformLocations,d=u.u_matrix,h=u.u_sizeRatio,l=u.u_correctionRatio,f=u.u_minEdgeThickness,p=u.u_lengthToThicknessRatio,y=u.u_widenessToThicknessRatio;s.uniformMatrix3fv(d,!1,o.matrix),s.uniform1f(h,o.sizeRatio),s.uniform1f(l,o.correctionRatio),s.uniform1f(f,o.minEdgeThickness),s.uniform1f(p,t.lengthToThicknessRatio),s.uniform1f(y,t.widenessToThicknessRatio)}}])}(ni)}Qt();var Ba=`
precision mediump float;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  // We only handle antialiasing for normal mode:
  #ifdef PICKING_MODE
  gl_FragColor = v_color;
  #else
  float dist = length(v_normal) * v_thickness;

  float t = smoothstep(
    v_thickness - v_feather,
    v_thickness,
    dist
  );

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,Hi=Ba,Ha=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;
attribute float a_radius;
attribute float a_radiusCoef;

uniform mat3 u_matrix;
uniform float u_zoomRatio;
uniform float u_sizeRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float radius = a_radius * a_radiusCoef;
  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // These first computations are taken from edge.vert.glsl. Please read it to
  // get better comments on what's happening:
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here, we move the point to leave space for the arrow head:
  float direction = sign(radius);
  float webGLNodeRadius = direction * radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;

  vec2 compensationVector = vec2(-direction * unitNormal.y, direction * unitNormal.x) * (webGLNodeRadius + webGLArrowHeadLength);

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness + compensationVector, 1)).xy, 0, 1);

  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Wa=Ha,Rn=WebGLRenderingContext,br=Rn.UNSIGNED_BYTE,it=Rn.FLOAT,ja=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness","u_lengthToThicknessRatio"],Va={lengthToThicknessRatio:Bi.lengthToThicknessRatio};function Sn(r){var t=I(I({},Va),{});return function(e){function i(){return se(this,i),me(this,i,arguments)}return ye(i,e),ue(i,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Wa,FRAGMENT_SHADER_SOURCE:Hi,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:ja,ATTRIBUTES:[{name:"a_positionStart",size:2,type:it},{name:"a_positionEnd",size:2,type:it},{name:"a_normal",size:2,type:it},{name:"a_color",size:4,type:br,normalized:!0},{name:"a_id",size:4,type:br,normalized:!0},{name:"a_radius",size:1,type:it}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:it},{name:"a_normalCoef",size:1,type:it},{name:"a_radiusCoef",size:1,type:it}],CONSTANT_DATA:[[0,1,0],[0,-1,0],[1,1,1],[1,1,1],[0,-1,0],[1,-1,-1]]}}},{key:"processVisibleItem",value:function(o,a,s,u,d){var h=d.size||1,l=s.x,f=s.y,p=u.x,y=u.y,w=_t(d.color),E=p-l,C=y-f,T=u.size||1,S=E*E+C*C,c=0,b=0;S&&(S=1/Math.sqrt(S),c=-C*S*h,b=E*S*h);var m=this.array;m[a++]=l,m[a++]=f,m[a++]=p,m[a++]=y,m[a++]=c,m[a++]=b,m[a++]=w,m[a++]=o,m[a++]=T}},{key:"setUniforms",value:function(o,a){var s=a.gl,u=a.uniformLocations,d=u.u_matrix,h=u.u_zoomRatio,l=u.u_feather,f=u.u_pixelRatio,p=u.u_correctionRatio,y=u.u_sizeRatio,w=u.u_minEdgeThickness,E=u.u_lengthToThicknessRatio;s.uniformMatrix3fv(d,!1,o.matrix),s.uniform1f(h,o.zoomRatio),s.uniform1f(y,o.sizeRatio),s.uniform1f(p,o.correctionRatio),s.uniform1f(f,o.pixelRatio),s.uniform1f(l,o.antiAliasingFeather),s.uniform1f(w,o.minEdgeThickness),s.uniform1f(E,t.lengthToThicknessRatio)}}])}(ni)}Sn();function qa(r){return En([Sn(),Qt(r)])}var Ka=qa(),Li=Ka,Ya=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_zoomRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // We require edges to be at least "minThickness" pixels thick *on screen*
  // (so we need to compensate the size ratio):
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);

  // Then, we need to retrieve the normalized thickness of the edge in the WebGL
  // referential (in a ([0, 1], [0, 1]) space), using our "magic" correction
  // ratio:
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness, 1)).xy, 0, 1);

  // For the fragment shader though, we need a thickness that takes the "magic"
  // correction ratio into account (as in webGLThickness), but so that the
  // antialiasing effect does not depend on the zoom level. So here's yet
  // another thickness version:
  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Xa=Ya,Cn=WebGLRenderingContext,wr=Cn.UNSIGNED_BYTE,St=Cn.FLOAT,Za=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness"],Ja=function(r){function t(){return se(this,t),me(this,t,arguments)}return ye(t,r),ue(t,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Xa,FRAGMENT_SHADER_SOURCE:Hi,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Za,ATTRIBUTES:[{name:"a_positionStart",size:2,type:St},{name:"a_positionEnd",size:2,type:St},{name:"a_normal",size:2,type:St},{name:"a_color",size:4,type:wr,normalized:!0},{name:"a_id",size:4,type:wr,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:St},{name:"a_normalCoef",size:1,type:St}],CONSTANT_DATA:[[0,1],[0,-1],[1,1],[1,1],[0,-1],[1,-1]]}}},{key:"processVisibleItem",value:function(i,n,o,a,s){var u=s.size||1,d=o.x,h=o.y,l=a.x,f=a.y,p=_t(s.color),y=l-d,w=f-h,E=y*y+w*w,C=0,T=0;E&&(E=1/Math.sqrt(E),C=-w*E*u,T=y*E*u);var S=this.array;S[n++]=d,S[n++]=h,S[n++]=l,S[n++]=f,S[n++]=C,S[n++]=T,S[n++]=p,S[n++]=i}},{key:"setUniforms",value:function(i,n){var o=n.gl,a=n.uniformLocations,s=a.u_matrix,u=a.u_zoomRatio,d=a.u_feather,h=a.u_pixelRatio,l=a.u_correctionRatio,f=a.u_sizeRatio,p=a.u_minEdgeThickness;o.uniformMatrix3fv(s,!1,i.matrix),o.uniform1f(u,i.zoomRatio),o.uniform1f(f,i.sizeRatio),o.uniform1f(l,i.correctionRatio),o.uniform1f(h,i.pixelRatio),o.uniform1f(d,i.antiAliasingFeather),o.uniform1f(p,i.minEdgeThickness)}}])}(ni),Wi=function(r){function t(){var e;return se(this,t),e=me(this,t),e.rawEmitter=e,e}return ye(t,r),ue(t)}(Zr.EventEmitter),Qa=ln();const es=Xr(Qa);var ts=function(t){return t},is=function(t){return t*t},rs=function(t){return t*(2-t)},ns=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},os=function(t){return t*t*t},as=function(t){return--t*t*t+1},ss=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},us={linear:ts,quadraticIn:is,quadraticOut:rs,quadraticInOut:ns,cubicIn:os,cubicOut:as,cubicInOut:ss},ds={easing:"quadraticInOut",duration:150};function Pe(){return Float32Array.of(1,0,0,0,1,0,0,0,1)}function qt(r,t,e){return r[0]=t,r[4]=typeof e=="number"?e:t,r}function Er(r,t){var e=Math.sin(t),i=Math.cos(t);return r[0]=i,r[1]=e,r[3]=-e,r[4]=i,r}function _r(r,t,e){return r[6]=t,r[7]=e,r}function Qe(r,t){var e=r[0],i=r[1],n=r[2],o=r[3],a=r[4],s=r[5],u=r[6],d=r[7],h=r[8],l=t[0],f=t[1],p=t[2],y=t[3],w=t[4],E=t[5],C=t[6],T=t[7],S=t[8];return r[0]=l*e+f*o+p*u,r[1]=l*i+f*a+p*d,r[2]=l*n+f*s+p*h,r[3]=y*e+w*o+E*u,r[4]=y*i+w*a+E*d,r[5]=y*n+w*s+E*h,r[6]=C*e+T*o+S*u,r[7]=C*i+T*a+S*d,r[8]=C*n+T*s+S*h,r}function ki(r,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=r[0],n=r[1],o=r[3],a=r[4],s=r[6],u=r[7],d=t.x,h=t.y;return{x:d*i+h*o+s*e,y:d*n+h*a+u*e}}function hs(r,t){var e=r.height/r.width,i=t.height/t.width;return e<1&&i>1||e>1&&i<1?1:Math.min(Math.max(i,1/i),Math.max(1/e,e))}function Ct(r,t,e,i,n){var o=r.angle,a=r.ratio,s=r.x,u=r.y,d=t.width,h=t.height,l=Pe(),f=Math.min(d,h)-2*i,p=hs(t,e);return n?(Qe(l,_r(Pe(),s,u)),Qe(l,qt(Pe(),a)),Qe(l,Er(Pe(),o)),Qe(l,qt(Pe(),d/f/2/p,h/f/2/p))):(Qe(l,qt(Pe(),2*(f/d)*p,2*(f/h)*p)),Qe(l,Er(Pe(),-o)),Qe(l,qt(Pe(),1/a)),Qe(l,_r(Pe(),-s,-u))),l}function cs(r,t,e){var i=ki(r,{x:Math.cos(t.angle),y:Math.sin(t.angle)},0),n=i.x,o=i.y;return 1/Math.sqrt(Math.pow(n,2)+Math.pow(o,2))/e.width}function ls(r){if(!r.order)return{x:[0,1],y:[0,1]};var t=1/0,e=-1/0,i=1/0,n=-1/0;return r.forEachNode(function(o,a){var s=a.x,u=a.y;s<t&&(t=s),s>e&&(e=s),u<i&&(i=u),u>n&&(n=u)}),{x:[t,e],y:[i,n]}}function fs(r){if(!es(r))throw new Error("Sigma: invalid graph instance.");r.forEachNode(function(t,e){if(!Number.isFinite(e.x)||!Number.isFinite(e.y))throw new Error("Sigma: Coordinates of node ".concat(t," are invalid. A node must have a numeric 'x' and 'y' attribute."))})}function ps(r,t,e){var i=document.createElement(r);if(t)for(var n in t)i.style[n]=t[n];if(e)for(var o in e)i.setAttribute(o,e[o]);return i}function Tr(){return typeof window.devicePixelRatio<"u"?window.devicePixelRatio:1}function Ar(r,t,e){return e.sort(function(i,n){var o=t(i)||0,a=t(n)||0;return o<a?-1:o>a?1:0})}function Rr(r){var t=pt(r.x,2),e=t[0],i=t[1],n=pt(r.y,2),o=n[0],a=n[1],s=Math.max(i-e,a-o),u=(i+e)/2,d=(a+o)/2;(s===0||Math.abs(s)===1/0||isNaN(s))&&(s=1),isNaN(u)&&(u=0),isNaN(d)&&(d=0);var h=function(f){return{x:.5+(f.x-u)/s,y:.5+(f.y-d)/s}};return h.applyTo=function(l){l.x=.5+(l.x-u)/s,l.y=.5+(l.y-d)/s},h.inverse=function(l){return{x:u+s*(l.x-.5),y:d+s*(l.y-.5)}},h.ratio=s,h}function Gi(r){"@babel/helpers - typeof";return Gi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gi(r)}function Sr(r,t){var e=t.size;if(e!==0){var i=r.length;r.length+=e;var n=0;t.forEach(function(o){r[i+n]=o,n++})}}function wi(r){r=r||{};for(var t=0,e=arguments.length<=1?0:arguments.length-1;t<e;t++){var i=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];i&&Object.assign(r,i)}return r}var ji={hideEdgesOnMove:!1,hideLabelsOnMove:!1,renderLabels:!0,renderEdgeLabels:!1,enableEdgeEvents:!1,defaultNodeColor:"#999",defaultNodeType:"circle",defaultEdgeColor:"#ccc",defaultEdgeType:"line",labelFont:"Arial",labelSize:14,labelWeight:"normal",labelColor:{color:"#000"},edgeLabelFont:"Arial",edgeLabelSize:14,edgeLabelWeight:"normal",edgeLabelColor:{attribute:"color"},stagePadding:30,defaultDrawEdgeLabel:La,defaultDrawNodeLabel:_n,defaultDrawNodeHover:ka,minEdgeThickness:1.7,antiAliasingFeather:1,dragTimeout:100,draggedEventsTolerance:3,inertiaDuration:200,inertiaRatio:3,zoomDuration:250,zoomingRatio:1.7,doubleClickTimeout:300,doubleClickZoomingRatio:2.2,doubleClickZoomingDuration:200,tapMoveTolerance:10,zoomToSizeRatioFunction:Math.sqrt,itemSizesReference:"screen",autoRescale:!0,autoCenter:!0,labelDensity:1,labelGridCellSize:100,labelRenderedSizeThreshold:6,nodeReducer:null,edgeReducer:null,zIndex:!1,minCameraRatio:null,maxCameraRatio:null,enableCameraZooming:!0,enableCameraPanning:!0,enableCameraRotation:!0,cameraPanBoundaries:null,allowInvalidContainer:!1,nodeProgramClasses:{},nodeHoverProgramClasses:{},edgeProgramClasses:{}},gs={circle:It},vs={arrow:Li,line:Ja};function Ei(r){if(typeof r.labelDensity!="number"||r.labelDensity<0)throw new Error("Settings: invalid `labelDensity`. Expecting a positive number.");var t=r.minCameraRatio,e=r.maxCameraRatio;if(typeof t=="number"&&typeof e=="number"&&e<t)throw new Error("Settings: invalid camera ratio boundaries. Expecting `maxCameraRatio` to be greater than `minCameraRatio`.")}function ms(r){var t=wi({},ji,r);return t.nodeProgramClasses=wi({},gs,t.nodeProgramClasses),t.edgeProgramClasses=wi({},vs,t.edgeProgramClasses),t}var Kt=1.5,Cr=function(r){function t(){var e;return se(this,t),e=me(this,t),x(e,"x",.5),x(e,"y",.5),x(e,"angle",0),x(e,"ratio",1),x(e,"minRatio",null),x(e,"maxRatio",null),x(e,"enabledZooming",!0),x(e,"enabledPanning",!0),x(e,"enabledRotation",!0),x(e,"clean",null),x(e,"nextFrame",null),x(e,"previousState",null),x(e,"enabled",!0),e.previousState=e.getState(),e}return ye(t,r),ue(t,[{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"getState",value:function(){return{x:this.x,y:this.y,angle:this.angle,ratio:this.ratio}}},{key:"hasState",value:function(i){return this.x===i.x&&this.y===i.y&&this.ratio===i.ratio&&this.angle===i.angle}},{key:"getPreviousState",value:function(){var i=this.previousState;return i?{x:i.x,y:i.y,angle:i.angle,ratio:i.ratio}:null}},{key:"getBoundedRatio",value:function(i){var n=i;return typeof this.minRatio=="number"&&(n=Math.max(n,this.minRatio)),typeof this.maxRatio=="number"&&(n=Math.min(n,this.maxRatio)),n}},{key:"validateState",value:function(i){var n={};return this.enabledPanning&&typeof i.x=="number"&&(n.x=i.x),this.enabledPanning&&typeof i.y=="number"&&(n.y=i.y),this.enabledZooming&&typeof i.ratio=="number"&&(n.ratio=this.getBoundedRatio(i.ratio)),this.enabledRotation&&typeof i.angle=="number"&&(n.angle=i.angle),this.clean?this.clean(I(I({},this.getState()),n)):n}},{key:"isAnimated",value:function(){return!!this.nextFrame}},{key:"setState",value:function(i){if(!this.enabled)return this;this.previousState=this.getState();var n=this.validateState(i);return typeof n.x=="number"&&(this.x=n.x),typeof n.y=="number"&&(this.y=n.y),typeof n.ratio=="number"&&(this.ratio=n.ratio),typeof n.angle=="number"&&(this.angle=n.angle),this.hasState(this.previousState)||this.emit("updated",this.getState()),this}},{key:"updateState",value:function(i){return this.setState(i(this.getState())),this}},{key:"animate",value:function(i){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;if(!a)return new Promise(function(p){return n.animate(i,o,p)});if(this.enabled){var s=I(I({},ds),o),u=this.validateState(i),d=typeof s.easing=="function"?s.easing:us[s.easing],h=Date.now(),l=this.getState(),f=function(){var y=(Date.now()-h)/s.duration;if(y>=1){n.nextFrame=null,n.setState(u),n.animationCallback&&(n.animationCallback.call(null),n.animationCallback=void 0);return}var w=d(y),E={};typeof u.x=="number"&&(E.x=l.x+(u.x-l.x)*w),typeof u.y=="number"&&(E.y=l.y+(u.y-l.y)*w),n.enabledRotation&&typeof u.angle=="number"&&(E.angle=l.angle+(u.angle-l.angle)*w),typeof u.ratio=="number"&&(E.ratio=l.ratio+(u.ratio-l.ratio)*w),n.setState(E),n.nextFrame=requestAnimationFrame(f)};this.nextFrame?(cancelAnimationFrame(this.nextFrame),this.animationCallback&&this.animationCallback.call(null),this.nextFrame=requestAnimationFrame(f)):f(),this.animationCallback=a}}},{key:"animatedZoom",value:function(i){return i?typeof i=="number"?this.animate({ratio:this.ratio/i}):this.animate({ratio:this.ratio/(i.factor||Kt)},i):this.animate({ratio:this.ratio/Kt})}},{key:"animatedUnzoom",value:function(i){return i?typeof i=="number"?this.animate({ratio:this.ratio*i}):this.animate({ratio:this.ratio*(i.factor||Kt)},i):this.animate({ratio:this.ratio*Kt})}},{key:"animatedReset",value:function(i){return this.animate({x:.5,y:.5,ratio:1,angle:0},i)}},{key:"copy",value:function(){return t.from(this.getState())}}],[{key:"from",value:function(i){var n=new t;return n.setState(i)}}])}(Wi);function Fe(r,t){var e=t.getBoundingClientRect();return{x:r.clientX-e.left,y:r.clientY-e.top}}function Ke(r,t){var e=I(I({},Fe(r,t)),{},{sigmaDefaultPrevented:!1,preventSigmaDefault:function(){e.sigmaDefaultPrevented=!0},original:r});return e}function Dt(r){var t="x"in r?r:I(I({},r.touches[0]||r.previousTouches[0]),{},{original:r.original,sigmaDefaultPrevented:r.sigmaDefaultPrevented,preventSigmaDefault:function(){r.sigmaDefaultPrevented=!0,t.sigmaDefaultPrevented=!0}});return t}function ys(r,t){return I(I({},Ke(r,t)),{},{delta:Dn(r)})}var bs=2;function Zt(r){for(var t=[],e=0,i=Math.min(r.length,bs);e<i;e++)t.push(r[e]);return t}function xt(r,t,e){var i={touches:Zt(r.touches).map(function(n){return Fe(n,e)}),previousTouches:t.map(function(n){return Fe(n,e)}),sigmaDefaultPrevented:!1,preventSigmaDefault:function(){i.sigmaDefaultPrevented=!0},original:r};return i}function Dn(r){if(typeof r.deltaY<"u")return r.deltaY*-3/360;if(typeof r.detail<"u")return r.detail/-9;throw new Error("Captor: could not extract delta from event.")}var xn=function(r){function t(e,i){var n;return se(this,t),n=me(this,t),n.container=e,n.renderer=i,n}return ye(t,r),ue(t)}(Wi),ws=["doubleClickTimeout","doubleClickZoomingDuration","doubleClickZoomingRatio","dragTimeout","draggedEventsTolerance","inertiaDuration","inertiaRatio","zoomDuration","zoomingRatio"],Es=ws.reduce(function(r,t){return I(I({},r),{},x({},t,ji[t]))},{}),_s=function(r){function t(e,i){var n;return se(this,t),n=me(this,t,[e,i]),x(n,"enabled",!0),x(n,"draggedEvents",0),x(n,"downStartTime",null),x(n,"lastMouseX",null),x(n,"lastMouseY",null),x(n,"isMouseDown",!1),x(n,"isMoving",!1),x(n,"movingTimeout",null),x(n,"startCameraState",null),x(n,"clicks",0),x(n,"doubleClickTimeout",null),x(n,"currentWheelDirection",0),x(n,"settings",Es),n.handleClick=n.handleClick.bind(n),n.handleRightClick=n.handleRightClick.bind(n),n.handleDown=n.handleDown.bind(n),n.handleUp=n.handleUp.bind(n),n.handleMove=n.handleMove.bind(n),n.handleWheel=n.handleWheel.bind(n),n.handleLeave=n.handleLeave.bind(n),n.handleEnter=n.handleEnter.bind(n),e.addEventListener("click",n.handleClick,{capture:!1}),e.addEventListener("contextmenu",n.handleRightClick,{capture:!1}),e.addEventListener("mousedown",n.handleDown,{capture:!1}),e.addEventListener("wheel",n.handleWheel,{capture:!1}),e.addEventListener("mouseleave",n.handleLeave,{capture:!1}),e.addEventListener("mouseenter",n.handleEnter,{capture:!1}),document.addEventListener("mousemove",n.handleMove,{capture:!1}),document.addEventListener("mouseup",n.handleUp,{capture:!1}),n}return ye(t,r),ue(t,[{key:"kill",value:function(){var i=this.container;i.removeEventListener("click",this.handleClick),i.removeEventListener("contextmenu",this.handleRightClick),i.removeEventListener("mousedown",this.handleDown),i.removeEventListener("wheel",this.handleWheel),i.removeEventListener("mouseleave",this.handleLeave),i.removeEventListener("mouseenter",this.handleEnter),document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleUp)}},{key:"handleClick",value:function(i){var n=this;if(this.enabled){if(this.clicks++,this.clicks===2)return this.clicks=0,typeof this.doubleClickTimeout=="number"&&(clearTimeout(this.doubleClickTimeout),this.doubleClickTimeout=null),this.handleDoubleClick(i);setTimeout(function(){n.clicks=0,n.doubleClickTimeout=null},this.settings.doubleClickTimeout),this.draggedEvents<this.settings.draggedEventsTolerance&&this.emit("click",Ke(i,this.container))}}},{key:"handleRightClick",value:function(i){this.enabled&&this.emit("rightClick",Ke(i,this.container))}},{key:"handleDoubleClick",value:function(i){if(this.enabled){i.preventDefault(),i.stopPropagation();var n=Ke(i,this.container);if(this.emit("doubleClick",n),!n.sigmaDefaultPrevented){var o=this.renderer.getCamera(),a=o.getBoundedRatio(o.getState().ratio/this.settings.doubleClickZoomingRatio);o.animate(this.renderer.getViewportZoomedState(Fe(i,this.container),a),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}}},{key:"handleDown",value:function(i){if(this.enabled){if(i.button===0){this.startCameraState=this.renderer.getCamera().getState();var n=Fe(i,this.container),o=n.x,a=n.y;this.lastMouseX=o,this.lastMouseY=a,this.draggedEvents=0,this.downStartTime=Date.now(),this.isMouseDown=!0}this.emit("mousedown",Ke(i,this.container))}}},{key:"handleUp",value:function(i){var n=this;if(!(!this.enabled||!this.isMouseDown)){var o=this.renderer.getCamera();this.isMouseDown=!1,typeof this.movingTimeout=="number"&&(clearTimeout(this.movingTimeout),this.movingTimeout=null);var a=Fe(i,this.container),s=a.x,u=a.y,d=o.getState(),h=o.getPreviousState()||{x:0,y:0};this.isMoving?o.animate({x:d.x+this.settings.inertiaRatio*(d.x-h.x),y:d.y+this.settings.inertiaRatio*(d.y-h.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"}):(this.lastMouseX!==s||this.lastMouseY!==u)&&o.setState({x:d.x,y:d.y}),this.isMoving=!1,setTimeout(function(){var l=n.draggedEvents>0;n.draggedEvents=0,l&&n.renderer.getSetting("hideEdgesOnMove")&&n.renderer.refresh()},0),this.emit("mouseup",Ke(i,this.container))}}},{key:"handleMove",value:function(i){var n=this;if(this.enabled){var o=Ke(i,this.container);if(this.emit("mousemovebody",o),(i.target===this.container||i.composedPath()[0]===this.container)&&this.emit("mousemove",o),!o.sigmaDefaultPrevented&&this.isMouseDown){this.isMoving=!0,this.draggedEvents++,typeof this.movingTimeout=="number"&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){n.movingTimeout=null,n.isMoving=!1},this.settings.dragTimeout);var a=this.renderer.getCamera(),s=Fe(i,this.container),u=s.x,d=s.y,h=this.renderer.viewportToFramedGraph({x:this.lastMouseX,y:this.lastMouseY}),l=this.renderer.viewportToFramedGraph({x:u,y:d}),f=h.x-l.x,p=h.y-l.y,y=a.getState(),w=y.x+f,E=y.y+p;a.setState({x:w,y:E}),this.lastMouseX=u,this.lastMouseY=d,i.preventDefault(),i.stopPropagation()}}}},{key:"handleLeave",value:function(i){this.emit("mouseleave",Ke(i,this.container))}},{key:"handleEnter",value:function(i){this.emit("mouseenter",Ke(i,this.container))}},{key:"handleWheel",value:function(i){var n=this,o=this.renderer.getCamera();if(!(!this.enabled||!o.enabledZooming)){var a=Dn(i);if(a){var s=ys(i,this.container);if(this.emit("wheel",s),s.sigmaDefaultPrevented){i.preventDefault(),i.stopPropagation();return}var u=o.getState().ratio,d=a>0?1/this.settings.zoomingRatio:this.settings.zoomingRatio,h=o.getBoundedRatio(u*d),l=a>0?1:-1,f=Date.now();u!==h&&(i.preventDefault(),i.stopPropagation(),!(this.currentWheelDirection===l&&this.lastWheelTriggerTime&&f-this.lastWheelTriggerTime<this.settings.zoomDuration/5)&&(o.animate(this.renderer.getViewportZoomedState(Fe(i,this.container),h),{easing:"quadraticOut",duration:this.settings.zoomDuration},function(){n.currentWheelDirection=0}),this.currentWheelDirection=l,this.lastWheelTriggerTime=f))}}}},{key:"setSettings",value:function(i){this.settings=i}}])}(xn),Ts=["dragTimeout","inertiaDuration","inertiaRatio","doubleClickTimeout","doubleClickZoomingRatio","doubleClickZoomingDuration","tapMoveTolerance"],As=Ts.reduce(function(r,t){return I(I({},r),{},x({},t,ji[t]))},{}),Rs=function(r){function t(e,i){var n;return se(this,t),n=me(this,t,[e,i]),x(n,"enabled",!0),x(n,"isMoving",!1),x(n,"hasMoved",!1),x(n,"touchMode",0),x(n,"startTouchesPositions",[]),x(n,"lastTouches",[]),x(n,"lastTap",null),x(n,"settings",As),n.handleStart=n.handleStart.bind(n),n.handleLeave=n.handleLeave.bind(n),n.handleMove=n.handleMove.bind(n),e.addEventListener("touchstart",n.handleStart,{capture:!1}),e.addEventListener("touchcancel",n.handleLeave,{capture:!1}),document.addEventListener("touchend",n.handleLeave,{capture:!1,passive:!1}),document.addEventListener("touchmove",n.handleMove,{capture:!1,passive:!1}),n}return ye(t,r),ue(t,[{key:"kill",value:function(){var i=this.container;i.removeEventListener("touchstart",this.handleStart),i.removeEventListener("touchcancel",this.handleLeave),document.removeEventListener("touchend",this.handleLeave),document.removeEventListener("touchmove",this.handleMove)}},{key:"getDimensions",value:function(){return{width:this.container.offsetWidth,height:this.container.offsetHeight}}},{key:"handleStart",value:function(i){var n=this;if(this.enabled){i.preventDefault();var o=Zt(i.touches);if(this.touchMode=o.length,this.startCameraState=this.renderer.getCamera().getState(),this.startTouchesPositions=o.map(function(p){return Fe(p,n.container)}),this.touchMode===2){var a=pt(this.startTouchesPositions,2),s=a[0],u=s.x,d=s.y,h=a[1],l=h.x,f=h.y;this.startTouchesAngle=Math.atan2(f-d,l-u),this.startTouchesDistance=Math.sqrt(Math.pow(l-u,2)+Math.pow(f-d,2))}this.emit("touchdown",xt(i,this.lastTouches,this.container)),this.lastTouches=o,this.lastTouchesPositions=this.startTouchesPositions}}},{key:"handleLeave",value:function(i){if(!(!this.enabled||!this.startTouchesPositions.length)){switch(i.cancelable&&i.preventDefault(),this.movingTimeout&&(this.isMoving=!1,clearTimeout(this.movingTimeout)),this.touchMode){case 2:if(i.touches.length===1){this.handleStart(i),i.preventDefault();break}case 1:if(this.isMoving){var n=this.renderer.getCamera(),o=n.getState(),a=n.getPreviousState()||{x:0,y:0};n.animate({x:o.x+this.settings.inertiaRatio*(o.x-a.x),y:o.y+this.settings.inertiaRatio*(o.y-a.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"})}this.hasMoved=!1,this.isMoving=!1,this.touchMode=0;break}if(this.emit("touchup",xt(i,this.lastTouches,this.container)),!i.touches.length){var s=Fe(this.lastTouches[0],this.container),u=this.startTouchesPositions[0],d=Math.pow(s.x-u.x,2)+Math.pow(s.y-u.y,2);if(!i.touches.length&&d<Math.pow(this.settings.tapMoveTolerance,2))if(this.lastTap&&Date.now()-this.lastTap.time<this.settings.doubleClickTimeout){var h=xt(i,this.lastTouches,this.container);if(this.emit("doubletap",h),this.lastTap=null,!h.sigmaDefaultPrevented){var l=this.renderer.getCamera(),f=l.getBoundedRatio(l.getState().ratio/this.settings.doubleClickZoomingRatio);l.animate(this.renderer.getViewportZoomedState(s,f),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}else{var p=xt(i,this.lastTouches,this.container);this.emit("tap",p),this.lastTap={time:Date.now(),position:p.touches[0]||p.previousTouches[0]}}}this.lastTouches=Zt(i.touches),this.startTouchesPositions=[]}}},{key:"handleMove",value:function(i){var n=this;if(!(!this.enabled||!this.startTouchesPositions.length)){i.preventDefault();var o=Zt(i.touches),a=o.map(function(re){return Fe(re,n.container)}),s=this.lastTouches;this.lastTouches=o,this.lastTouchesPositions=a;var u=xt(i,s,this.container);if(this.emit("touchmove",u),!u.sigmaDefaultPrevented&&(this.hasMoved||(this.hasMoved=a.some(function(re,Z){var N=n.startTouchesPositions[Z];return N&&(re.x!==N.x||re.y!==N.y)})),!!this.hasMoved)){this.isMoving=!0,this.movingTimeout&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){n.isMoving=!1},this.settings.dragTimeout);var d=this.renderer.getCamera(),h=this.startCameraState,l=this.renderer.getSetting("stagePadding");switch(this.touchMode){case 1:{var f=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0]),p=f.x,y=f.y,w=this.renderer.viewportToFramedGraph(a[0]),E=w.x,C=w.y;d.setState({x:h.x+p-E,y:h.y+y-C});break}case 2:{var T={x:.5,y:.5,angle:0,ratio:1},S=a[0],c=S.x,b=S.y,m=a[1],_=m.x,G=m.y,k=Math.atan2(G-b,_-c)-this.startTouchesAngle,O=Math.hypot(G-b,_-c)/this.startTouchesDistance,H=d.getBoundedRatio(h.ratio/O);T.ratio=H,T.angle=h.angle+k;var F=this.getDimensions(),g=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0],{cameraState:h}),q=Math.min(F.width,F.height)-2*l,J=q/F.width,D=q/F.height,v=H/q,M=c-q/2/J,j=b-q/2/D,ee=[M*Math.cos(-T.angle)-j*Math.sin(-T.angle),j*Math.cos(-T.angle)+M*Math.sin(-T.angle)];M=ee[0],j=ee[1],T.x=g.x-M*v,T.y=g.y+j*v,d.setState(T);break}}}}}},{key:"setSettings",value:function(i){this.settings=i}}])}(xn);function Ss(r){if(Array.isArray(r))return Di(r)}function Cs(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Ds(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dr(r){return Ss(r)||Cs(r)||pn(r)||Ds()}function xs(r,t){if(r==null)return{};var e={};for(var i in r)if({}.hasOwnProperty.call(r,i)){if(t.includes(i))continue;e[i]=r[i]}return e}function _i(r,t){if(r==null)return{};var e,i,n=xs(r,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(i=0;i<o.length;i++)e=o[i],t.includes(e)||{}.propertyIsEnumerable.call(r,e)&&(n[e]=r[e])}return n}var xr=function(){function r(t,e){se(this,r),this.key=t,this.size=e}return ue(r,null,[{key:"compare",value:function(e,i){return e.size>i.size?-1:e.size<i.size||e.key>i.key?1:-1}}])}(),Lr=function(){function r(){se(this,r),x(this,"width",0),x(this,"height",0),x(this,"cellSize",0),x(this,"columns",0),x(this,"rows",0),x(this,"cells",{})}return ue(r,[{key:"resizeAndClear",value:function(e,i){this.width=e.width,this.height=e.height,this.cellSize=i,this.columns=Math.ceil(e.width/i),this.rows=Math.ceil(e.height/i),this.cells={}}},{key:"getIndex",value:function(e){var i=Math.floor(e.x/this.cellSize),n=Math.floor(e.y/this.cellSize);return n*this.columns+i}},{key:"add",value:function(e,i,n){var o=new xr(e,i),a=this.getIndex(n),s=this.cells[a];s||(s=[],this.cells[a]=s),s.push(o)}},{key:"organize",value:function(){for(var e in this.cells){var i=this.cells[e];i.sort(xr.compare)}}},{key:"getLabelsToDisplay",value:function(e,i){var n=this.cellSize*this.cellSize,o=n/e/e,a=o*i/n,s=Math.ceil(a),u=[];for(var d in this.cells)for(var h=this.cells[d],l=0;l<Math.min(s,h.length);l++)u.push(h[l].key);return u}}])}();function Ls(r){var t=r.graph,e=r.hoveredNode,i=r.highlightedNodes,n=r.displayedNodeLabels,o=[];return t.forEachEdge(function(a,s,u,d){(u===e||d===e||i.has(u)||i.has(d)||n.has(u)&&n.has(d))&&o.push(a)}),o}var ks=150,Gs=50,Ye=Object.prototype.hasOwnProperty;function Os(r,t,e){if(!Ye.call(e,"x")||!Ye.call(e,"y"))throw new Error('Sigma: could not find a valid position (x, y) for node "'.concat(t,'". All your nodes must have a number "x" and "y". Maybe your forgot to apply a layout or your "nodeReducer" is not returning the correct data?'));return e.color||(e.color=r.defaultNodeColor),!e.label&&e.label!==""&&(e.label=null),e.label!==void 0&&e.label!==null?e.label=""+e.label:e.label=null,e.size||(e.size=2),Ye.call(e,"hidden")||(e.hidden=!1),Ye.call(e,"highlighted")||(e.highlighted=!1),Ye.call(e,"forceLabel")||(e.forceLabel=!1),(!e.type||e.type==="")&&(e.type=r.defaultNodeType),e.zIndex||(e.zIndex=0),e}function Ps(r,t,e){return e.color||(e.color=r.defaultEdgeColor),e.label||(e.label=""),e.size||(e.size=.5),Ye.call(e,"hidden")||(e.hidden=!1),Ye.call(e,"forceLabel")||(e.forceLabel=!1),(!e.type||e.type==="")&&(e.type=r.defaultEdgeType),e.zIndex||(e.zIndex=0),e}var Fs=function(r){function t(e,i){var n,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(se(this,t),n=me(this,t),x(n,"elements",{}),x(n,"canvasContexts",{}),x(n,"webGLContexts",{}),x(n,"pickingLayers",new Set),x(n,"textures",{}),x(n,"frameBuffers",{}),x(n,"activeListeners",{}),x(n,"labelGrid",new Lr),x(n,"nodeDataCache",{}),x(n,"edgeDataCache",{}),x(n,"nodeProgramIndex",{}),x(n,"edgeProgramIndex",{}),x(n,"nodesWithForcedLabels",new Set),x(n,"edgesWithForcedLabels",new Set),x(n,"nodeExtent",{x:[0,1],y:[0,1]}),x(n,"nodeZExtent",[1/0,-1/0]),x(n,"edgeZExtent",[1/0,-1/0]),x(n,"matrix",Pe()),x(n,"invMatrix",Pe()),x(n,"correctionRatio",1),x(n,"customBBox",null),x(n,"normalizationFunction",Rr({x:[0,1],y:[0,1]})),x(n,"graphToViewportRatio",1),x(n,"itemIDsIndex",{}),x(n,"nodeIndices",{}),x(n,"edgeIndices",{}),x(n,"width",0),x(n,"height",0),x(n,"pixelRatio",Tr()),x(n,"pickingDownSizingRatio",2*n.pixelRatio),x(n,"displayedNodeLabels",new Set),x(n,"displayedEdgeLabels",new Set),x(n,"highlightedNodes",new Set),x(n,"hoveredNode",null),x(n,"hoveredEdge",null),x(n,"renderFrame",null),x(n,"renderHighlightedNodesFrame",null),x(n,"needToProcess",!1),x(n,"checkEdgesEventsFrame",null),x(n,"nodePrograms",{}),x(n,"nodeHoverPrograms",{}),x(n,"edgePrograms",{}),n.settings=ms(o),Ei(n.settings),fs(e),!(i instanceof HTMLElement))throw new Error("Sigma: container should be an html element.");n.graph=e,n.container=i,n.createWebGLContext("edges",{picking:o.enableEdgeEvents}),n.createCanvasContext("edgeLabels"),n.createWebGLContext("nodes",{picking:!0}),n.createCanvasContext("labels"),n.createCanvasContext("hovers"),n.createWebGLContext("hoverNodes"),n.createCanvasContext("mouse",{style:{touchAction:"none",userSelect:"none"}}),n.resize();for(var a in n.settings.nodeProgramClasses)n.registerNodeProgram(a,n.settings.nodeProgramClasses[a],n.settings.nodeHoverProgramClasses[a]);for(var s in n.settings.edgeProgramClasses)n.registerEdgeProgram(s,n.settings.edgeProgramClasses[s]);return n.camera=new Cr,n.bindCameraHandlers(),n.mouseCaptor=new _s(n.elements.mouse,n),n.mouseCaptor.setSettings(n.settings),n.touchCaptor=new Rs(n.elements.mouse,n),n.touchCaptor.setSettings(n.settings),n.bindEventHandlers(),n.bindGraphHandlers(),n.handleSettingsUpdate(),n.refresh(),n}return ye(t,r),ue(t,[{key:"registerNodeProgram",value:function(i,n,o){return this.nodePrograms[i]&&this.nodePrograms[i].kill(),this.nodeHoverPrograms[i]&&this.nodeHoverPrograms[i].kill(),this.nodePrograms[i]=new n(this.webGLContexts.nodes,this.frameBuffers.nodes,this),this.nodeHoverPrograms[i]=new(o||n)(this.webGLContexts.hoverNodes,null,this),this}},{key:"registerEdgeProgram",value:function(i,n){return this.edgePrograms[i]&&this.edgePrograms[i].kill(),this.edgePrograms[i]=new n(this.webGLContexts.edges,this.frameBuffers.edges,this),this}},{key:"unregisterNodeProgram",value:function(i){if(this.nodePrograms[i]){var n=this.nodePrograms,o=n[i],a=_i(n,[i].map(kt));o.kill(),this.nodePrograms=a}if(this.nodeHoverPrograms[i]){var s=this.nodeHoverPrograms,u=s[i],d=_i(s,[i].map(kt));u.kill(),this.nodePrograms=d}return this}},{key:"unregisterEdgeProgram",value:function(i){if(this.edgePrograms[i]){var n=this.edgePrograms,o=n[i],a=_i(n,[i].map(kt));o.kill(),this.edgePrograms=a}return this}},{key:"resetWebGLTexture",value:function(i){var n=this.webGLContexts[i],o=this.frameBuffers[i],a=this.textures[i];a&&n.deleteTexture(a);var s=n.createTexture();return n.bindFramebuffer(n.FRAMEBUFFER,o),n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,null),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0),this.textures[i]=s,this}},{key:"bindCameraHandlers",value:function(){var i=this;return this.activeListeners.camera=function(){i.scheduleRender()},this.camera.on("updated",this.activeListeners.camera),this}},{key:"unbindCameraHandlers",value:function(){return this.camera.removeListener("updated",this.activeListeners.camera),this}},{key:"getNodeAtPosition",value:function(i){var n=i.x,o=i.y,a=fr(this.webGLContexts.nodes,this.frameBuffers.nodes,n,o,this.pixelRatio,this.pickingDownSizingRatio),s=lr.apply(void 0,Dr(a)),u=this.itemIDsIndex[s];return u&&u.type==="node"?u.id:null}},{key:"bindEventHandlers",value:function(){var i=this;this.activeListeners.handleResize=function(){i.scheduleRefresh()},window.addEventListener("resize",this.activeListeners.handleResize),this.activeListeners.handleMove=function(o){var a=Dt(o),s={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}},u=i.getNodeAtPosition(a);if(u&&i.hoveredNode!==u&&!i.nodeDataCache[u].hidden){i.hoveredNode&&i.emit("leaveNode",I(I({},s),{},{node:i.hoveredNode})),i.hoveredNode=u,i.emit("enterNode",I(I({},s),{},{node:u})),i.scheduleHighlightedNodesRender();return}if(i.hoveredNode&&i.getNodeAtPosition(a)!==i.hoveredNode){var d=i.hoveredNode;i.hoveredNode=null,i.emit("leaveNode",I(I({},s),{},{node:d})),i.scheduleHighlightedNodesRender();return}if(i.settings.enableEdgeEvents){var h=i.hoveredNode?null:i.getEdgeAtPoint(s.event.x,s.event.y);h!==i.hoveredEdge&&(i.hoveredEdge&&i.emit("leaveEdge",I(I({},s),{},{edge:i.hoveredEdge})),h&&i.emit("enterEdge",I(I({},s),{},{edge:h})),i.hoveredEdge=h)}},this.activeListeners.handleMoveBody=function(o){var a=Dt(o);i.emit("moveBody",{event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}})},this.activeListeners.handleLeave=function(o){var a=Dt(o),s={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}};i.hoveredNode&&(i.emit("leaveNode",I(I({},s),{},{node:i.hoveredNode})),i.scheduleHighlightedNodesRender()),i.settings.enableEdgeEvents&&i.hoveredEdge&&(i.emit("leaveEdge",I(I({},s),{},{edge:i.hoveredEdge})),i.scheduleHighlightedNodesRender()),i.emit("leaveStage",I({},s))},this.activeListeners.handleEnter=function(o){var a=Dt(o),s={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}};i.emit("enterStage",I({},s))};var n=function(a){return function(s){var u=Dt(s),d={event:u,preventSigmaDefault:function(){u.preventSigmaDefault()}},h=i.getNodeAtPosition(u);if(h)return i.emit("".concat(a,"Node"),I(I({},d),{},{node:h}));if(i.settings.enableEdgeEvents){var l=i.getEdgeAtPoint(u.x,u.y);if(l)return i.emit("".concat(a,"Edge"),I(I({},d),{},{edge:l}))}return i.emit("".concat(a,"Stage"),d)}};return this.activeListeners.handleClick=n("click"),this.activeListeners.handleRightClick=n("rightClick"),this.activeListeners.handleDoubleClick=n("doubleClick"),this.activeListeners.handleWheel=n("wheel"),this.activeListeners.handleDown=n("down"),this.activeListeners.handleUp=n("up"),this.mouseCaptor.on("mousemove",this.activeListeners.handleMove),this.mouseCaptor.on("mousemovebody",this.activeListeners.handleMoveBody),this.mouseCaptor.on("click",this.activeListeners.handleClick),this.mouseCaptor.on("rightClick",this.activeListeners.handleRightClick),this.mouseCaptor.on("doubleClick",this.activeListeners.handleDoubleClick),this.mouseCaptor.on("wheel",this.activeListeners.handleWheel),this.mouseCaptor.on("mousedown",this.activeListeners.handleDown),this.mouseCaptor.on("mouseup",this.activeListeners.handleUp),this.mouseCaptor.on("mouseleave",this.activeListeners.handleLeave),this.mouseCaptor.on("mouseenter",this.activeListeners.handleEnter),this.touchCaptor.on("touchdown",this.activeListeners.handleDown),this.touchCaptor.on("touchdown",this.activeListeners.handleMove),this.touchCaptor.on("touchup",this.activeListeners.handleUp),this.touchCaptor.on("touchmove",this.activeListeners.handleMove),this.touchCaptor.on("tap",this.activeListeners.handleClick),this.touchCaptor.on("doubletap",this.activeListeners.handleDoubleClick),this.touchCaptor.on("touchmove",this.activeListeners.handleMoveBody),this}},{key:"bindGraphHandlers",value:function(){var i=this,n=this.graph,o=new Set(["x","y","zIndex","type"]);return this.activeListeners.eachNodeAttributesUpdatedGraphUpdate=function(a){var s,u=(s=a.hints)===null||s===void 0?void 0:s.attributes;i.graph.forEachNode(function(h){return i.updateNode(h)});var d=!u||u.some(function(h){return o.has(h)});i.refresh({partialGraph:{nodes:n.nodes()},skipIndexation:!d,schedule:!0})},this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate=function(a){var s,u=(s=a.hints)===null||s===void 0?void 0:s.attributes;i.graph.forEachEdge(function(h){return i.updateEdge(h)});var d=u&&["zIndex","type"].some(function(h){return u==null?void 0:u.includes(h)});i.refresh({partialGraph:{edges:n.edges()},skipIndexation:!d,schedule:!0})},this.activeListeners.addNodeGraphUpdate=function(a){var s=a.key;i.addNode(s),i.refresh({partialGraph:{nodes:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.updateNodeGraphUpdate=function(a){var s=a.key;i.refresh({partialGraph:{nodes:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropNodeGraphUpdate=function(a){var s=a.key;i.removeNode(s),i.refresh({schedule:!0})},this.activeListeners.addEdgeGraphUpdate=function(a){var s=a.key;i.addEdge(s),i.refresh({partialGraph:{edges:[s]},schedule:!0})},this.activeListeners.updateEdgeGraphUpdate=function(a){var s=a.key;i.refresh({partialGraph:{edges:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropEdgeGraphUpdate=function(a){var s=a.key;i.removeEdge(s),i.refresh({schedule:!0})},this.activeListeners.clearEdgesGraphUpdate=function(){i.clearEdgeState(),i.clearEdgeIndices(),i.refresh({schedule:!0})},this.activeListeners.clearGraphUpdate=function(){i.clearEdgeState(),i.clearNodeState(),i.clearEdgeIndices(),i.clearNodeIndices(),i.refresh({schedule:!0})},n.on("nodeAdded",this.activeListeners.addNodeGraphUpdate),n.on("nodeDropped",this.activeListeners.dropNodeGraphUpdate),n.on("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),n.on("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),n.on("edgeAdded",this.activeListeners.addEdgeGraphUpdate),n.on("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),n.on("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),n.on("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),n.on("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),n.on("cleared",this.activeListeners.clearGraphUpdate),this}},{key:"unbindGraphHandlers",value:function(){var i=this.graph;i.removeListener("nodeAdded",this.activeListeners.addNodeGraphUpdate),i.removeListener("nodeDropped",this.activeListeners.dropNodeGraphUpdate),i.removeListener("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),i.removeListener("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),i.removeListener("edgeAdded",this.activeListeners.addEdgeGraphUpdate),i.removeListener("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),i.removeListener("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),i.removeListener("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),i.removeListener("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),i.removeListener("cleared",this.activeListeners.clearGraphUpdate)}},{key:"getEdgeAtPoint",value:function(i,n){var o=fr(this.webGLContexts.edges,this.frameBuffers.edges,i,n,this.pixelRatio,this.pickingDownSizingRatio),a=lr.apply(void 0,Dr(o)),s=this.itemIDsIndex[a];return s&&s.type==="edge"?s.id:null}},{key:"process",value:function(){var i=this;this.emit("beforeProcess");var n=this.graph,o=this.settings,a=this.getDimensions();if(this.nodeExtent=ls(this.graph),!this.settings.autoRescale){var s=a.width,u=a.height,d=this.nodeExtent,h=d.x,l=d.y;this.nodeExtent={x:[(h[0]+h[1])/2-s/2,(h[0]+h[1])/2+s/2],y:[(l[0]+l[1])/2-u/2,(l[0]+l[1])/2+u/2]}}this.normalizationFunction=Rr(this.customBBox||this.nodeExtent);var f=new Cr,p=Ct(f.getState(),a,this.getGraphDimensions(),this.getStagePadding());this.labelGrid.resizeAndClear(a,o.labelGridCellSize);for(var y={},w={},E={},C={},T=1,S=n.nodes(),c=0,b=S.length;c<b;c++){var m=S[c],_=this.nodeDataCache[m],G=n.getNodeAttributes(m);_.x=G.x,_.y=G.y,this.normalizationFunction.applyTo(_),typeof _.label=="string"&&!_.hidden&&this.labelGrid.add(m,_.size,this.framedGraphToViewport(_,{matrix:p})),y[_.type]=(y[_.type]||0)+1}this.labelGrid.organize();for(var k in this.nodePrograms){if(!Ye.call(this.nodePrograms,k))throw new Error('Sigma: could not find a suitable program for node type "'.concat(k,'"!'));this.nodePrograms[k].reallocate(y[k]||0),y[k]=0}this.settings.zIndex&&this.nodeZExtent[0]!==this.nodeZExtent[1]&&(S=Ar(this.nodeZExtent,function(ie){return i.nodeDataCache[ie].zIndex},S));for(var O=0,H=S.length;O<H;O++){var F=S[O];w[F]=T,C[w[F]]={type:"node",id:F},T++;var g=this.nodeDataCache[F];this.addNodeToProgram(F,w[F],y[g.type]++)}for(var q={},J=n.edges(),D=0,v=J.length;D<v;D++){var M=J[D],j=this.edgeDataCache[M];q[j.type]=(q[j.type]||0)+1}this.settings.zIndex&&this.edgeZExtent[0]!==this.edgeZExtent[1]&&(J=Ar(this.edgeZExtent,function(ie){return i.edgeDataCache[ie].zIndex},J));for(var ee in this.edgePrograms){if(!Ye.call(this.edgePrograms,ee))throw new Error('Sigma: could not find a suitable program for edge type "'.concat(ee,'"!'));this.edgePrograms[ee].reallocate(q[ee]||0),q[ee]=0}for(var re=0,Z=J.length;re<Z;re++){var N=J[re];E[N]=T,C[E[N]]={type:"edge",id:N},T++;var he=this.edgeDataCache[N];this.addEdgeToProgram(N,E[N],q[he.type]++)}return this.itemIDsIndex=C,this.nodeIndices=w,this.edgeIndices=E,this.emit("afterProcess"),this}},{key:"handleSettingsUpdate",value:function(i){var n=this,o=this.settings;if(this.camera.minRatio=o.minCameraRatio,this.camera.maxRatio=o.maxCameraRatio,this.camera.enabledZooming=o.enableCameraZooming,this.camera.enabledPanning=o.enableCameraPanning,this.camera.enabledRotation=o.enableCameraRotation,o.cameraPanBoundaries?this.camera.clean=function(h){return n.cleanCameraState(h,o.cameraPanBoundaries&&Gi(o.cameraPanBoundaries)==="object"?o.cameraPanBoundaries:{})}:this.camera.clean=null,this.camera.setState(this.camera.validateState(this.camera.getState())),i){if(i.edgeProgramClasses!==o.edgeProgramClasses){for(var a in o.edgeProgramClasses)o.edgeProgramClasses[a]!==i.edgeProgramClasses[a]&&this.registerEdgeProgram(a,o.edgeProgramClasses[a]);for(var s in i.edgeProgramClasses)o.edgeProgramClasses[s]||this.unregisterEdgeProgram(s)}if(i.nodeProgramClasses!==o.nodeProgramClasses||i.nodeHoverProgramClasses!==o.nodeHoverProgramClasses){for(var u in o.nodeProgramClasses)(o.nodeProgramClasses[u]!==i.nodeProgramClasses[u]||o.nodeHoverProgramClasses[u]!==i.nodeHoverProgramClasses[u])&&this.registerNodeProgram(u,o.nodeProgramClasses[u],o.nodeHoverProgramClasses[u]);for(var d in i.nodeProgramClasses)o.nodeProgramClasses[d]||this.unregisterNodeProgram(d)}}return this.mouseCaptor.setSettings(this.settings),this.touchCaptor.setSettings(this.settings),this}},{key:"cleanCameraState",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=n.tolerance,a=o===void 0?0:o,s=n.boundaries,u=I({},i),d=s||this.nodeExtent,h=pt(d.x,2),l=h[0],f=h[1],p=pt(d.y,2),y=p[0],w=p[1],E=[this.graphToViewport({x:l,y},{cameraState:i}),this.graphToViewport({x:f,y},{cameraState:i}),this.graphToViewport({x:l,y:w},{cameraState:i}),this.graphToViewport({x:f,y:w},{cameraState:i})],C=1/0,T=-1/0,S=1/0,c=-1/0;E.forEach(function(q){var J=q.x,D=q.y;C=Math.min(C,J),T=Math.max(T,J),S=Math.min(S,D),c=Math.max(c,D)});var b=T-C,m=c-S,_=this.getDimensions(),G=_.width,k=_.height,O=0,H=0;if(b>=G?T<G-a?O=T-(G-a):C>a&&(O=C-a):T>G+a?O=T-(G+a):C<-a&&(O=C+a),m>=k?c<k-a?H=c-(k-a):S>a&&(H=S-a):c>k+a?H=c-(k+a):S<-a&&(H=S+a),O||H){var F=this.viewportToFramedGraph({x:0,y:0},{cameraState:i}),g=this.viewportToFramedGraph({x:O,y:H},{cameraState:i});O=g.x-F.x,H=g.y-F.y,u.x+=O,u.y+=H}return u}},{key:"renderLabels",value:function(){if(!this.settings.renderLabels)return this;var i=this.camera.getState(),n=this.labelGrid.getLabelsToDisplay(i.ratio,this.settings.labelDensity);Sr(n,this.nodesWithForcedLabels),this.displayedNodeLabels=new Set;for(var o=this.canvasContexts.labels,a=0,s=n.length;a<s;a++){var u=n[a],d=this.nodeDataCache[u];if(!this.displayedNodeLabels.has(u)&&!d.hidden){var h=this.framedGraphToViewport(d),l=h.x,f=h.y,p=this.scaleSize(d.size);if(!(!d.forceLabel&&p<this.settings.labelRenderedSizeThreshold)&&!(l<-150||l>this.width+ks||f<-50||f>this.height+Gs)){this.displayedNodeLabels.add(u);var y=this.settings.defaultDrawNodeLabel,w=this.nodePrograms[d.type],E=(w==null?void 0:w.drawLabel)||y;E(o,I(I({key:u},d),{},{size:p,x:l,y:f}),this.settings)}}}return this}},{key:"renderEdgeLabels",value:function(){if(!this.settings.renderEdgeLabels)return this;var i=this.canvasContexts.edgeLabels;i.clearRect(0,0,this.width,this.height);var n=Ls({graph:this.graph,hoveredNode:this.hoveredNode,displayedNodeLabels:this.displayedNodeLabels,highlightedNodes:this.highlightedNodes});Sr(n,this.edgesWithForcedLabels);for(var o=new Set,a=0,s=n.length;a<s;a++){var u=n[a],d=this.graph.extremities(u),h=this.nodeDataCache[d[0]],l=this.nodeDataCache[d[1]],f=this.edgeDataCache[u];if(!o.has(u)&&!(f.hidden||h.hidden||l.hidden)){var p=this.settings.defaultDrawEdgeLabel,y=this.edgePrograms[f.type],w=(y==null?void 0:y.drawLabel)||p;w(i,I(I({key:u},f),{},{size:this.scaleSize(f.size)}),I(I(I({key:d[0]},h),this.framedGraphToViewport(h)),{},{size:this.scaleSize(h.size)}),I(I(I({key:d[1]},l),this.framedGraphToViewport(l)),{},{size:this.scaleSize(l.size)}),this.settings),o.add(u)}}return this.displayedEdgeLabels=o,this}},{key:"renderHighlightedNodes",value:function(){var i=this,n=this.canvasContexts.hovers;n.clearRect(0,0,this.width,this.height);var o=function(p){var y=i.nodeDataCache[p],w=i.framedGraphToViewport(y),E=w.x,C=w.y,T=i.scaleSize(y.size),S=i.settings.defaultDrawNodeHover,c=i.nodePrograms[y.type],b=(c==null?void 0:c.drawHover)||S;b(n,I(I({key:p},y),{},{size:T,x:E,y:C}),i.settings)},a=[];this.hoveredNode&&!this.nodeDataCache[this.hoveredNode].hidden&&a.push(this.hoveredNode),this.highlightedNodes.forEach(function(f){f!==i.hoveredNode&&a.push(f)}),a.forEach(function(f){return o(f)});var s={};a.forEach(function(f){var p=i.nodeDataCache[f].type;s[p]=(s[p]||0)+1});for(var u in this.nodeHoverPrograms)this.nodeHoverPrograms[u].reallocate(s[u]||0),s[u]=0;a.forEach(function(f){var p=i.nodeDataCache[f];i.nodeHoverPrograms[p.type].process(0,s[p.type]++,p)}),this.webGLContexts.hoverNodes.clear(this.webGLContexts.hoverNodes.COLOR_BUFFER_BIT);var d=this.getRenderParams();for(var h in this.nodeHoverPrograms){var l=this.nodeHoverPrograms[h];l.render(d)}}},{key:"scheduleHighlightedNodesRender",value:function(){var i=this;this.renderHighlightedNodesFrame||this.renderFrame||(this.renderHighlightedNodesFrame=requestAnimationFrame(function(){i.renderHighlightedNodesFrame=null,i.renderHighlightedNodes(),i.renderEdgeLabels()}))}},{key:"render",value:function(){var i=this;this.emit("beforeRender");var n=function(){return i.emit("afterRender"),i};if(this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.resize(),this.needToProcess&&this.process(),this.needToProcess=!1,this.clear(),this.pickingLayers.forEach(function(E){return i.resetWebGLTexture(E)}),!this.graph.order)return n();var o=this.mouseCaptor,a=this.camera.isAnimated()||o.isMoving||o.draggedEvents||o.currentWheelDirection,s=this.camera.getState(),u=this.getDimensions(),d=this.getGraphDimensions(),h=this.getStagePadding();this.matrix=Ct(s,u,d,h),this.invMatrix=Ct(s,u,d,h,!0),this.correctionRatio=cs(this.matrix,s,u),this.graphToViewportRatio=this.getGraphToViewportRatio();var l=this.getRenderParams();for(var f in this.nodePrograms){var p=this.nodePrograms[f];p.render(l)}if(!this.settings.hideEdgesOnMove||!a)for(var y in this.edgePrograms){var w=this.edgePrograms[y];w.render(l)}return this.settings.hideLabelsOnMove&&a||(this.renderLabels(),this.renderEdgeLabels(),this.renderHighlightedNodes()),n()}},{key:"addNode",value:function(i){var n=Object.assign({},this.graph.getNodeAttributes(i));this.settings.nodeReducer&&(n=this.settings.nodeReducer(i,n));var o=Os(this.settings,i,n);this.nodeDataCache[i]=o,this.nodesWithForcedLabels.delete(i),o.forceLabel&&!o.hidden&&this.nodesWithForcedLabels.add(i),this.highlightedNodes.delete(i),o.highlighted&&!o.hidden&&this.highlightedNodes.add(i),this.settings.zIndex&&(o.zIndex<this.nodeZExtent[0]&&(this.nodeZExtent[0]=o.zIndex),o.zIndex>this.nodeZExtent[1]&&(this.nodeZExtent[1]=o.zIndex))}},{key:"updateNode",value:function(i){this.addNode(i);var n=this.nodeDataCache[i];this.normalizationFunction.applyTo(n)}},{key:"removeNode",value:function(i){delete this.nodeDataCache[i],delete this.nodeProgramIndex[i],this.highlightedNodes.delete(i),this.hoveredNode===i&&(this.hoveredNode=null),this.nodesWithForcedLabels.delete(i)}},{key:"addEdge",value:function(i){var n=Object.assign({},this.graph.getEdgeAttributes(i));this.settings.edgeReducer&&(n=this.settings.edgeReducer(i,n));var o=Ps(this.settings,i,n);this.edgeDataCache[i]=o,this.edgesWithForcedLabels.delete(i),o.forceLabel&&!o.hidden&&this.edgesWithForcedLabels.add(i),this.settings.zIndex&&(o.zIndex<this.edgeZExtent[0]&&(this.edgeZExtent[0]=o.zIndex),o.zIndex>this.edgeZExtent[1]&&(this.edgeZExtent[1]=o.zIndex))}},{key:"updateEdge",value:function(i){this.addEdge(i)}},{key:"removeEdge",value:function(i){delete this.edgeDataCache[i],delete this.edgeProgramIndex[i],this.hoveredEdge===i&&(this.hoveredEdge=null),this.edgesWithForcedLabels.delete(i)}},{key:"clearNodeIndices",value:function(){this.labelGrid=new Lr,this.nodeExtent={x:[0,1],y:[0,1]},this.nodeDataCache={},this.edgeProgramIndex={},this.nodesWithForcedLabels=new Set,this.nodeZExtent=[1/0,-1/0]}},{key:"clearEdgeIndices",value:function(){this.edgeDataCache={},this.edgeProgramIndex={},this.edgesWithForcedLabels=new Set,this.edgeZExtent=[1/0,-1/0]}},{key:"clearIndices",value:function(){this.clearEdgeIndices(),this.clearNodeIndices()}},{key:"clearNodeState",value:function(){this.displayedNodeLabels=new Set,this.highlightedNodes=new Set,this.hoveredNode=null}},{key:"clearEdgeState",value:function(){this.displayedEdgeLabels=new Set,this.highlightedNodes=new Set,this.hoveredEdge=null}},{key:"clearState",value:function(){this.clearEdgeState(),this.clearNodeState()}},{key:"addNodeToProgram",value:function(i,n,o){var a=this.nodeDataCache[i],s=this.nodePrograms[a.type];if(!s)throw new Error('Sigma: could not find a suitable program for node type "'.concat(a.type,'"!'));s.process(n,o,a),this.nodeProgramIndex[i]=o}},{key:"addEdgeToProgram",value:function(i,n,o){var a=this.edgeDataCache[i],s=this.edgePrograms[a.type];if(!s)throw new Error('Sigma: could not find a suitable program for edge type "'.concat(a.type,'"!'));var u=this.graph.extremities(i),d=this.nodeDataCache[u[0]],h=this.nodeDataCache[u[1]];s.process(n,o,d,h,a),this.edgeProgramIndex[i]=o}},{key:"getRenderParams",value:function(){return{matrix:this.matrix,invMatrix:this.invMatrix,width:this.width,height:this.height,pixelRatio:this.pixelRatio,zoomRatio:this.camera.ratio,cameraAngle:this.camera.angle,sizeRatio:1/this.scaleSize(),correctionRatio:this.correctionRatio,downSizingRatio:this.pickingDownSizingRatio,minEdgeThickness:this.settings.minEdgeThickness,antiAliasingFeather:this.settings.antiAliasingFeather}}},{key:"getStagePadding",value:function(){var i=this.settings,n=i.stagePadding,o=i.autoRescale;return o&&n||0}},{key:"createLayer",value:function(i,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.elements[i])throw new Error('Sigma: a layer named "'.concat(i,'" already exists'));var a=ps(n,{position:"absolute"},{class:"sigma-".concat(i)});return o.style&&Object.assign(a.style,o.style),this.elements[i]=a,"beforeLayer"in o&&o.beforeLayer?this.elements[o.beforeLayer].before(a):"afterLayer"in o&&o.afterLayer?this.elements[o.afterLayer].after(a):this.container.appendChild(a),a}},{key:"createCanvas",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.createLayer(i,"canvas",n)}},{key:"createCanvasContext",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this.createCanvas(i,n),a={preserveDrawingBuffer:!1,antialias:!1};return this.canvasContexts[i]=o.getContext("2d",a),this}},{key:"createWebGLContext",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=(n==null?void 0:n.canvas)||this.createCanvas(i,n);n.hidden&&o.remove();var a=I({preserveDrawingBuffer:!1,antialias:!1},n),s;s=o.getContext("webgl2",a),s||(s=o.getContext("webgl",a)),s||(s=o.getContext("experimental-webgl",a));var u=s;if(this.webGLContexts[i]=u,u.blendFunc(u.ONE,u.ONE_MINUS_SRC_ALPHA),n.picking){this.pickingLayers.add(i);var d=u.createFramebuffer();if(!d)throw new Error("Sigma: cannot create a new frame buffer for layer ".concat(i));this.frameBuffers[i]=d}return u}},{key:"killLayer",value:function(i){var n=this.elements[i];if(!n)throw new Error("Sigma: cannot kill layer ".concat(i,", which does not exist"));if(this.webGLContexts[i]){var o,a=this.webGLContexts[i];(o=a.getExtension("WEBGL_lose_context"))===null||o===void 0||o.loseContext(),delete this.webGLContexts[i]}else this.canvasContexts[i]&&delete this.canvasContexts[i];return n.remove(),delete this.elements[i],this}},{key:"getCamera",value:function(){return this.camera}},{key:"setCamera",value:function(i){this.unbindCameraHandlers(),this.camera=i,this.bindCameraHandlers()}},{key:"getContainer",value:function(){return this.container}},{key:"getGraph",value:function(){return this.graph}},{key:"setGraph",value:function(i){i!==this.graph&&(this.hoveredNode&&!i.hasNode(this.hoveredNode)&&(this.hoveredNode=null),this.hoveredEdge&&!i.hasEdge(this.hoveredEdge)&&(this.hoveredEdge=null),this.unbindGraphHandlers(),this.checkEdgesEventsFrame!==null&&(cancelAnimationFrame(this.checkEdgesEventsFrame),this.checkEdgesEventsFrame=null),this.graph=i,this.bindGraphHandlers(),this.refresh())}},{key:"getMouseCaptor",value:function(){return this.mouseCaptor}},{key:"getTouchCaptor",value:function(){return this.touchCaptor}},{key:"getDimensions",value:function(){return{width:this.width,height:this.height}}},{key:"getGraphDimensions",value:function(){var i=this.customBBox||this.nodeExtent;return{width:i.x[1]-i.x[0]||1,height:i.y[1]-i.y[0]||1}}},{key:"getNodeDisplayData",value:function(i){var n=this.nodeDataCache[i];return n?Object.assign({},n):void 0}},{key:"getEdgeDisplayData",value:function(i){var n=this.edgeDataCache[i];return n?Object.assign({},n):void 0}},{key:"getNodeDisplayedLabels",value:function(){return new Set(this.displayedNodeLabels)}},{key:"getEdgeDisplayedLabels",value:function(){return new Set(this.displayedEdgeLabels)}},{key:"getSettings",value:function(){return I({},this.settings)}},{key:"getSetting",value:function(i){return this.settings[i]}},{key:"setSetting",value:function(i,n){var o=I({},this.settings);return this.settings[i]=n,Ei(this.settings),this.handleSettingsUpdate(o),this.scheduleRefresh(),this}},{key:"updateSetting",value:function(i,n){return this.setSetting(i,n(this.settings[i])),this}},{key:"setSettings",value:function(i){var n=I({},this.settings);return this.settings=I(I({},this.settings),i),Ei(this.settings),this.handleSettingsUpdate(n),this.scheduleRefresh(),this}},{key:"resize",value:function(i){var n=this.width,o=this.height;if(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.pixelRatio=Tr(),this.width===0)if(this.settings.allowInvalidContainer)this.width=1;else throw new Error("Sigma: Container has no width. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(this.height===0)if(this.settings.allowInvalidContainer)this.height=1;else throw new Error("Sigma: Container has no height. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(!i&&n===this.width&&o===this.height)return this;for(var a in this.elements){var s=this.elements[a];s.style.width=this.width+"px",s.style.height=this.height+"px"}for(var u in this.canvasContexts)this.elements[u].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[u].setAttribute("height",this.height*this.pixelRatio+"px"),this.pixelRatio!==1&&this.canvasContexts[u].scale(this.pixelRatio,this.pixelRatio);for(var d in this.webGLContexts){this.elements[d].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[d].setAttribute("height",this.height*this.pixelRatio+"px");var h=this.webGLContexts[d];if(h.viewport(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio),this.pickingLayers.has(d)){var l=this.textures[d];l&&h.deleteTexture(l)}}return this.emit("resize"),this}},{key:"clear",value:function(){return this.emit("beforeClear"),this.webGLContexts.nodes.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.nodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.edges.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.edges.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.hoverNodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.canvasContexts.labels.clearRect(0,0,this.width,this.height),this.canvasContexts.hovers.clearRect(0,0,this.width,this.height),this.canvasContexts.edgeLabels.clearRect(0,0,this.width,this.height),this.emit("afterClear"),this}},{key:"refresh",value:function(i){var n=this,o=(i==null?void 0:i.skipIndexation)!==void 0?i==null?void 0:i.skipIndexation:!1,a=(i==null?void 0:i.schedule)!==void 0?i.schedule:!1,s=!i||!i.partialGraph;if(s)this.clearEdgeIndices(),this.clearNodeIndices(),this.graph.forEachNode(function(c){return n.addNode(c)}),this.graph.forEachEdge(function(c){return n.addEdge(c)});else{for(var u,d,h=((u=i.partialGraph)===null||u===void 0?void 0:u.nodes)||[],l=0,f=(h==null?void 0:h.length)||0;l<f;l++){var p=h[l];if(this.updateNode(p),o){var y=this.nodeProgramIndex[p];if(y===void 0)throw new Error('Sigma: node "'.concat(p,`" can't be repaint`));this.addNodeToProgram(p,this.nodeIndices[p],y)}}for(var w=(i==null||(d=i.partialGraph)===null||d===void 0?void 0:d.edges)||[],E=0,C=w.length;E<C;E++){var T=w[E];if(this.updateEdge(T),o){var S=this.edgeProgramIndex[T];if(S===void 0)throw new Error('Sigma: edge "'.concat(T,`" can't be repaint`));this.addEdgeToProgram(T,this.edgeIndices[T],S)}}}return(s||!o)&&(this.needToProcess=!0),a?this.scheduleRender():this.render(),this}},{key:"scheduleRender",value:function(){var i=this;return this.renderFrame||(this.renderFrame=requestAnimationFrame(function(){i.render()})),this}},{key:"scheduleRefresh",value:function(i){return this.refresh(I(I({},i),{},{schedule:!0}))}},{key:"getViewportZoomedState",value:function(i,n){var o=this.camera.getState(),a=o.ratio,s=o.angle,u=o.x,d=o.y,h=this.settings,l=h.minCameraRatio,f=h.maxCameraRatio;typeof f=="number"&&(n=Math.min(n,f)),typeof l=="number"&&(n=Math.max(n,l));var p=n/a,y={x:this.width/2,y:this.height/2},w=this.viewportToFramedGraph(i),E=this.viewportToFramedGraph(y);return{angle:s,x:(w.x-E.x)*(1-p)+u,y:(w.y-E.y)*(1-p)+d,ratio:n}}},{key:"viewRectangle",value:function(){var i=this.viewportToFramedGraph({x:0,y:0}),n=this.viewportToFramedGraph({x:this.width,y:0}),o=this.viewportToFramedGraph({x:0,y:this.height});return{x1:i.x,y1:i.y,x2:n.x,y2:n.y,height:n.y-o.y}}},{key:"framedGraphToViewport",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=!!n.cameraState||!!n.viewportDimensions||!!n.graphDimensions,a=n.matrix?n.matrix:o?Ct(n.cameraState||this.camera.getState(),n.viewportDimensions||this.getDimensions(),n.graphDimensions||this.getGraphDimensions(),n.padding||this.getStagePadding()):this.matrix,s=ki(a,i);return{x:(1+s.x)*this.width/2,y:(1-s.y)*this.height/2}}},{key:"viewportToFramedGraph",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=!!n.cameraState||!!n.viewportDimensions||!n.graphDimensions,a=n.matrix?n.matrix:o?Ct(n.cameraState||this.camera.getState(),n.viewportDimensions||this.getDimensions(),n.graphDimensions||this.getGraphDimensions(),n.padding||this.getStagePadding(),!0):this.invMatrix,s=ki(a,{x:i.x/this.width*2-1,y:1-i.y/this.height*2});return isNaN(s.x)&&(s.x=0),isNaN(s.y)&&(s.y=0),s}},{key:"viewportToGraph",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.normalizationFunction.inverse(this.viewportToFramedGraph(i,n))}},{key:"graphToViewport",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.framedGraphToViewport(this.normalizationFunction(i),n)}},{key:"getGraphToViewportRatio",value:function(){var i={x:0,y:0},n={x:1,y:1},o=Math.sqrt(Math.pow(i.x-n.x,2)+Math.pow(i.y-n.y,2)),a=this.graphToViewport(i),s=this.graphToViewport(n),u=Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2));return u/o}},{key:"getBBox",value:function(){return this.nodeExtent}},{key:"getCustomBBox",value:function(){return this.customBBox}},{key:"setCustomBBox",value:function(i){return this.customBBox=i,this.scheduleRender(),this}},{key:"kill",value:function(){this.emit("kill"),this.removeAllListeners(),this.unbindCameraHandlers(),window.removeEventListener("resize",this.activeListeners.handleResize),this.mouseCaptor.kill(),this.touchCaptor.kill(),this.unbindGraphHandlers(),this.clearIndices(),this.clearState(),this.nodeDataCache={},this.edgeDataCache={},this.highlightedNodes.clear(),this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.renderHighlightedNodesFrame&&(cancelAnimationFrame(this.renderHighlightedNodesFrame),this.renderHighlightedNodesFrame=null);for(var i=this.container;i.firstChild;)i.removeChild(i.firstChild);this.canvasContexts={},this.webGLContexts={},this.elements={};for(var n in this.nodePrograms)this.nodePrograms[n].kill();for(var o in this.nodeHoverPrograms)this.nodeHoverPrograms[o].kill();for(var a in this.edgePrograms)this.edgePrograms[a].kill();this.nodePrograms={},this.nodeHoverPrograms={},this.edgePrograms={};for(var s in this.elements)this.killLayer(s)}},{key:"scaleSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.camera.ratio;return i/this.settings.zoomToSizeRatioFunction(n)*(this.getSetting("itemSizesReference")==="positions"?n*this.graphToViewportRatio:1)}},{key:"getCanvases",value:function(){var i={};for(var n in this.elements)this.elements[n]instanceof HTMLCanvasElement&&(i[n]=this.elements[n]);return i}}])}(Wi),Ns=Fs,Is=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;
attribute float a_sourceRadius;
attribute float a_targetRadius;
attribute float a_sourceRadiusCoef;
attribute float a_targetRadiusCoef;

uniform mat3 u_matrix;
uniform float u_zoomRatio;
uniform float u_sizeRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // These first computations are taken from edge.vert.glsl. Please read it to
  // get better comments on what's happening:
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here, we move the point to leave space for the arrow heads:
  // Source arrow head
  float sourceRadius = a_sourceRadius * a_sourceRadiusCoef;
  float sourceDirection = sign(sourceRadius);
  float webGLSourceRadius = sourceDirection * sourceRadius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLSourceArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  vec2 sourceCompensationVector =
    vec2(-sourceDirection * unitNormal.y, sourceDirection * unitNormal.x)
    * (webGLSourceRadius + webGLSourceArrowHeadLength);
    
  // Target arrow head
  float targetRadius = a_targetRadius * a_targetRadiusCoef;
  float targetDirection = sign(targetRadius);
  float webGLTargetRadius = targetDirection * targetRadius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLTargetArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  vec2 targetCompensationVector =
  vec2(-targetDirection * unitNormal.y, targetDirection * unitNormal.x)
    * (webGLTargetRadius + webGLTargetArrowHeadLength);

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness + sourceCompensationVector + targetCompensationVector, 1)).xy, 0, 1);

  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,$s=Is,Ln=WebGLRenderingContext,kr=Ln.UNSIGNED_BYTE,qe=Ln.FLOAT,zs=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness","u_lengthToThicknessRatio"],Us={lengthToThicknessRatio:Bi.lengthToThicknessRatio};function kn(r){var t=I(I({},Us),{});return function(e){function i(){return se(this,i),me(this,i,arguments)}return ye(i,e),ue(i,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:$s,FRAGMENT_SHADER_SOURCE:Hi,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:zs,ATTRIBUTES:[{name:"a_positionStart",size:2,type:qe},{name:"a_positionEnd",size:2,type:qe},{name:"a_normal",size:2,type:qe},{name:"a_color",size:4,type:kr,normalized:!0},{name:"a_id",size:4,type:kr,normalized:!0},{name:"a_sourceRadius",size:1,type:qe},{name:"a_targetRadius",size:1,type:qe}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:qe},{name:"a_normalCoef",size:1,type:qe},{name:"a_sourceRadiusCoef",size:1,type:qe},{name:"a_targetRadiusCoef",size:1,type:qe}],CONSTANT_DATA:[[0,1,-1,0],[0,-1,1,0],[1,1,0,1],[1,1,0,1],[0,-1,1,0],[1,-1,0,-1]]}}},{key:"processVisibleItem",value:function(o,a,s,u,d){var h=d.size||1,l=s.x,f=s.y,p=u.x,y=u.y,w=_t(d.color),E=p-l,C=y-f,T=s.size||1,S=u.size||1,c=E*E+C*C,b=0,m=0;c&&(c=1/Math.sqrt(c),b=-C*c*h,m=E*c*h);var _=this.array;_[a++]=l,_[a++]=f,_[a++]=p,_[a++]=y,_[a++]=b,_[a++]=m,_[a++]=w,_[a++]=o,_[a++]=T,_[a++]=S}},{key:"setUniforms",value:function(o,a){var s=a.gl,u=a.uniformLocations,d=u.u_matrix,h=u.u_zoomRatio,l=u.u_feather,f=u.u_pixelRatio,p=u.u_correctionRatio,y=u.u_sizeRatio,w=u.u_minEdgeThickness,E=u.u_lengthToThicknessRatio;s.uniformMatrix3fv(d,!1,o.matrix),s.uniform1f(h,o.zoomRatio),s.uniform1f(y,o.sizeRatio),s.uniform1f(p,o.correctionRatio),s.uniform1f(f,o.pixelRatio),s.uniform1f(l,o.antiAliasingFeather),s.uniform1f(w,o.minEdgeThickness),s.uniform1f(E,t.lengthToThicknessRatio)}}])}(ni)}kn();function Ms(r){return En([kn(),Qt(r),Qt(I(I({},r),{},{extremity:"source"}))])}Ms();var fe="top",Se="bottom",Ce="right",pe="left",Vi="auto",$t=[fe,Se,Ce,pe],gt="start",Ft="end",Bs="clippingParents",Gn="viewport",Lt="popper",Hs="reference",Gr=$t.reduce(function(r,t){return r.concat([t+"-"+gt,t+"-"+Ft])},[]),On=[].concat($t,[Vi]).reduce(function(r,t){return r.concat([t,t+"-"+gt,t+"-"+Ft])},[]),Ws="beforeRead",js="read",Vs="afterRead",qs="beforeMain",Ks="main",Ys="afterMain",Xs="beforeWrite",Zs="write",Js="afterWrite",Qs=[Ws,js,Vs,qs,Ks,Ys,Xs,Zs,Js];function Me(r){return r?(r.nodeName||"").toLowerCase():null}function ve(r){if(r==null)return window;if(r.toString()!=="[object Window]"){var t=r.ownerDocument;return t&&t.defaultView||window}return r}function ot(r){var t=ve(r).Element;return r instanceof t||r instanceof Element}function Re(r){var t=ve(r).HTMLElement;return r instanceof t||r instanceof HTMLElement}function qi(r){if(typeof ShadowRoot>"u")return!1;var t=ve(r).ShadowRoot;return r instanceof t||r instanceof ShadowRoot}function eu(r){var t=r.state;Object.keys(t.elements).forEach(function(e){var i=t.styles[e]||{},n=t.attributes[e]||{},o=t.elements[e];!Re(o)||!Me(o)||(Object.assign(o.style,i),Object.keys(n).forEach(function(a){var s=n[a];s===!1?o.removeAttribute(a):o.setAttribute(a,s===!0?"":s)}))})}function tu(r){var t=r.state,e={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,e.popper),t.styles=e,t.elements.arrow&&Object.assign(t.elements.arrow.style,e.arrow),function(){Object.keys(t.elements).forEach(function(i){var n=t.elements[i],o=t.attributes[i]||{},a=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:e[i]),s=a.reduce(function(u,d){return u[d]="",u},{});!Re(n)||!Me(n)||(Object.assign(n.style,s),Object.keys(o).forEach(function(u){n.removeAttribute(u)}))})}}const Pn={name:"applyStyles",enabled:!0,phase:"write",fn:eu,effect:tu,requires:["computeStyles"]};function Ue(r){return r.split("-")[0]}var nt=Math.max,ei=Math.min,vt=Math.round;function Oi(){var r=navigator.userAgentData;return r!=null&&r.brands&&Array.isArray(r.brands)?r.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function Fn(){return!/^((?!chrome|android).)*safari/i.test(Oi())}function mt(r,t,e){t===void 0&&(t=!1),e===void 0&&(e=!1);var i=r.getBoundingClientRect(),n=1,o=1;t&&Re(r)&&(n=r.offsetWidth>0&&vt(i.width)/r.offsetWidth||1,o=r.offsetHeight>0&&vt(i.height)/r.offsetHeight||1);var a=ot(r)?ve(r):window,s=a.visualViewport,u=!Fn()&&e,d=(i.left+(u&&s?s.offsetLeft:0))/n,h=(i.top+(u&&s?s.offsetTop:0))/o,l=i.width/n,f=i.height/o;return{width:l,height:f,top:h,right:d+l,bottom:h+f,left:d,x:d,y:h}}function Ki(r){var t=mt(r),e=r.offsetWidth,i=r.offsetHeight;return Math.abs(t.width-e)<=1&&(e=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:r.offsetLeft,y:r.offsetTop,width:e,height:i}}function Nn(r,t){var e=t.getRootNode&&t.getRootNode();if(r.contains(t))return!0;if(e&&qi(e)){var i=t;do{if(i&&r.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function Ze(r){return ve(r).getComputedStyle(r)}function iu(r){return["table","td","th"].indexOf(Me(r))>=0}function et(r){return((ot(r)?r.ownerDocument:r.document)||window.document).documentElement}function oi(r){return Me(r)==="html"?r:r.assignedSlot||r.parentNode||(qi(r)?r.host:null)||et(r)}function Or(r){return!Re(r)||Ze(r).position==="fixed"?null:r.offsetParent}function ru(r){var t=/firefox/i.test(Oi()),e=/Trident/i.test(Oi());if(e&&Re(r)){var i=Ze(r);if(i.position==="fixed")return null}var n=oi(r);for(qi(n)&&(n=n.host);Re(n)&&["html","body"].indexOf(Me(n))<0;){var o=Ze(n);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||t&&o.willChange==="filter"||t&&o.filter&&o.filter!=="none")return n;n=n.parentNode}return null}function zt(r){for(var t=ve(r),e=Or(r);e&&iu(e)&&Ze(e).position==="static";)e=Or(e);return e&&(Me(e)==="html"||Me(e)==="body"&&Ze(e).position==="static")?t:e||ru(r)||t}function Yi(r){return["top","bottom"].indexOf(r)>=0?"x":"y"}function Gt(r,t,e){return nt(r,ei(t,e))}function nu(r,t,e){var i=Gt(r,t,e);return i>e?e:i}function In(){return{top:0,right:0,bottom:0,left:0}}function $n(r){return Object.assign({},In(),r)}function zn(r,t){return t.reduce(function(e,i){return e[i]=r,e},{})}var ou=function(t,e){return t=typeof t=="function"?t(Object.assign({},e.rects,{placement:e.placement})):t,$n(typeof t!="number"?t:zn(t,$t))};function au(r){var t,e=r.state,i=r.name,n=r.options,o=e.elements.arrow,a=e.modifiersData.popperOffsets,s=Ue(e.placement),u=Yi(s),d=[pe,Ce].indexOf(s)>=0,h=d?"height":"width";if(!(!o||!a)){var l=ou(n.padding,e),f=Ki(o),p=u==="y"?fe:pe,y=u==="y"?Se:Ce,w=e.rects.reference[h]+e.rects.reference[u]-a[u]-e.rects.popper[h],E=a[u]-e.rects.reference[u],C=zt(o),T=C?u==="y"?C.clientHeight||0:C.clientWidth||0:0,S=w/2-E/2,c=l[p],b=T-f[h]-l[y],m=T/2-f[h]/2+S,_=Gt(c,m,b),G=u;e.modifiersData[i]=(t={},t[G]=_,t.centerOffset=_-m,t)}}function su(r){var t=r.state,e=r.options,i=e.element,n=i===void 0?"[data-popper-arrow]":i;n!=null&&(typeof n=="string"&&(n=t.elements.popper.querySelector(n),!n)||Nn(t.elements.popper,n)&&(t.elements.arrow=n))}const uu={name:"arrow",enabled:!0,phase:"main",fn:au,effect:su,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function yt(r){return r.split("-")[1]}var du={top:"auto",right:"auto",bottom:"auto",left:"auto"};function hu(r,t){var e=r.x,i=r.y,n=t.devicePixelRatio||1;return{x:vt(e*n)/n||0,y:vt(i*n)/n||0}}function Pr(r){var t,e=r.popper,i=r.popperRect,n=r.placement,o=r.variation,a=r.offsets,s=r.position,u=r.gpuAcceleration,d=r.adaptive,h=r.roundOffsets,l=r.isFixed,f=a.x,p=f===void 0?0:f,y=a.y,w=y===void 0?0:y,E=typeof h=="function"?h({x:p,y:w}):{x:p,y:w};p=E.x,w=E.y;var C=a.hasOwnProperty("x"),T=a.hasOwnProperty("y"),S=pe,c=fe,b=window;if(d){var m=zt(e),_="clientHeight",G="clientWidth";if(m===ve(e)&&(m=et(e),Ze(m).position!=="static"&&s==="absolute"&&(_="scrollHeight",G="scrollWidth")),m=m,n===fe||(n===pe||n===Ce)&&o===Ft){c=Se;var k=l&&m===b&&b.visualViewport?b.visualViewport.height:m[_];w-=k-i.height,w*=u?1:-1}if(n===pe||(n===fe||n===Se)&&o===Ft){S=Ce;var O=l&&m===b&&b.visualViewport?b.visualViewport.width:m[G];p-=O-i.width,p*=u?1:-1}}var H=Object.assign({position:s},d&&du),F=h===!0?hu({x:p,y:w},ve(e)):{x:p,y:w};if(p=F.x,w=F.y,u){var g;return Object.assign({},H,(g={},g[c]=T?"0":"",g[S]=C?"0":"",g.transform=(b.devicePixelRatio||1)<=1?"translate("+p+"px, "+w+"px)":"translate3d("+p+"px, "+w+"px, 0)",g))}return Object.assign({},H,(t={},t[c]=T?w+"px":"",t[S]=C?p+"px":"",t.transform="",t))}function cu(r){var t=r.state,e=r.options,i=e.gpuAcceleration,n=i===void 0?!0:i,o=e.adaptive,a=o===void 0?!0:o,s=e.roundOffsets,u=s===void 0?!0:s,d={placement:Ue(t.placement),variation:yt(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:n,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Pr(Object.assign({},d,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:u})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Pr(Object.assign({},d,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const lu={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:cu,data:{}};var Yt={passive:!0};function fu(r){var t=r.state,e=r.instance,i=r.options,n=i.scroll,o=n===void 0?!0:n,a=i.resize,s=a===void 0?!0:a,u=ve(t.elements.popper),d=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&d.forEach(function(h){h.addEventListener("scroll",e.update,Yt)}),s&&u.addEventListener("resize",e.update,Yt),function(){o&&d.forEach(function(h){h.removeEventListener("scroll",e.update,Yt)}),s&&u.removeEventListener("resize",e.update,Yt)}}const pu={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:fu,data:{}};var gu={left:"right",right:"left",bottom:"top",top:"bottom"};function Jt(r){return r.replace(/left|right|bottom|top/g,function(t){return gu[t]})}var vu={start:"end",end:"start"};function Fr(r){return r.replace(/start|end/g,function(t){return vu[t]})}function Xi(r){var t=ve(r),e=t.pageXOffset,i=t.pageYOffset;return{scrollLeft:e,scrollTop:i}}function Zi(r){return mt(et(r)).left+Xi(r).scrollLeft}function mu(r,t){var e=ve(r),i=et(r),n=e.visualViewport,o=i.clientWidth,a=i.clientHeight,s=0,u=0;if(n){o=n.width,a=n.height;var d=Fn();(d||!d&&t==="fixed")&&(s=n.offsetLeft,u=n.offsetTop)}return{width:o,height:a,x:s+Zi(r),y:u}}function yu(r){var t,e=et(r),i=Xi(r),n=(t=r.ownerDocument)==null?void 0:t.body,o=nt(e.scrollWidth,e.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),a=nt(e.scrollHeight,e.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),s=-i.scrollLeft+Zi(r),u=-i.scrollTop;return Ze(n||e).direction==="rtl"&&(s+=nt(e.clientWidth,n?n.clientWidth:0)-o),{width:o,height:a,x:s,y:u}}function Ji(r){var t=Ze(r),e=t.overflow,i=t.overflowX,n=t.overflowY;return/auto|scroll|overlay|hidden/.test(e+n+i)}function Un(r){return["html","body","#document"].indexOf(Me(r))>=0?r.ownerDocument.body:Re(r)&&Ji(r)?r:Un(oi(r))}function Ot(r,t){var e;t===void 0&&(t=[]);var i=Un(r),n=i===((e=r.ownerDocument)==null?void 0:e.body),o=ve(i),a=n?[o].concat(o.visualViewport||[],Ji(i)?i:[]):i,s=t.concat(a);return n?s:s.concat(Ot(oi(a)))}function Pi(r){return Object.assign({},r,{left:r.x,top:r.y,right:r.x+r.width,bottom:r.y+r.height})}function bu(r,t){var e=mt(r,!1,t==="fixed");return e.top=e.top+r.clientTop,e.left=e.left+r.clientLeft,e.bottom=e.top+r.clientHeight,e.right=e.left+r.clientWidth,e.width=r.clientWidth,e.height=r.clientHeight,e.x=e.left,e.y=e.top,e}function Nr(r,t,e){return t===Gn?Pi(mu(r,e)):ot(t)?bu(t,e):Pi(yu(et(r)))}function wu(r){var t=Ot(oi(r)),e=["absolute","fixed"].indexOf(Ze(r).position)>=0,i=e&&Re(r)?zt(r):r;return ot(i)?t.filter(function(n){return ot(n)&&Nn(n,i)&&Me(n)!=="body"}):[]}function Eu(r,t,e,i){var n=t==="clippingParents"?wu(r):[].concat(t),o=[].concat(n,[e]),a=o[0],s=o.reduce(function(u,d){var h=Nr(r,d,i);return u.top=nt(h.top,u.top),u.right=ei(h.right,u.right),u.bottom=ei(h.bottom,u.bottom),u.left=nt(h.left,u.left),u},Nr(r,a,i));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function Mn(r){var t=r.reference,e=r.element,i=r.placement,n=i?Ue(i):null,o=i?yt(i):null,a=t.x+t.width/2-e.width/2,s=t.y+t.height/2-e.height/2,u;switch(n){case fe:u={x:a,y:t.y-e.height};break;case Se:u={x:a,y:t.y+t.height};break;case Ce:u={x:t.x+t.width,y:s};break;case pe:u={x:t.x-e.width,y:s};break;default:u={x:t.x,y:t.y}}var d=n?Yi(n):null;if(d!=null){var h=d==="y"?"height":"width";switch(o){case gt:u[d]=u[d]-(t[h]/2-e[h]/2);break;case Ft:u[d]=u[d]+(t[h]/2-e[h]/2);break}}return u}function Nt(r,t){t===void 0&&(t={});var e=t,i=e.placement,n=i===void 0?r.placement:i,o=e.strategy,a=o===void 0?r.strategy:o,s=e.boundary,u=s===void 0?Bs:s,d=e.rootBoundary,h=d===void 0?Gn:d,l=e.elementContext,f=l===void 0?Lt:l,p=e.altBoundary,y=p===void 0?!1:p,w=e.padding,E=w===void 0?0:w,C=$n(typeof E!="number"?E:zn(E,$t)),T=f===Lt?Hs:Lt,S=r.rects.popper,c=r.elements[y?T:f],b=Eu(ot(c)?c:c.contextElement||et(r.elements.popper),u,h,a),m=mt(r.elements.reference),_=Mn({reference:m,element:S,placement:n}),G=Pi(Object.assign({},S,_)),k=f===Lt?G:m,O={top:b.top-k.top+C.top,bottom:k.bottom-b.bottom+C.bottom,left:b.left-k.left+C.left,right:k.right-b.right+C.right},H=r.modifiersData.offset;if(f===Lt&&H){var F=H[n];Object.keys(O).forEach(function(g){var q=[Ce,Se].indexOf(g)>=0?1:-1,J=[fe,Se].indexOf(g)>=0?"y":"x";O[g]+=F[J]*q})}return O}function _u(r,t){t===void 0&&(t={});var e=t,i=e.placement,n=e.boundary,o=e.rootBoundary,a=e.padding,s=e.flipVariations,u=e.allowedAutoPlacements,d=u===void 0?On:u,h=yt(i),l=h?s?Gr:Gr.filter(function(y){return yt(y)===h}):$t,f=l.filter(function(y){return d.indexOf(y)>=0});f.length===0&&(f=l);var p=f.reduce(function(y,w){return y[w]=Nt(r,{placement:w,boundary:n,rootBoundary:o,padding:a})[Ue(w)],y},{});return Object.keys(p).sort(function(y,w){return p[y]-p[w]})}function Tu(r){if(Ue(r)===Vi)return[];var t=Jt(r);return[Fr(r),t,Fr(t)]}function Au(r){var t=r.state,e=r.options,i=r.name;if(!t.modifiersData[i]._skip){for(var n=e.mainAxis,o=n===void 0?!0:n,a=e.altAxis,s=a===void 0?!0:a,u=e.fallbackPlacements,d=e.padding,h=e.boundary,l=e.rootBoundary,f=e.altBoundary,p=e.flipVariations,y=p===void 0?!0:p,w=e.allowedAutoPlacements,E=t.options.placement,C=Ue(E),T=C===E,S=u||(T||!y?[Jt(E)]:Tu(E)),c=[E].concat(S).reduce(function(he,ie){return he.concat(Ue(ie)===Vi?_u(t,{placement:ie,boundary:h,rootBoundary:l,padding:d,flipVariations:y,allowedAutoPlacements:w}):ie)},[]),b=t.rects.reference,m=t.rects.popper,_=new Map,G=!0,k=c[0],O=0;O<c.length;O++){var H=c[O],F=Ue(H),g=yt(H)===gt,q=[fe,Se].indexOf(F)>=0,J=q?"width":"height",D=Nt(t,{placement:H,boundary:h,rootBoundary:l,altBoundary:f,padding:d}),v=q?g?Ce:pe:g?Se:fe;b[J]>m[J]&&(v=Jt(v));var M=Jt(v),j=[];if(o&&j.push(D[F]<=0),s&&j.push(D[v]<=0,D[M]<=0),j.every(function(he){return he})){k=H,G=!1;break}_.set(H,j)}if(G)for(var ee=y?3:1,re=function(ie){var De=c.find(function(be){var xe=_.get(be);if(xe)return xe.slice(0,ie).every(function(Le){return Le})});if(De)return k=De,"break"},Z=ee;Z>0;Z--){var N=re(Z);if(N==="break")break}t.placement!==k&&(t.modifiersData[i]._skip=!0,t.placement=k,t.reset=!0)}}const Ru={name:"flip",enabled:!0,phase:"main",fn:Au,requiresIfExists:["offset"],data:{_skip:!1}};function Ir(r,t,e){return e===void 0&&(e={x:0,y:0}),{top:r.top-t.height-e.y,right:r.right-t.width+e.x,bottom:r.bottom-t.height+e.y,left:r.left-t.width-e.x}}function $r(r){return[fe,Ce,Se,pe].some(function(t){return r[t]>=0})}function Su(r){var t=r.state,e=r.name,i=t.rects.reference,n=t.rects.popper,o=t.modifiersData.preventOverflow,a=Nt(t,{elementContext:"reference"}),s=Nt(t,{altBoundary:!0}),u=Ir(a,i),d=Ir(s,n,o),h=$r(u),l=$r(d);t.modifiersData[e]={referenceClippingOffsets:u,popperEscapeOffsets:d,isReferenceHidden:h,hasPopperEscaped:l},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":l})}const Cu={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Su};function Du(r,t,e){var i=Ue(r),n=[pe,fe].indexOf(i)>=0?-1:1,o=typeof e=="function"?e(Object.assign({},t,{placement:r})):e,a=o[0],s=o[1];return a=a||0,s=(s||0)*n,[pe,Ce].indexOf(i)>=0?{x:s,y:a}:{x:a,y:s}}function xu(r){var t=r.state,e=r.options,i=r.name,n=e.offset,o=n===void 0?[0,0]:n,a=On.reduce(function(h,l){return h[l]=Du(l,t.rects,o),h},{}),s=a[t.placement],u=s.x,d=s.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=u,t.modifiersData.popperOffsets.y+=d),t.modifiersData[i]=a}const Lu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:xu};function ku(r){var t=r.state,e=r.name;t.modifiersData[e]=Mn({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const Gu={name:"popperOffsets",enabled:!0,phase:"read",fn:ku,data:{}};function Ou(r){return r==="x"?"y":"x"}function Pu(r){var t=r.state,e=r.options,i=r.name,n=e.mainAxis,o=n===void 0?!0:n,a=e.altAxis,s=a===void 0?!1:a,u=e.boundary,d=e.rootBoundary,h=e.altBoundary,l=e.padding,f=e.tether,p=f===void 0?!0:f,y=e.tetherOffset,w=y===void 0?0:y,E=Nt(t,{boundary:u,rootBoundary:d,padding:l,altBoundary:h}),C=Ue(t.placement),T=yt(t.placement),S=!T,c=Yi(C),b=Ou(c),m=t.modifiersData.popperOffsets,_=t.rects.reference,G=t.rects.popper,k=typeof w=="function"?w(Object.assign({},t.rects,{placement:t.placement})):w,O=typeof k=="number"?{mainAxis:k,altAxis:k}:Object.assign({mainAxis:0,altAxis:0},k),H=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,F={x:0,y:0};if(m){if(o){var g,q=c==="y"?fe:pe,J=c==="y"?Se:Ce,D=c==="y"?"height":"width",v=m[c],M=v+E[q],j=v-E[J],ee=p?-G[D]/2:0,re=T===gt?_[D]:G[D],Z=T===gt?-G[D]:-_[D],N=t.elements.arrow,he=p&&N?Ki(N):{width:0,height:0},ie=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:In(),De=ie[q],be=ie[J],xe=Gt(0,_[D],he[D]),Le=S?_[D]/2-ee-xe-De-O.mainAxis:re-xe-De-O.mainAxis,X=S?-_[D]/2+ee+xe+be+O.mainAxis:Z+xe+be+O.mainAxis,V=t.elements.arrow&&zt(t.elements.arrow),K=V?c==="y"?V.clientTop||0:V.clientLeft||0:0,ce=(g=H==null?void 0:H[c])!=null?g:0,U=v+Le-ce-K,z=v+X-ce,A=Gt(p?ei(M,U):M,v,p?nt(j,z):j);m[c]=A,F[c]=A-v}if(s){var ge,ke=c==="x"?fe:pe,we=c==="x"?Se:Ce,de=m[b],ne=b==="y"?"height":"width",Ee=de+E[ke],Ge=de-E[we],Ie=[fe,pe].indexOf(C)!==-1,Be=(ge=H==null?void 0:H[b])!=null?ge:0,He=Ie?Ee:de-_[ne]-G[ne]-Be+O.altAxis,$e=Ie?de+_[ne]+G[ne]-Be-O.altAxis:Ge,We=p&&Ie?nu(He,de,$e):Gt(p?He:Ee,de,p?$e:Ge);m[b]=We,F[b]=We-de}t.modifiersData[i]=F}}const Fu={name:"preventOverflow",enabled:!0,phase:"main",fn:Pu,requiresIfExists:["offset"]};function Nu(r){return{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}}function Iu(r){return r===ve(r)||!Re(r)?Xi(r):Nu(r)}function $u(r){var t=r.getBoundingClientRect(),e=vt(t.width)/r.offsetWidth||1,i=vt(t.height)/r.offsetHeight||1;return e!==1||i!==1}function zu(r,t,e){e===void 0&&(e=!1);var i=Re(t),n=Re(t)&&$u(t),o=et(t),a=mt(r,n,e),s={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(i||!i&&!e)&&((Me(t)!=="body"||Ji(o))&&(s=Iu(t)),Re(t)?(u=mt(t,!0),u.x+=t.clientLeft,u.y+=t.clientTop):o&&(u.x=Zi(o))),{x:a.left+s.scrollLeft-u.x,y:a.top+s.scrollTop-u.y,width:a.width,height:a.height}}function Uu(r){var t=new Map,e=new Set,i=[];r.forEach(function(o){t.set(o.name,o)});function n(o){e.add(o.name);var a=[].concat(o.requires||[],o.requiresIfExists||[]);a.forEach(function(s){if(!e.has(s)){var u=t.get(s);u&&n(u)}}),i.push(o)}return r.forEach(function(o){e.has(o.name)||n(o)}),i}function Mu(r){var t=Uu(r);return Qs.reduce(function(e,i){return e.concat(t.filter(function(n){return n.phase===i}))},[])}function Bu(r){var t;return function(){return t||(t=new Promise(function(e){Promise.resolve().then(function(){t=void 0,e(r())})})),t}}function Hu(r){var t=r.reduce(function(e,i){var n=e[i.name];return e[i.name]=n?Object.assign({},n,i,{options:Object.assign({},n.options,i.options),data:Object.assign({},n.data,i.data)}):i,e},{});return Object.keys(t).map(function(e){return t[e]})}var zr={placement:"bottom",modifiers:[],strategy:"absolute"};function Ur(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];return!t.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function Wu(r){r===void 0&&(r={});var t=r,e=t.defaultModifiers,i=e===void 0?[]:e,n=t.defaultOptions,o=n===void 0?zr:n;return function(s,u,d){d===void 0&&(d=o);var h={placement:"bottom",orderedModifiers:[],options:Object.assign({},zr,o),modifiersData:{},elements:{reference:s,popper:u},attributes:{},styles:{}},l=[],f=!1,p={state:h,setOptions:function(C){var T=typeof C=="function"?C(h.options):C;w(),h.options=Object.assign({},o,h.options,T),h.scrollParents={reference:ot(s)?Ot(s):s.contextElement?Ot(s.contextElement):[],popper:Ot(u)};var S=Mu(Hu([].concat(i,h.options.modifiers)));return h.orderedModifiers=S.filter(function(c){return c.enabled}),y(),p.update()},forceUpdate:function(){if(!f){var C=h.elements,T=C.reference,S=C.popper;if(Ur(T,S)){h.rects={reference:zu(T,zt(S),h.options.strategy==="fixed"),popper:Ki(S)},h.reset=!1,h.placement=h.options.placement,h.orderedModifiers.forEach(function(O){return h.modifiersData[O.name]=Object.assign({},O.data)});for(var c=0;c<h.orderedModifiers.length;c++){if(h.reset===!0){h.reset=!1,c=-1;continue}var b=h.orderedModifiers[c],m=b.fn,_=b.options,G=_===void 0?{}:_,k=b.name;typeof m=="function"&&(h=m({state:h,options:G,name:k,instance:p})||h)}}}},update:Bu(function(){return new Promise(function(E){p.forceUpdate(),E(h)})}),destroy:function(){w(),f=!0}};if(!Ur(s,u))return p;p.setOptions(d).then(function(E){!f&&d.onFirstUpdate&&d.onFirstUpdate(E)});function y(){h.orderedModifiers.forEach(function(E){var C=E.name,T=E.options,S=T===void 0?{}:T,c=E.effect;if(typeof c=="function"){var b=c({state:h,name:C,instance:p,options:S}),m=function(){};l.push(b||m)}})}function w(){l.forEach(function(E){return E()}),l=[]}return p}}var ju=[pu,Gu,lu,Pn,Lu,Ru,Fu,uu,Cu],Vu=Wu({defaultModifiers:ju}),qu="tippy-box",Bn="tippy-content",Ku="tippy-backdrop",Hn="tippy-arrow",Wn="tippy-svg-arrow",rt={passive:!0,capture:!0},jn=function(){return document.body};function Ti(r,t,e){if(Array.isArray(r)){var i=r[t];return i??(Array.isArray(e)?e[t]:e)}return r}function Qi(r,t){var e={}.toString.call(r);return e.indexOf("[object")===0&&e.indexOf(t+"]")>-1}function Vn(r,t){return typeof r=="function"?r.apply(void 0,t):r}function Mr(r,t){if(t===0)return r;var e;return function(i){clearTimeout(e),e=setTimeout(function(){r(i)},t)}}function Yu(r){return r.split(/\s+/).filter(Boolean)}function ct(r){return[].concat(r)}function Br(r,t){r.indexOf(t)===-1&&r.push(t)}function Xu(r){return r.filter(function(t,e){return r.indexOf(t)===e})}function Zu(r){return r.split("-")[0]}function ti(r){return[].slice.call(r)}function Hr(r){return Object.keys(r).reduce(function(t,e){return r[e]!==void 0&&(t[e]=r[e]),t},{})}function Pt(){return document.createElement("div")}function ai(r){return["Element","Fragment"].some(function(t){return Qi(r,t)})}function Ju(r){return Qi(r,"NodeList")}function Qu(r){return Qi(r,"MouseEvent")}function ed(r){return!!(r&&r._tippy&&r._tippy.reference===r)}function td(r){return ai(r)?[r]:Ju(r)?ti(r):Array.isArray(r)?r:ti(document.querySelectorAll(r))}function Ai(r,t){r.forEach(function(e){e&&(e.style.transitionDuration=t+"ms")})}function Wr(r,t){r.forEach(function(e){e&&e.setAttribute("data-state",t)})}function id(r){var t,e=ct(r),i=e[0];return i!=null&&(t=i.ownerDocument)!=null&&t.body?i.ownerDocument:document}function rd(r,t){var e=t.clientX,i=t.clientY;return r.every(function(n){var o=n.popperRect,a=n.popperState,s=n.props,u=s.interactiveBorder,d=Zu(a.placement),h=a.modifiersData.offset;if(!h)return!0;var l=d==="bottom"?h.top.y:0,f=d==="top"?h.bottom.y:0,p=d==="right"?h.left.x:0,y=d==="left"?h.right.x:0,w=o.top-i+l>u,E=i-o.bottom-f>u,C=o.left-e+p>u,T=e-o.right-y>u;return w||E||C||T})}function Ri(r,t,e){var i=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(n){r[i](n,e)})}function jr(r,t){for(var e=t;e;){var i;if(r.contains(e))return!0;e=e.getRootNode==null||(i=e.getRootNode())==null?void 0:i.host}return!1}var ze={isTouch:!1},Vr=0;function nd(){ze.isTouch||(ze.isTouch=!0,window.performance&&document.addEventListener("mousemove",qn))}function qn(){var r=performance.now();r-Vr<20&&(ze.isTouch=!1,document.removeEventListener("mousemove",qn)),Vr=r}function od(){var r=document.activeElement;if(ed(r)){var t=r._tippy;r.blur&&!t.state.isVisible&&r.blur()}}function ad(){document.addEventListener("touchstart",nd,rt),window.addEventListener("blur",od)}var sd=typeof window<"u"&&typeof document<"u",ud=sd?!!window.msCrypto:!1,dd={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},hd={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},Ne=Object.assign({appendTo:jn,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},dd,hd),cd=Object.keys(Ne),ld=function(t){var e=Object.keys(t);e.forEach(function(i){Ne[i]=t[i]})};function Kn(r){var t=r.plugins||[],e=t.reduce(function(i,n){var o=n.name,a=n.defaultValue;if(o){var s;i[o]=r[o]!==void 0?r[o]:(s=Ne[o])!=null?s:a}return i},{});return Object.assign({},r,e)}function fd(r,t){var e=t?Object.keys(Kn(Object.assign({},Ne,{plugins:t}))):cd,i=e.reduce(function(n,o){var a=(r.getAttribute("data-tippy-"+o)||"").trim();if(!a)return n;if(o==="content")n[o]=a;else try{n[o]=JSON.parse(a)}catch{n[o]=a}return n},{});return i}function qr(r,t){var e=Object.assign({},t,{content:Vn(t.content,[r])},t.ignoreAttributes?{}:fd(r,t.plugins));return e.aria=Object.assign({},Ne.aria,e.aria),e.aria={expanded:e.aria.expanded==="auto"?t.interactive:e.aria.expanded,content:e.aria.content==="auto"?t.interactive?null:"describedby":e.aria.content},e}var pd=function(){return"innerHTML"};function Fi(r,t){r[pd()]=t}function Kr(r){var t=Pt();return r===!0?t.className=Hn:(t.className=Wn,ai(r)?t.appendChild(r):Fi(t,r)),t}function Yr(r,t){ai(t.content)?(Fi(r,""),r.appendChild(t.content)):typeof t.content!="function"&&(t.allowHTML?Fi(r,t.content):r.textContent=t.content)}function Ni(r){var t=r.firstElementChild,e=ti(t.children);return{box:t,content:e.find(function(i){return i.classList.contains(Bn)}),arrow:e.find(function(i){return i.classList.contains(Hn)||i.classList.contains(Wn)}),backdrop:e.find(function(i){return i.classList.contains(Ku)})}}function Yn(r){var t=Pt(),e=Pt();e.className=qu,e.setAttribute("data-state","hidden"),e.setAttribute("tabindex","-1");var i=Pt();i.className=Bn,i.setAttribute("data-state","hidden"),Yr(i,r.props),t.appendChild(e),e.appendChild(i),n(r.props,r.props);function n(o,a){var s=Ni(t),u=s.box,d=s.content,h=s.arrow;a.theme?u.setAttribute("data-theme",a.theme):u.removeAttribute("data-theme"),typeof a.animation=="string"?u.setAttribute("data-animation",a.animation):u.removeAttribute("data-animation"),a.inertia?u.setAttribute("data-inertia",""):u.removeAttribute("data-inertia"),u.style.maxWidth=typeof a.maxWidth=="number"?a.maxWidth+"px":a.maxWidth,a.role?u.setAttribute("role",a.role):u.removeAttribute("role"),(o.content!==a.content||o.allowHTML!==a.allowHTML)&&Yr(d,r.props),a.arrow?h?o.arrow!==a.arrow&&(u.removeChild(h),u.appendChild(Kr(a.arrow))):u.appendChild(Kr(a.arrow)):h&&u.removeChild(h)}return{popper:t,onUpdate:n}}Yn.$$tippy=!0;var gd=1,Xt=[],Si=[];function vd(r,t){var e=qr(r,Object.assign({},Ne,Kn(Hr(t)))),i,n,o,a=!1,s=!1,u=!1,d=!1,h,l,f,p=[],y=Mr(U,e.interactiveDebounce),w,E=gd++,C=null,T=Xu(e.plugins),S={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},c={id:E,reference:r,popper:Pt(),popperInstance:C,props:e,state:S,plugins:T,clearDelayTimeouts:He,setProps:$e,setContent:We,show:je,hide:at,hideWithInteractivity:st,enable:Ie,disable:Be,unmount:Xn,destroy:Zn};if(!e.render)return c;var b=e.render(c),m=b.popper,_=b.onUpdate;m.setAttribute("data-tippy-root",""),m.id="tippy-"+c.id,c.popper=m,r._tippy=c,m._tippy=c;var G=T.map(function(R){return R.fn(c)}),k=r.hasAttribute("aria-expanded");return V(),ee(),v(),M("onCreate",[c]),e.showOnCreate&&Ee(),m.addEventListener("mouseenter",function(){c.props.interactive&&c.state.isVisible&&c.clearDelayTimeouts()}),m.addEventListener("mouseleave",function(){c.props.interactive&&c.props.trigger.indexOf("mouseenter")>=0&&q().addEventListener("mousemove",y)}),c;function O(){var R=c.props.touch;return Array.isArray(R)?R:[R,0]}function H(){return O()[0]==="hold"}function F(){var R;return!!((R=c.props.render)!=null&&R.$$tippy)}function g(){return w||r}function q(){var R=g().parentNode;return R?id(R):document}function J(){return Ni(m)}function D(R){return c.state.isMounted&&!c.state.isVisible||ze.isTouch||h&&h.type==="focus"?0:Ti(c.props.delay,R?0:1,Ne.delay)}function v(R){R===void 0&&(R=!1),m.style.pointerEvents=c.props.interactive&&!R?"":"none",m.style.zIndex=""+c.props.zIndex}function M(R,$,W){if(W===void 0&&(W=!0),G.forEach(function(Y){Y[R]&&Y[R].apply(Y,$)}),W){var Q;(Q=c.props)[R].apply(Q,$)}}function j(){var R=c.props.aria;if(R.content){var $="aria-"+R.content,W=m.id,Q=ct(c.props.triggerTarget||r);Q.forEach(function(Y){var le=Y.getAttribute($);if(c.state.isVisible)Y.setAttribute($,le?le+" "+W:W);else{var _e=le&&le.replace(W,"").trim();_e?Y.setAttribute($,_e):Y.removeAttribute($)}})}}function ee(){if(!(k||!c.props.aria.expanded)){var R=ct(c.props.triggerTarget||r);R.forEach(function($){c.props.interactive?$.setAttribute("aria-expanded",c.state.isVisible&&$===g()?"true":"false"):$.removeAttribute("aria-expanded")})}}function re(){q().removeEventListener("mousemove",y),Xt=Xt.filter(function(R){return R!==y})}function Z(R){if(!(ze.isTouch&&(u||R.type==="mousedown"))){var $=R.composedPath&&R.composedPath()[0]||R.target;if(!(c.props.interactive&&jr(m,$))){if(ct(c.props.triggerTarget||r).some(function(W){return jr(W,$)})){if(ze.isTouch||c.state.isVisible&&c.props.trigger.indexOf("click")>=0)return}else M("onClickOutside",[c,R]);c.props.hideOnClick===!0&&(c.clearDelayTimeouts(),c.hide(),s=!0,setTimeout(function(){s=!1}),c.state.isMounted||De())}}}function N(){u=!0}function he(){u=!1}function ie(){var R=q();R.addEventListener("mousedown",Z,!0),R.addEventListener("touchend",Z,rt),R.addEventListener("touchstart",he,rt),R.addEventListener("touchmove",N,rt)}function De(){var R=q();R.removeEventListener("mousedown",Z,!0),R.removeEventListener("touchend",Z,rt),R.removeEventListener("touchstart",he,rt),R.removeEventListener("touchmove",N,rt)}function be(R,$){Le(R,function(){!c.state.isVisible&&m.parentNode&&m.parentNode.contains(m)&&$()})}function xe(R,$){Le(R,$)}function Le(R,$){var W=J().box;function Q(Y){Y.target===W&&(Ri(W,"remove",Q),$())}if(R===0)return $();Ri(W,"remove",l),Ri(W,"add",Q),l=Q}function X(R,$,W){W===void 0&&(W=!1);var Q=ct(c.props.triggerTarget||r);Q.forEach(function(Y){Y.addEventListener(R,$,W),p.push({node:Y,eventType:R,handler:$,options:W})})}function V(){H()&&(X("touchstart",ce,{passive:!0}),X("touchend",z,{passive:!0})),Yu(c.props.trigger).forEach(function(R){if(R!=="manual")switch(X(R,ce),R){case"mouseenter":X("mouseleave",z);break;case"focus":X(ud?"focusout":"blur",A);break;case"focusin":X("focusout",A);break}})}function K(){p.forEach(function(R){var $=R.node,W=R.eventType,Q=R.handler,Y=R.options;$.removeEventListener(W,Q,Y)}),p=[]}function ce(R){var $,W=!1;if(!(!c.state.isEnabled||ge(R)||s)){var Q=(($=h)==null?void 0:$.type)==="focus";h=R,w=R.currentTarget,ee(),!c.state.isVisible&&Qu(R)&&Xt.forEach(function(Y){return Y(R)}),R.type==="click"&&(c.props.trigger.indexOf("mouseenter")<0||a)&&c.props.hideOnClick!==!1&&c.state.isVisible?W=!0:Ee(R),R.type==="click"&&(a=!W),W&&!Q&&Ge(R)}}function U(R){var $=R.target,W=g().contains($)||m.contains($);if(!(R.type==="mousemove"&&W)){var Q=ne().concat(m).map(function(Y){var le,_e=Y._tippy,ut=(le=_e.popperInstance)==null?void 0:le.state;return ut?{popperRect:Y.getBoundingClientRect(),popperState:ut,props:e}:null}).filter(Boolean);rd(Q,R)&&(re(),Ge(R))}}function z(R){var $=ge(R)||c.props.trigger.indexOf("click")>=0&&a;if(!$){if(c.props.interactive){c.hideWithInteractivity(R);return}Ge(R)}}function A(R){c.props.trigger.indexOf("focusin")<0&&R.target!==g()||c.props.interactive&&R.relatedTarget&&m.contains(R.relatedTarget)||Ge(R)}function ge(R){return ze.isTouch?H()!==R.type.indexOf("touch")>=0:!1}function ke(){we();var R=c.props,$=R.popperOptions,W=R.placement,Q=R.offset,Y=R.getReferenceClientRect,le=R.moveTransition,_e=F()?Ni(m).arrow:null,ut=Y?{getBoundingClientRect:Y,contextElement:Y.contextElement||g()}:r,er={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Mt){var dt=Mt.state;if(F()){var Jn=J(),ui=Jn.box;["placement","reference-hidden","escaped"].forEach(function(Bt){Bt==="placement"?ui.setAttribute("data-placement",dt.placement):dt.attributes.popper["data-popper-"+Bt]?ui.setAttribute("data-"+Bt,""):ui.removeAttribute("data-"+Bt)}),dt.attributes.popper={}}}},tt=[{name:"offset",options:{offset:Q}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!le}},er];F()&&_e&&tt.push({name:"arrow",options:{element:_e,padding:3}}),tt.push.apply(tt,($==null?void 0:$.modifiers)||[]),c.popperInstance=Vu(ut,m,Object.assign({},$,{placement:W,onFirstUpdate:f,modifiers:tt}))}function we(){c.popperInstance&&(c.popperInstance.destroy(),c.popperInstance=null)}function de(){var R=c.props.appendTo,$,W=g();c.props.interactive&&R===jn||R==="parent"?$=W.parentNode:$=Vn(R,[W]),$.contains(m)||$.appendChild(m),c.state.isMounted=!0,ke()}function ne(){return ti(m.querySelectorAll("[data-tippy-root]"))}function Ee(R){c.clearDelayTimeouts(),R&&M("onTrigger",[c,R]),ie();var $=D(!0),W=O(),Q=W[0],Y=W[1];ze.isTouch&&Q==="hold"&&Y&&($=Y),$?i=setTimeout(function(){c.show()},$):c.show()}function Ge(R){if(c.clearDelayTimeouts(),M("onUntrigger",[c,R]),!c.state.isVisible){De();return}if(!(c.props.trigger.indexOf("mouseenter")>=0&&c.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(R.type)>=0&&a)){var $=D(!1);$?n=setTimeout(function(){c.state.isVisible&&c.hide()},$):o=requestAnimationFrame(function(){c.hide()})}}function Ie(){c.state.isEnabled=!0}function Be(){c.hide(),c.state.isEnabled=!1}function He(){clearTimeout(i),clearTimeout(n),cancelAnimationFrame(o)}function $e(R){if(!c.state.isDestroyed){M("onBeforeUpdate",[c,R]),K();var $=c.props,W=qr(r,Object.assign({},$,Hr(R),{ignoreAttributes:!0}));c.props=W,V(),$.interactiveDebounce!==W.interactiveDebounce&&(re(),y=Mr(U,W.interactiveDebounce)),$.triggerTarget&&!W.triggerTarget?ct($.triggerTarget).forEach(function(Q){Q.removeAttribute("aria-expanded")}):W.triggerTarget&&r.removeAttribute("aria-expanded"),ee(),v(),_&&_($,W),c.popperInstance&&(ke(),ne().forEach(function(Q){requestAnimationFrame(Q._tippy.popperInstance.forceUpdate)})),M("onAfterUpdate",[c,R])}}function We(R){c.setProps({content:R})}function je(){var R=c.state.isVisible,$=c.state.isDestroyed,W=!c.state.isEnabled,Q=ze.isTouch&&!c.props.touch,Y=Ti(c.props.duration,0,Ne.duration);if(!(R||$||W||Q)&&!g().hasAttribute("disabled")&&(M("onShow",[c],!1),c.props.onShow(c)!==!1)){if(c.state.isVisible=!0,F()&&(m.style.visibility="visible"),v(),ie(),c.state.isMounted||(m.style.transition="none"),F()){var le=J(),_e=le.box,ut=le.content;Ai([_e,ut],0)}f=function(){var tt;if(!(!c.state.isVisible||d)){if(d=!0,m.offsetHeight,m.style.transition=c.props.moveTransition,F()&&c.props.animation){var si=J(),Mt=si.box,dt=si.content;Ai([Mt,dt],Y),Wr([Mt,dt],"visible")}j(),ee(),Br(Si,c),(tt=c.popperInstance)==null||tt.forceUpdate(),M("onMount",[c]),c.props.animation&&F()&&xe(Y,function(){c.state.isShown=!0,M("onShown",[c])})}},de()}}function at(){var R=!c.state.isVisible,$=c.state.isDestroyed,W=!c.state.isEnabled,Q=Ti(c.props.duration,1,Ne.duration);if(!(R||$||W)&&(M("onHide",[c],!1),c.props.onHide(c)!==!1)){if(c.state.isVisible=!1,c.state.isShown=!1,d=!1,a=!1,F()&&(m.style.visibility="hidden"),re(),De(),v(!0),F()){var Y=J(),le=Y.box,_e=Y.content;c.props.animation&&(Ai([le,_e],Q),Wr([le,_e],"hidden"))}j(),ee(),c.props.animation?F()&&be(Q,c.unmount):c.unmount()}}function st(R){q().addEventListener("mousemove",y),Br(Xt,y),y(R)}function Xn(){c.state.isVisible&&c.hide(),c.state.isMounted&&(we(),ne().forEach(function(R){R._tippy.unmount()}),m.parentNode&&m.parentNode.removeChild(m),Si=Si.filter(function(R){return R!==c}),c.state.isMounted=!1,M("onHidden",[c]))}function Zn(){c.state.isDestroyed||(c.clearDelayTimeouts(),c.unmount(),K(),delete r._tippy,c.state.isDestroyed=!0,M("onDestroy",[c]))}}function Ut(r,t){t===void 0&&(t={});var e=Ne.plugins.concat(t.plugins||[]);ad();var i=Object.assign({},t,{plugins:e}),n=td(r),o=n.reduce(function(a,s){var u=s&&vd(s,i);return u&&a.push(u),a},[]);return ai(r)?o[0]:o}Ut.defaultProps=Ne;Ut.setDefaultProps=ld;Ut.currentInput=ze;Object.assign({},Pn,{effect:function(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow)}});Ut.setDefaultProps({render:Yn});function md(r,t,e,i,n=15){const o=r.getContainer().getBoundingClientRect(),{x:a,y:s}=r.viewportToGraph({x:e-o.left,y:i-o.top});let u=null,d=1/0;return t.forEachNode((h,l)=>{const f=Math.hypot(l.x-a,l.y-s);f<n&&f<d&&(u=h,d=f)}),u}const ii=document.createElement("div");Object.assign(ii.style,{position:"absolute",pointerEvents:"none",display:"none",background:"rgba(0,0,0,0.8)",color:"#fff",padding:"6px",borderRadius:"4px",fontSize:"12px",maxWidth:"200px"});document.body.appendChild(ii);fetch("/scan/3/latest").then(r=>r.json()).then(({attack_graph:r})=>{if(!r||!Array.isArray(r.nodes))throw new Error("Invalid attack_graph format");const t=new Map;r.nodes.forEach(d=>t.set(String(d.id),d));const e=new Mi,i=new Map;r.nodes.filter(d=>d.type==="file").forEach(d=>{const h=String(d.id);e.addNode(h,{label:d.label,filepath:d.filepath,x:Math.random()*100,y:Math.random()*100,size:18,color:"#0074D9",nodeCategory:"file",type:"nodeCircle",_expanded:!1});const l=Array.isArray(d.children)?d.children.map(String):[];i.set(h,l)});const n=new Map;for(const[d,h]of i)h.forEach(l=>n.set(l,d));const o=new Set;r.links.forEach(d=>{const h=n.get(String(d.source)),l=n.get(String(d.target));if(h&&l&&h!==l){const f=`${h}->${l}`;o.has(f)||(e.addEdgeWithKey(f,h,l,{type:"arrow",color:"rgba(150,150,150,0.8)",size:2,arrowSize:6}),o.add(f))}});const a=new Set(e.edges());la.assign(e,{iterations:200,settings:{gravity:1,scalingRatio:4,adjustSizes:!0}});const s=document.getElementById("container");if(!s)throw new Error("#container element not found");s.style.touchAction="none";const u=new Ns(e,s,{settings:{defaultEdgeType:"arrow",minArrowSize:6,defaultEdgeColor:"#ccc",defaultNodeColor:"#0074D9",labelThreshold:16},nodeProgramClasses:{nodeCircle:It},edgeProgramClasses:{arrow:Li,calls:Li}});u.refresh(),u.on("enterNode",({node:d})=>{const h=e.getNodeAttributes(d);h.nodeCategory==="file"&&Ut(ii,{content:`<strong>${h.label}</strong><br>${h.filepath}`,allowHTML:!0,placement:"top",trigger:"manual",theme:"light-border"}).show()}),u.on("leaveNode",()=>{var d;return(d=ii._tippy)==null?void 0:d.hide()}),s.addEventListener("click",d=>{const h=md(u,e,d.clientX,d.clientY);if(!h)return;const l=e.getNodeAttributes(h);if(l.nodeCategory!=="file")return;const f=i.get(h)||[];if(l._expanded)f.forEach(p=>{const y=`${h}::${p}`;e.hasNode(y)&&e.dropNode(y)}),e.edges().forEach(p=>{a.has(p)||e.dropEdge(p)}),e.setNodeAttribute(h,"_expanded",!1),u.refresh();else{f.forEach((y,w)=>{const E=`${h}::${y}`;if(!e.hasNode(E)){const C=t.get(y)||{},T=2*Math.PI*w/f.length,S=30;e.addNode(E,{label:C.label,filepath:C.filepath,x:l.x+Math.cos(T)*S,y:l.y+Math.sin(T)*S,size:10,color:C.vulnerable?"#FF4136":"#2ECC40",nodeCategory:"function",type:"nodeCircle"}),e.addEdgeWithKey(`${h}->${E}`,h,E,{type:"calls",color:"rgba(200,200,200,0.6)",size:1,arrowSize:4})}});const p=new Set(f);r.links.forEach(y=>{const w=String(y.source),E=String(y.target);if(p.has(w)&&p.has(E)){const C=`${h}::${w}`,T=`${h}::${E}`,S=`${C}->${T}`;e.hasEdge(S)||e.addEdgeWithKey(S,C,T,{type:"arrow",color:"#999",size:1,arrowSize:4})}}),e.setNodeAttribute(h,"_expanded",!0),u.refresh()}})}).catch(console.error);
