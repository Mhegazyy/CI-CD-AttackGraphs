{
  "nodes": [
    {
      "id": "1",
      "name": "Domain Controller",
      "type": "server",
      "ip": "192.168.10.10",
      "subnet": "192.168.10.0/24",
      "os": "Windows Server 2019",
      "services": ["Active Directory", "DNS"],
      "vulnerabilities": [
        {
          "id": "CVE-2022-26923",
          "severity": "critical",
          "description": "Certificate Services Elevation of Privilege"
        },
        {
          "id": "CVE-2021-34527",
          "severity": "high",
          "description": "PrintNightmare vulnerability"
        }
      ]
    },
    {
      "id": "2",
      "name": "Web Server",
      "type": "server",
      "ip": "192.168.10.20",
      "subnet": "192.168.10.0/24",
      "os": "Windows Server 2016",
      "services": ["IIS", "HTTP", "HTTPS"],
      "vulnerabilities": [
        {
          "id": "CVE-2022-3715",
          "severity": "critical",
          "description": "Remote code execution in IIS"
        }
      ]
    },
    {
      "id": "3",
      "name": "Database Server",
      "type": "server",
      "ip": "192.168.10.30",
      "subnet": "192.168.10.0/24",
      "os": "Windows Server 2016",
      "services": ["MSSQL"],
      "vulnerabilities": [
        {
          "id": "CVE-2020-0618",
          "severity": "high",
          "description": "SQL Server Reporting Services RCE"
        }
      ]
    },
    {
      "id": "4",
      "name": "Email Server",
      "type": "server",
      "ip": "192.168.10.40",
      "subnet": "192.168.10.0/24",
      "os": "Windows Server 2019",
      "services": ["Exchange", "SMTP"],
      "vulnerabilities": [
        {
          "id": "CVE-2022-23277",
          "severity": "high",
          "description": "Exchange Server Elevation of Privilege"
        }
      ]
    },
    {
      "id": "5",
      "name": "File Server",
      "type": "server",
      "ip": "192.168.10.50",
      "subnet": "192.168.10.0/24",
      "os": "Windows Server 2012 R2",
      "services": ["SMB", "File Sharing"],
      "vulnerabilities": [
        {
          "id": "CVE-2021-34527",
          "severity": "high",
          "description": "PrintNightmare vulnerability"
        }
      ]
    },
    {
      "id": "6",
      "name": "Workstation #1",
      "type": "workstation",
      "ip": "192.168.10.101",
      "subnet": "192.168.10.0/24",
      "os": "Windows 10",
      "services": [],
      "vulnerabilities": [
        {
          "id": "CVE-2022-0001",
          "severity": "medium",
          "description": "Privilege escalation in Windows 10"
        }
      ]
    },
    {
      "id": "7",
      "name": "Workstation #2",
      "type": "workstation",
      "ip": "192.168.10.102",
      "subnet": "192.168.10.0/24",
      "os": "Windows 10",
      "services": [],
      "vulnerabilities": []
    },
    {
      "id": "8",
      "name": "Firewall",
      "type": "firewall",
      "ip": "192.168.10.1",
      "subnet": "192.168.10.0/24",
      "os": "FortiOS",
      "services": ["Packet Filtering", "NAT", "VPN"],
      "vulnerabilities": []
    },
    {
      "id": "9",
      "name": "Switch",
      "type": "switch",
      "ip": "192.168.10.2",
      "subnet": "192.168.10.0/24",
      "os": "Cisco IOS",
      "services": ["Switching", "VLAN Trunking"],
      "vulnerabilities": [
        {
          "id": "CVE-2019-12667",
          "severity": "low",
          "description": "Cisco IOS Software VLAN Trunking Protocol Denial of Service"
        }
      ]
    },
    {
      "id": "10",
      "name": "IoT Security Camera",
      "type": "IoT",
      "ip": "192.168.10.150",
      "subnet": "192.168.10.0/24",
      "os": "Proprietary OS",
      "services": ["RTSP"],
      "vulnerabilities": [
        {
          "id": "CVE-2022-9999",
          "severity": "high",
          "description": "Unauthenticated remote code execution"
        }
      ]
    }
  ],
  "edges": [
    {
      "source": "8",
      "target": "9",
      "connection": "Ethernet",
      "description": "Firewall to Switch"
    },
    {
      "source": "9",
      "target": "1",
      "connection": "Ethernet",
      "description": "Switch to Domain Controller"
    },
    {
      "source": "9",
      "target": "2",
      "connection": "Ethernet",
      "description": "Switch to Web Server"
    },
    {
      "source": "9",
      "target": "3",
      "connection": "Ethernet",
      "description": "Switch to Database Server"
    },
    {
      "source": "9",
      "target": "4",
      "connection": "Ethernet",
      "description": "Switch to Email Server"
    },
    {
      "source": "9",
      "target": "5",
      "connection": "Ethernet",
      "description": "Switch to File Server"
    },
    {
      "source": "9",
      "target": "6",
      "connection": "Ethernet",
      "description": "Switch to Workstation #1"
    },
    {
      "source": "9",
      "target": "7",
      "connection": "Ethernet",
      "description": "Switch to Workstation #2"
    },
    {
      "source": "9",
      "target": "10",
      "connection": "Ethernet",
      "description": "Switch to IoT Security Camera"
    },
    {
      "source": "1",
      "target": "2",
      "connection": "TCP",
      "description": "Domain Controller to Web Server (DNS lookups, possibly Kerberos for AD integration)"
    },
    {
      "source": "2",
      "target": "3",
      "connection": "TCP",
      "description": "Web Server to Database Server (SQL queries)"
    },
    {
      "source": "1",
      "target": "3",
      "connection": "TCP",
      "description": "Domain Controller to Database Server"
    },
    {
      "source": "1",
      "target": "4",
      "connection": "TCP",
      "description": "Domain Controller to Email Server (AD authentication)"
    },
    {
      "source": "1",
      "target": "5",
      "connection": "SMB",
      "description": "Domain Controller to File Server"
    },
    {
      "source": "6",
      "target": "1",
      "connection": "TCP",
      "description": "Workstation #1 to Domain Controller (AD auth, DNS requests)"
    },
    {
      "source": "7",
      "target": "1",
      "connection": "TCP",
      "description": "Workstation #2 to Domain Controller"
    },
    {
      "source": "10",
      "target": "1",
      "connection": "TCP",
      "description": "IoT Security Camera to Domain Controller (if it attempts domain integration or logs)"
    }
  ]
}
